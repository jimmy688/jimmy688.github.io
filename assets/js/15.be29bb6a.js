(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1455:function(t,a,s){t.exports=s.p+"assets/img/Image201910221141.7f003e19.png"},1456:function(t,a){t.exports="data:image/png;base64,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"},1457:function(t,a,s){t.exports=s.p+"assets/img/Image201909232016.8123d229.png"},1458:function(t,a,s){t.exports=s.p+"assets/img/Image201909232022.62355b7d.png"},1459:function(t,a,s){t.exports=s.p+"assets/img/Image201909232024.fad2d722.png"},1460:function(t,a,s){t.exports=s.p+"assets/img/Image201909241056.77c99ae8.png"},1461:function(t,a,s){t.exports=s.p+"assets/img/Image201909241118.e0d9549d.png"},1462:function(t,a,s){t.exports=s.p+"assets/img/Image201909241119.14316d34.png"},1463:function(t,a){t.exports="data:image/png;base64,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"},1464:function(t,a,s){t.exports=s.p+"assets/img/Image201907271415.9aa2333e.png"},1465:function(t,a,s){t.exports=s.p+"assets/img/Image201907271416.d39d751e.png"},1466:function(t,a,s){t.exports=s.p+"assets/img/Image201907271417.f9c8445b.png"},1467:function(t,a,s){t.exports=s.p+"assets/img/Image201907271419.88982e52.png"},1468:function(t,a,s){t.exports=s.p+"assets/img/Image201907271519.70816c15.png"},1469:function(t,a,s){t.exports=s.p+"assets/img/Image201907271520.9a2e5fb8.png"},1470:function(t,a,s){t.exports=s.p+"assets/img/Image201907271524.9e1c8833.png"},1471:function(t,a,s){t.exports=s.p+"assets/img/Image201907271526.a8bb9a39.png"},1472:function(t,a,s){t.exports=s.p+"assets/img/Image201906091839.753a3802.png"},1473:function(t,a,s){t.exports=s.p+"assets/img/image-20200218003759092.0ae8a089.png"},1474:function(t,a,s){t.exports=s.p+"assets/img/image-20200218005827323.343e6553.png"},1475:function(t,a,s){t.exports=s.p+"assets/img/Image201905311514.5c9ad465.png"},1476:function(t,a,s){t.exports=s.p+"assets/img/image-20200218014020278.9b6f0647.png"},1477:function(t,a,s){t.exports=s.p+"assets/img/Image201906140813.48a253d7.png"},1478:function(t,a,s){t.exports=s.p+"assets/img/Image201905291811.d8503bda.png"},1479:function(t,a,s){t.exports=s.p+"assets/img/Image201905291818.f3e36e6c.png"},1480:function(t,a,s){t.exports=s.p+"assets/img/image-20200218022634477.1c5b3520.png"},1481:function(t,a,s){t.exports=s.p+"assets/img/Image201910242342.59d1ddec.png"},1482:function(t,a,s){t.exports=s.p+"assets/img/Image201905211519.44c8b9ac.png"},1483:function(t,a,s){t.exports=s.p+"assets/img/Image201909200732.2065aaa6.png"},1484:function(t,a,s){t.exports=s.p+"assets/img/zkservice-1581885316200.3119bdf6.jpg"},1485:function(t,a,s){t.exports=s.p+"assets/img/Image201910251149.0894c748.png"},1486:function(t,a,s){t.exports=s.p+"assets/img/Image2019061212537.0f25f1ac.png"},1487:function(t,a,s){t.exports=s.p+"assets/img/Image201910251203.a826eb7c.png"},1488:function(t,a,s){t.exports=s.p+"assets/img/image-20200218065532250.d7957608.png"},1489:function(t,a,s){t.exports=s.p+"assets/img/Image201906130749.8c1c5a2c.png"},1490:function(t,a,s){t.exports=s.p+"assets/img/Image201906131101.ab169a06.png"},1491:function(t,a,s){t.exports=s.p+"assets/img/image-20200218064209321.33d9732a.png"},1492:function(t,a,s){t.exports=s.p+"assets/img/Image201906131311.9ce903e7.png"},1493:function(t,a,s){t.exports=s.p+"assets/img/Image201906140856.5ac4420c.png"},1494:function(t,a,s){t.exports=s.p+"assets/img/image-20200219154004216.f82ffe9b.png"},1495:function(t,a,s){t.exports=s.p+"assets/img/20170221224856838.8d7cd4ce.png"},1496:function(t,a,s){t.exports=s.p+"assets/img/Image201909181457.d701b554.png"},1497:function(t,a,s){t.exports=s.p+"assets/img/Image201909201440.c7f57827.png"},2019:function(t,a,s){"use strict";s.r(a);var n=s(17),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"zookeeper安装部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper安装部署"}},[t._v("#")]),t._v(" zookeeper安装部署")]),t._v(" "),n("p",[t._v("注意事项："),n("strong",[t._v("三台机器一定要保证时钟同步")])]),t._v(" "),n("h4",{attrs:{id:"_1-1-下载zookeeeper的压缩包-下载网址如下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-下载zookeeeper的压缩包-下载网址如下"}},[t._v("#")]),t._v(" 1.1 下载zookeeeper的压缩包，下载网址如下")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("http://archive.cloudera.com/cdh5/cdh/5/")])]),t._v(" "),n("li",[n("p",[t._v("我们在这个网址下载我们使用的zk版本为"),n("a",{attrs:{href:"http://archive.cloudera.com/cdh5/cdh/5/zookeeper-3.4.5-cdh5.14.2.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[t._v("zookeeper-3.4.5-cdh5.14.2.tar.gz"),n("OutboundLink")],1)])]),t._v(" "),n("li",[n("p",[t._v("下载完成之后，上传到我们的"),n("code",[t._v("node01")]),t._v("的"),n("code",[t._v("/kkb/soft")]),t._v("路径下准备进行安装")])])]),t._v(" "),n("h4",{attrs:{id:"_1-2-解压"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-解压"}},[t._v("#")]),t._v(" 1.2 解压")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("node01")]),t._v("执行以下命令解压"),n("code",[t._v("zookeeper")]),t._v("的压缩包到"),n("code",[t._v("node01")]),t._v("服务器的"),n("code",[t._v("/kkb/install")]),t._v("路径下去，然后准备进行安装")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/soft\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -zxvf zookeeper-3.4.5-cdh5.14.2.tar.gz  -C /kkb/install/\n")])])]),n("h4",{attrs:{id:"_1-3-修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-修改配置文件"}},[t._v("#")]),t._v(" 1.3 修改配置文件")]),t._v(" "),n("ul",[n("li",[t._v("第一台机器修改配置文件")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/zookeeper-3.4.5-cdh5.14.2/conf\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" zoo_sample.cfg zoo.cfg\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas\n")])])]),n("ul",[n("li",[t._v("用"),n("code",[t._v("vim zoo.cfg")]),t._v("修改文件，修改如下属性值")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dataDir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas\n\nautopurge.snapRetainCount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n\nautopurge.purgeInterval"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#文件末尾增加如下三行")]),t._v("\nserver.1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node01:2888:3888\nserver.2"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node02:2888:3888\nserver.3"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node03:2888:3888\n")])])]),n("h4",{attrs:{id:"_1-4-添加myid配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-添加myid配置"}},[t._v("#")]),t._v(" 1.4 添加myid配置")]),t._v(" "),n("ul",[n("li",[t._v("在第一台机器的/kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas/这个路径下创建一个文件，文件名为myid ,文件内容为1")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  /kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas/myid\n")])])]),n("h4",{attrs:{id:"_1-5-安装包分发并修改myid的值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-安装包分发并修改myid的值"}},[t._v("#")]),t._v(" 1.5 安装包分发并修改myid的值")]),t._v(" "),n("ul",[n("li",[t._v("第一台机器上面执行以下两个命令")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -r /kkb/install/zookeeper-3.4.5-cdh5.14.2/ node02:/kkb/install/\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -r /kkb/install/zookeeper-3.4.5-cdh5.14.2/ node03:/kkb/install/\n")])])]),n("ul",[n("li",[t._v("第二台机器上修改myid的值为2；直接在第二台机器任意路径执行以下命令")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas/myid\n")])])]),n("ul",[n("li",[t._v("第三台机器上修改myid的值为3；直接在第三台机器任意路径执行以下命令")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas/myid\n")])])]),n("h4",{attrs:{id:"_1-6-配置环境变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-配置环境变量"}},[t._v("#")]),t._v(" 1.6 配置环境变量")]),t._v(" "),n("ul",[n("li",[t._v("三台节点都配置/etc/profile文件")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ZK_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/zookeeper-3.4.5-cdh5.14.2\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ZK_HOME")]),t._v("/bin\n")])])]),n("ul",[n("li",[t._v("三台节点，让新添环境变量生效（hadoop用户下执行）")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile\n")])])]),n("h4",{attrs:{id:"_1-7-三台机器启动zookeeper服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-三台机器启动zookeeper服务"}},[t._v("#")]),t._v(" 1.7 三台机器启动zookeeper服务")]),t._v(" "),n("ul",[n("li",[t._v("三台机器启动zookeeper服务；这个命令三台机器都要执行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("zkServer.sh start\n")])])]),n("ul",[n("li",[t._v("查看启动状态")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("zkServer.sh status\n")])])]),n("blockquote",[n("p",[t._v("一个zkServer的状态要么是follower，要么是leader")]),t._v(" "),n("p",[t._v("三个节点中，一个节点为leader，另外两个为follower，类似下图")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1455),alt:""}})]),t._v(" "),n("p",[t._v("![](zookeeper.assets/Image201910221141 (2).png)")]),t._v(" "),n("ul",[n("li",[t._v("jps每个服务器上有一个"),n("strong",[t._v("QuorumPeerMain")]),t._v("进程")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1456),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"_1-8-如何关闭zookeeper集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-8-如何关闭zookeeper集群"}},[t._v("#")]),t._v(" 1.8 如何关闭zookeeper集群")]),t._v(" "),n("ul",[n("li",[t._v("三个节点运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("zkServer.sh stop\n")])])]),n("blockquote",[n("p",[t._v("**注意：**关闭虚拟机前，要在每个zookeeper服务器中使用zkServer.sh stop命令，关闭zookeeper服务器")]),t._v(" "),n("p",[t._v("否则，可能集群出问题")])]),t._v(" "),n("h2",{attrs:{id:"ha集群搭建-todo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ha集群搭建-todo"}},[t._v("#")]),t._v(" HA集群搭建（TODO）")]),t._v(" "),n("h4",{attrs:{id:"集群规划"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#集群规划"}},[t._v("#")]),t._v(" 集群规划")]),t._v(" "),n("blockquote",[n("p",[t._v("说明：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("集群共5个节点，主机名分别是node01、node02、node03、node04、node05")])]),t._v(" "),n("li",[n("p",[t._v("初始启动集群")]),t._v(" "),n("ul",[n("li",[t._v("node01上运行active namenode即主namenode；node02上运行standby namenode即从namenode")]),t._v(" "),n("li",[t._v("node04上运行主resourcemanager；node05上运行从resourcemanager")])])])])]),t._v(" "),n("ul",[n("li",[t._v("每个节点运行的进程如下表")])]),t._v(" "),n("p",[t._v("| 机器名 | 运行进程                                                    |\n| ------ | =====================---------------- |\n| node01 | NameNode/zkfc/Zookeeper/Journalnode/DataNode/NodeManager    |\n| node02 | NameNode/zkfc/Zookeeper/Journalnode/DataNode/NodeManager    |\n| node03 | Zookeeper/Journalnode/DataNode/NodeManager/JobHistoryServer |\n| node04 | ResourceManager                                             |\n| node05 | ResourceManager                                             |")]),t._v(" "),n("h4",{attrs:{id:"虚拟机环境准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟机环境准备"}},[t._v("#")]),t._v(" 虚拟机环境准备")]),t._v(" "),n("ul",[n("li",[t._v("准备"),n("strong",[t._v("5台")]),t._v("虚拟机")]),t._v(" "),n("li",[t._v("在做五节点"),n("code",[t._v("hadoop HA")]),t._v("集群搭建之前，要求先完成"),n("strong",[t._v("每台")]),t._v("虚拟机的"),n("strong",[t._v("基本环境准备")]),t._v(" "),n("ul",[n("li",[t._v("每个节点都要做好“在"),n("code",[t._v("node01")]),t._v("上开始解压"),n("code",[t._v("hadoop")]),t._v("的"),n("code",[t._v("tar.gz")]),t._v("包之前的环境配置”")]),t._v(" "),n("li",[t._v("主要包括如下步骤（"),n("strong",[t._v("三节点Hadoop集群搭建时已讲解过，不再赘述")]),t._v("）\n"),n("ul",[n("li",[t._v("windows|mac安装VMWare虚拟化软件")]),t._v(" "),n("li",[t._v("VMWare下安装CenoOS7")]),t._v(" "),n("li",[t._v("虚拟机关闭防火墙")]),t._v(" "),n("li",[t._v("禁用selinux")]),t._v(" "),n("li",[t._v("配置虚拟网卡")]),t._v(" "),n("li",[t._v("配置虚拟机网络")]),t._v(" "),n("li",[t._v("安装JDK")]),t._v(" "),n("li",[t._v("配置时间同步")]),t._v(" "),n("li",[t._v("修改主机名")]),t._v(" "),n("li",[t._v("修改ip地址")]),t._v(" "),n("li",[t._v("修改/etc/hosts")]),t._v(" "),n("li",[t._v("各节点免密钥登陆")]),t._v(" "),n("li",[t._v("重启虚拟机")])])])])])]),t._v(" "),n("h4",{attrs:{id:"安装zookeeper集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装zookeeper集群"}},[t._v("#")]),t._v(" 安装ZooKeeper集群")]),t._v(" "),n("p",[n("code",[t._v("Hadoop")]),t._v("高可用集群需要使用"),n("code",[t._v("ZooKeeper")]),t._v("集群做分布式协调；所以"),n("strong",[t._v("先安装ZooKeeper集群")])]),t._v(" "),n("ul",[n("li",[t._v("在"),n("code",[t._v("node01、node02、node03")]),t._v("上安装"),n("code",[t._v("ZooKeeper")]),t._v("集群")])]),t._v(" "),n("h4",{attrs:{id:"node01安装hadoop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node01安装hadoop"}},[t._v("#")]),t._v(" node01安装hadoop")]),t._v(" "),n("p",[n("strong",[t._v("注意：")])]),t._v(" "),n("p",[t._v("①3.1到3.8在"),n("strong",[t._v("node01")]),t._v("上操作")]),t._v(" "),n("p",[t._v("②"),n("strong",[t._v("此文档使用普通用户操作，如hadoop")])]),t._v(" "),n("p",[t._v("③"),n("strong",[t._v("hadoop安装到用户主目录下，如/kkb/install")])]),t._v(" "),n("p",[n("strong",[t._v("请根据自己的实际情况修改")])]),t._v(" "),n("h5",{attrs:{id:"_3-1-解压hadoop压缩包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-解压hadoop压缩包"}},[t._v("#")]),t._v(" 3.1 解压hadoop压缩包")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("hadoop压缩包hadoop-2.6.0-cdh5.14.2_after_compile.tar.gz上传到node01的/kkb/soft路径中")])]),t._v(" "),n("li",[n("p",[t._v("解压hadoop压缩包到/kkb/install")])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#解压hadoop压缩包到/kkb/install")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/soft/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 soft"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -xzvf hadoop-2.6.0-cdh5.14.2_after_compile.tar.gz -C /kkb/install/\n")])])]),n("h5",{attrs:{id:"_3-2-修改hadoop-env-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-修改hadoop-env-sh"}},[t._v("#")]),t._v(" 3.2 修改hadoop-env.sh")]),t._v(" "),n("ul",[n("li",[t._v("进入hadoop配置文件路径$HADOOP_HOME/etc/hadoop")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 soft"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hadoop-2.6.0-cdh5.14.2/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 hadoop-2.6.0-cdh5.14.2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" etc/hadoop/\n")])])]),n("ul",[n("li",[t._v("修改hadoop-env.sh，修改JAVA_HOME值为jdk解压路径；保存退出")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JAVA_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/jdk1.8.0_141\n")])])]),n("blockquote",[n("p",[t._v("注意：JAVA_HOME值修改为"),n("strong",[t._v("自己jdk的实际目录")])])]),t._v(" "),n("h5",{attrs:{id:"_3-3-修改core-site-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-修改core-site-xml"}},[t._v("#")]),t._v(" 3.3 修改core-site.xml")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("注意：")])]),t._v(" "),n("p",[n("strong",[t._v("情况一：值/kkb/install/hadoop-2.6.0-cdh5.14.2/tmp根据实际情况修改")])]),t._v(" "),n("p",[n("strong",[t._v("情况二：值node01:2181,node02:2181,node03:2181根据实际情况修改，修改成安装了zookeeper的虚拟机的主机名")])])]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定hdfs的nameservice id为ns1 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("fs.defaultFS"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("hdfs://ns1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定hadoop临时文件存储的基目录 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("hadoop.tmp.dir"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/kkb/install/hadoop-2.6.0-cdh5.14.2/tmp"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定zookeeper地址，ZKFailoverController使用 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("ha.zookeeper.quorum"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01:2181,node02:2181,node03:2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"_3-4-修改hdfs-site-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-修改hdfs-site-xml"}},[t._v("#")]),t._v(" 3.4 修改hdfs-site.xml")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("注意：")])]),t._v(" "),n("p",[n("strong",[t._v("情况一：属性值qjournal://node01:8485;node02:8485;node03:8485/ns1中的主机名，修改成实际安装zookeeper的虚拟机的主机名")])]),t._v(" "),n("p",[n("strong",[t._v("情况二：属性值/kkb/install/hadoop-2.6.0-cdh5.14.2/journal中”/kkb/install/hadoop-2.6.0-cdh5.14.2”替换成实际hadoop文件夹的路径")])]),t._v(" "),n("p",[n("strong",[t._v("情况三：属性值/home/hadoop/.ssh/id_rsa中/home/hadoop根据实际情况替换")])])]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--指定hdfs的nameservice列表，多个之前逗号分隔；此处只有一个ns1，需要和core-site.xml中的保持一致 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.nameservices"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("ns1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ns1下面有两个NameNode，分别是nn1，nn2 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.ha.namenodes.ns1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("nn1,nn2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- nn1的RPC通信地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.namenode.rpc-address.ns1.nn1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01:8020"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- nn1的http通信地址,web访问地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.namenode.http-address.ns1.nn1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01:50070"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- nn2的RPC通信地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.namenode.rpc-address.ns1.nn2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02:8020"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- nn2的http通信地址,web访问地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.namenode.http-address.ns1.nn2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02:50070"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定NameNode的元数据在JournalNode上的存放位置 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.namenode.shared.edits.dir"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("qjournal://node01:8485;node02:8485;node03:8485/ns1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定JournalNode在本地磁盘存放数据的位置 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.journalnode.edits.dir"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/kkb/install/hadoop-2.6.0-cdh5.14.2/journal"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 开启NameNode失败自动切换 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.ha.automatic-failover.enabled"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 此类决定哪个namenode是active，切换active和standby --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.client.failover.proxy.provider.ns1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 配置隔离机制方法，多个机制用换行分割，即每个机制暂用一行--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.ha.fencing.methods"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\tsshfence\n\t\tshell(/bin/true)\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 使用sshfence隔离机制时需要ssh免密登陆到目标机器 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.ha.fencing.ssh.private-key-files"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/home/hadoop/.ssh/id_rsa"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 配置sshfence隔离机制超时时间 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("dfs.ha.fencing.ssh.connect-timeout"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("30000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"_3-5-修改mapred-site-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-修改mapred-site-xml"}},[t._v("#")]),t._v(" 3.5 修改mapred-site.xml")]),t._v(" "),n("ul",[n("li",[t._v("重命名文件")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" mapred-site.xml.template mapred-site.xml\n")])])]),n("ul",[n("li",[t._v("修改mapred-site.xml")])]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定运行mr job的运行时框架为yarn --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mapreduce.framework.name"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- MapReduce JobHistory Server IPC host:port --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mapreduce.jobhistory.address"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03:10020"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- MapReduce JobHistory Server Web UI host:port --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mapreduce.jobhistory.webapp.address"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03:19888"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"_3-6-修改yarn-site-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-修改yarn-site-xml"}},[t._v("#")]),t._v(" 3.6 修改yarn-site.xml")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("注意：")])]),t._v(" "),n("p",[n("strong",[t._v("情况一：属性yarn.resourcemanager.hostname.rm1的值node04根据实际情况替换")])]),t._v(" "),n("p",[n("strong",[t._v("情况二：属性yarn.resourcemanager.hostname.rm2的值node05根据实际情况替换")])]),t._v(" "),n("p",[n("strong",[t._v("情况三：属性值node01:2181,node02:2181,node03:2181根据实际情况替换；替换成实际安装zookeeper的虚拟机的主机名")])])]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 是否启用日志聚合.应用程序完成后,日志汇总收集每个容器的日志,这些日志移动到文件系统,例如HDFS. --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\x3c!-- 用户可以通过配置"yarn.nodemanager.remote-app-log-dir"、"yarn.nodemanager.remote-app-log-dir-suffix"来确定日志移动到的位置 --\x3e')]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 用户可以通过应用程序时间服务器访问日志 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 启用日志聚合功能，应用程序完成后，收集各个节点的日志到一起便于查看 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.log-aggregation-enable"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 开启RM高可靠 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.ha.enabled"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定RM的cluster id为yrc，意为yarn cluster --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.cluster-id"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yrc"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定RM的名字 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.ha.rm-ids"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("rm1,rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定第一个RM的地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.hostname.rm1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node04"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定第二个RM的地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.hostname.rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node05"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 配置第一台机器的resourceManager通信地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--客户端通过该地址向RM提交对应用程序操作--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.address.rm1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node04:8032"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--向RM调度资源地址--\x3e")]),t._v(" \n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.scheduler.address.rm1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node04:8030"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--NodeManager通过该地址交换信息--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.resource-tracker.address.rm1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node04:8031"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--管理员通过该地址向RM发送管理命令--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.admin.address.rm1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node04:8033"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--RM HTTP访问地址,查看集群信息--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.webapp.address.rm1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node04:8088"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 配置第二台机器的resourceManager通信地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.address.rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node05:8032"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.scheduler.address.rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node05:8030"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.resource-tracker.address.rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node05:8031"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.admin.address.rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node05:8033"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.webapp.address.rm2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node05:8088"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--开启resourcemanager自动恢复功能--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.recovery.enabled"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\t\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--在node4上配置rm1,在node5上配置rm2,注意：一般都喜欢把配置好的文件远程复制到其它机器上，但这个在YARN的另一个机器上一定要修改，其他机器上不配置此项--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--\n    <property>       \n\t\t<name>yarn.resourcemanager.ha.id</name>\n\t\t<value>rm1</value>\n\t   <description>If we want to launch more than one RM in single node, we need this configuration</description>\n\t</property>\n\t--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--用于持久存储的类。尝试开启--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.store.class"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 基于zookeeper的实现 --\x3e")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 单个任务可申请最少内存，默认1024MB --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.scheduler.minimum-allocation-mb"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("512"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--多长时间聚合删除一次日志 此处--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.log-aggregation.retain-seconds"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2592000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--30 day--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--时间在几秒钟内保留用户日志。只适用于如果日志聚合是禁用的--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.nodemanager.log.retain-seconds"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("604800"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--7 day--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 指定zk集群地址 --\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.resourcemanager.zk-address"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01:2181,node02:2181,node03:2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 逗号隔开的服务列表，列表名称应该只包含a-zA-Z0-9_,不能以数字开始--\x3e")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("yarn.nodemanager.aux-services"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mapreduce_shuffle"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("property")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"_3-7-修改slaves"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-修改slaves"}},[t._v("#")]),t._v(" 3.7 修改slaves")]),t._v(" "),n("blockquote",[n("p",[t._v("node01、node02、node03上运行了datanode、nodemanager，所以修改slaves内容"),n("strong",[t._v("替换")]),t._v("为：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("node01\nnode02\nnode03\n")])])]),n("h4",{attrs:{id:"node01上分发hadoop文件夹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node01上分发hadoop文件夹"}},[t._v("#")]),t._v(" node01上分发hadoop文件夹")]),t._v(" "),n("blockquote",[n("p",[t._v("拷贝到"),n("code",[t._v("node02~node05")])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -r /kkb/install/hadoop-2.6.0-cdh5.14.2/ node02:/kkb/install/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -r /kkb/install/hadoop-2.6.0-cdh5.14.2/ node03:/kkb/install/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -r /kkb/install/hadoop-2.6.0-cdh5.14.2/ node04:/kkb/install/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node01 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -r /kkb/install/hadoop-2.6.0-cdh5.14.2/ node05:/kkb/install/\n")])])]),n("h4",{attrs:{id:"修改node04-05rm的yarn-site-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改node04-05rm的yarn-site-xml"}},[t._v("#")]),t._v(" 修改node04/05RM的yarn-site.xml")]),t._v(" "),n("ul",[n("li",[t._v("在"),n("strong",[t._v("node04")]),t._v("上，找到属性"),n("code",[t._v("yarn.resourcemanager.ha.id")]),t._v("去除注释①、②")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node04 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hadoop-2.6.0-cdh5.14.2/etc/hadoop\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node04 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" yarn-site.xml \n")])])]),n("p",[n("img",{attrs:{src:s(1457),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("在"),n("strong",[t._v("node05")]),t._v("上\n"),n("ul",[n("li",[t._v("找到属性"),n("code",[t._v("yarn.resourcemanager.ha.id")]),t._v("去除注释"),n("strong",[t._v("①、②")])]),t._v(" "),n("li",[n("strong",[t._v("③")]),t._v("修改成rm2")])])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node05 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hadoop-2.6.0-cdh5.14.2/etc/hadoop/\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node05 hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" yarn-site.xml\n")])])]),n("p",[n("img",{attrs:{src:s(1458),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("修改后，结果如下")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1459),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"配置hadoop环境变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置hadoop环境变量"}},[t._v("#")]),t._v(" 配置hadoop环境变量")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("node01到node05五个节点都配置环境变量")])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将hadoop添加到环境变量中")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/profile\n")])])]),n("ul",[n("li",[t._v("添加内容如下（注意：若HADOOP_HOME已经存在，则修改）：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("HADOOP_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hadoop-2.6.0-cdh5.14.2/\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$HADOOP_HOME")]),t._v("/bin:"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$HADOOP_HOME")]),t._v("/sbin\n")])])]),n("ul",[n("li",[t._v("编译文件，使新增环境变量生效")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile\n")])])]),n("h4",{attrs:{id:"启动与初始化hadoop集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动与初始化hadoop集群"}},[t._v("#")]),t._v(" 启动与初始化hadoop集群")]),t._v(" "),n("blockquote",[n("p",[t._v("**注意：**严格按照下面的步骤 先检查各台hadoop环境变量是否设置好")])]),t._v(" "),n("h4",{attrs:{id:"启动zookeeper集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动zookeeper集群"}},[t._v("#")]),t._v(" 启动zookeeper集群")]),t._v(" "),n("blockquote",[n("p",[t._v("注意：根据zookeeper实际安装情况，启动zookeeper")])]),t._v(" "),n("p",[t._v("分别在node01、node02、node03上启动zookeeper")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("zkServer.sh start\n")])])]),n("p",[t._v("#查看状态：一个为leader，另外两个为follower")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("zkServer.sh status\n")])])]),n("h4",{attrs:{id:"启动hdfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动hdfs"}},[t._v("#")]),t._v(" 启动HDFS")]),t._v(" "),n("h5",{attrs:{id:"_4-2-1-格式化zk"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-格式化zk"}},[t._v("#")]),t._v(" 4.2.1 格式化ZK")]),t._v(" "),n("blockquote",[n("p",[t._v("在"),n("strong",[t._v("node01")]),t._v("上执行即可")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("集群有两个namenode，分别在node01、node02上")])]),t._v(" "),n("li",[n("p",[t._v("每个namenode对应一个zkfc进程；")])]),t._v(" "),n("li",[n("p",[t._v("在主namenode node01上格式化zkfc")])])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hdfs zkfc -formatZK\n")])])]),n("h5",{attrs:{id:"_4-2-2-启动journalnode"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-启动journalnode"}},[t._v("#")]),t._v(" 4.2.2 启动journalnode")]),t._v(" "),n("ul",[n("li",[t._v("在"),n("strong",[t._v("node01")]),t._v("上执行\n"),n("ul",[n("li",[t._v("会启动node01、node02、node03上的journalnode")]),t._v(" "),n("li",[t._v("因为使用的是hadoop-daemon"),n("strong",[t._v("s")]),t._v(".sh")])])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop-daemons.sh start journalnode\n")])])]),n("ul",[n("li",[t._v("运行jps命令检验，node01、node02、node03上多了JournalNode进程")])]),t._v(" "),n("h5",{attrs:{id:"_4-2-3-格式化hdfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-格式化hdfs"}},[t._v("#")]),t._v(" 4.2.3 格式化HDFS")]),t._v(" "),n("ul",[n("li",[t._v("在node01上执行")]),t._v(" "),n("li",[t._v("根据集群规划node01、node02上运行namenode；所以"),n("strong",[t._v("只在主namenode节点")]),t._v("即node01上执行命令:\n"),n("ul",[n("li",[t._v("此命令慎用；只在集群搭建（初始化）时使用一次；")]),t._v(" "),n("li",[t._v("一旦再次使用，会将HDFS上之前的数据格式化删除掉")])])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hdfs namenode -format\n")])])]),n("ul",[n("li",[t._v("下图表示格式化成功")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1460),alt:""}})]),t._v(" "),n("h5",{attrs:{id:"_4-2-4-初始化元数据、启动主nn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-初始化元数据、启动主nn"}},[t._v("#")]),t._v(" 4.2.4 初始化元数据、启动主NN")]),t._v(" "),n("ul",[n("li",[t._v("node01上执行（主namenode）")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hdfs namenode -initializeSharedEdits -force\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动HDFS")]),t._v("\nstart-dfs.sh\n")])])]),n("h5",{attrs:{id:"_4-2-5-同步元数据信息、启动从nn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-同步元数据信息、启动从nn"}},[t._v("#")]),t._v(" 4.2.5 同步元数据信息、启动从NN")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("node02")]),t._v("上执行（从namenode）")]),t._v(" "),n("li",[t._v("同步元数据信息，并且设置node02上namenode为standBy状态")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hdfs namenode -bootstrapStandby\nhadoop-daemon.sh start namenode\n")])])]),n("h5",{attrs:{id:"_4-2-5-jps查看进程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-jps查看进程"}},[t._v("#")]),t._v(" 4.2.5 JPS查看进程")]),t._v(" "),n("ul",[n("li",[t._v("node01上")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1461),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("node02上")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1462),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("node03上")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1463),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"启动yarn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动yarn"}},[t._v("#")]),t._v(" 启动YARN")]),t._v(" "),n("h5",{attrs:{id:"_4-6-1-主resourcemanager"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-1-主resourcemanager"}},[t._v("#")]),t._v(" 4.6.1 "),n("strong",[t._v("主resourcemanager")])]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("node04")]),t._v("上执行（"),n("strong",[t._v("主resourcemanager")]),t._v("）\n"),n("ul",[n("li",[t._v("把namenode和resourcemanager部署在不同节点，是因为性能问题，因为他们都要占用大量资源")]),t._v(" "),n("li",[t._v("坑：在node04上启动yarn之前，先依次从node04 ssh远程连接到node01、node02、node03、node04、node05；因为初次ssh时，需要交互，输入yes，回车")])])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("start-yarn.sh\n")])])]),n("h5",{attrs:{id:"_4-6-2-从resourcemanager"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-2-从resourcemanager"}},[t._v("#")]),t._v(" 4.6.2 从resourcemanager")]),t._v(" "),n("ul",[n("li",[t._v("在从resourcemanager即"),n("strong",[t._v("node05")]),t._v("上启动rm")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("yarn-daemon.sh start resourcemanager\n")])])]),n("h5",{attrs:{id:"_4-6-3-查看resourcemanager状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-3-查看resourcemanager状态"}},[t._v("#")]),t._v(" 4.6.3 查看resourceManager状态")]),t._v(" "),n("ul",[n("li",[t._v("node04上，它的resourcemanager的Id是rm1")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" rmadmin -getServiceState rm1\n")])])]),n("ul",[n("li",[t._v("node05上，它的resourcemanager的Id是rm2")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" rmadmin -getServiceState rm2\n")])])]),n("h4",{attrs:{id:"启动jobhistory"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动jobhistory"}},[t._v("#")]),t._v(" 启动JobHistory")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("node03")]),t._v("上执行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("mr-jobhistory-daemon.sh start historyserver\n")])])]),n("h4",{attrs:{id:"验证集群是否可用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#验证集群是否可用"}},[t._v("#")]),t._v(" 验证集群是否可用")]),t._v(" "),n("h5",{attrs:{id:"_5-1-验证hdfs-ha"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-验证hdfs-ha"}},[t._v("#")]),t._v(" 5.1 验证HDFS HA")]),t._v(" "),n("h6",{attrs:{id:"_5-1-1-访问web-ui"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-1-访问web-ui"}},[t._v("#")]),t._v(" 5.1.1 访问WEB UI")]),t._v(" "),n("blockquote",[n("p",[t._v("node01、node02一主一备")])]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v("http://node01:50070\n")])])]),n("p",[n("img",{attrs:{src:s(1464),alt:""}})]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("http://node02:50070\n")])])]),n("p",[n("img",{attrs:{src:s(1465),alt:""}})]),t._v(" "),n("h6",{attrs:{id:"_5-1-2-模拟主备切换"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-2-模拟主备切换"}},[t._v("#")]),t._v(" 5.1.2 模拟主备切换")]),t._v(" "),n("ul",[n("li",[t._v("在主namenode节点，运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop-daemon.sh stop namenode\n")])])]),n("ul",[n("li",[n("p",[t._v('访问之前为"备namenode"的WEB UI；发现状态更新为active')])]),t._v(" "),n("li",[n("p",[t._v("或者使用命令查看状态")])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hdfs haadmin -getServiceState nn2\n")])])]),n("p",[n("img",{attrs:{src:s(1466),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("启动刚才手动停掉的namenode")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop-daemon.sh start namenode\n")])])]),n("ul",[n("li",[n("p",[t._v("访问它的WEB UI，发现状态更新为standby")])]),t._v(" "),n("li",[n("p",[t._v("或者使用命令查看状态")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("hdfs haadmin -getServiceState nn1\n")])])]),n("p",[n("img",{attrs:{src:s(1467),alt:""}})]),t._v(" "),n("h5",{attrs:{id:"_5-2-验证yarn-ha"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-验证yarn-ha"}},[t._v("#")]),t._v(" 5.2 验证Yarn HA")]),t._v(" "),n("blockquote",[n("p",[t._v("node04、node05主备切换")])]),t._v(" "),n("h6",{attrs:{id:"_5-2-1-访问web-ui"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-1-访问web-ui"}},[t._v("#")]),t._v(" 5.2.1 访问WEB UI")]),t._v(" "),n("ul",[n("li",[t._v("node04浏览器访问")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("http://node04:8088/cluster/cluster\n")])])]),n("p",[n("img",{attrs:{src:s(1468),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("node05浏览器访问")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("http://node05:8088/cluster/cluster\n")])])]),n("p",[n("img",{attrs:{src:s(1469),alt:""}})]),t._v(" "),n("h6",{attrs:{id:"_5-2-2-模拟主备切换"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-2-模拟主备切换"}},[t._v("#")]),t._v(" 5.2.2 模拟主备切换")]),t._v(" "),n("ul",[n("li",[t._v("在主resourcemanager节点，运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("yarn-daemon.sh stop resourcemanager\n")])])]),n("ul",[n("li",[n("p",[t._v('访问之前为"备resourcemanager"的WEB UI；发现状态更新为active')])]),t._v(" "),n("li",[n("p",[t._v("或者命令查看状态")])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" rmadmin -getServiceState rm2\n")])])]),n("p",[n("img",{attrs:{src:s(1470),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("启动刚才手动停掉的resourcemanager")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("yarn-daemon.sh start resourcemanager\n")])])]),n("ul",[n("li",[n("p",[t._v("访问它的WEB UI，发现状态更新为standby")])]),t._v(" "),n("li",[n("p",[t._v("或者命令查看状态")])])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" rmadmin -getServiceState rm1\n")])])]),n("p",[n("img",{attrs:{src:s(1471),alt:""}})]),t._v(" "),n("h6",{attrs:{id:"_5-2-3-运行mr示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-3-运行mr示例"}},[t._v("#")]),t._v(" 5.2.3 运行MR示例")]),t._v(" "),n("ul",[n("li",[t._v("运行一下hadoop示例中的WordCount程序：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop fs -put /kkb/install/hadoop-2.6.0-cdh5.14.2/LICENSE.txt /\nhadoop jar /kkb/install/hadoop-2.6.0-cdh5.14.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.6.0-cdh5.14.2.jar wordcount /LICENSE.txt /w0727\n")])])]),n("h4",{attrs:{id:"集群常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#集群常用命令"}},[t._v("#")]),t._v(" 集群常用命令")]),t._v(" "),n("h5",{attrs:{id:"关闭hadoop-ha集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关闭hadoop-ha集群"}},[t._v("#")]),t._v(" 关闭Hadoop HA集群")]),t._v(" "),n("blockquote",[n("p",[t._v("正确指令执行顺序如下")])]),t._v(" "),n("ul",[n("li",[t._v("主namenode上运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("stop-dfs.sh\n")])])]),n("ul",[n("li",[t._v("主resoucemanager上运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("stop-yarn.sh\n")])])]),n("ul",[n("li",[t._v("从resoucemanager上运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("yarn-daemon.sh stop resourcemanager\n")])])]),n("ul",[n("li",[t._v("关闭zookeeper集群；每个zk服务器运行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("zkServer.sh stop\n")])])]),n("h5",{attrs:{id:"常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),n("ul",[n("li",[t._v("单独启动namenode")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop-daemon.sh start namenode\n")])])]),n("ul",[n("li",[t._v("单独启动datanode")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop-daemon.sh start datanode\n")])])]),n("ul",[n("li",[t._v("单独启动journalnode")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hadoop-daemon.sh start journalnode\n")])])]),n("ul",[n("li",[t._v("启动zookeeper")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("./zkServer.sh start\n")])])]),n("ul",[n("li",[t._v("启动hdfs")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("start-dfs.sh\n")])])]),n("ul",[n("li",[t._v("启动yarn")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("start-yarn.sh\n")])])]),n("ul",[n("li",[t._v("单独启动resorucemanager")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("yarn-daemon.sh start resouremanger\n")])])]),n("ul",[n("li",[t._v("查看namenode状态（namenode1）")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("hdfs haadmin -getServiceState nn1\n")])])]),n("ul",[n("li",[t._v("查看resourcemanager状态（resourcemanager2）")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" rmadmin -getServiceState rm2\n")])])]),n("h2",{attrs:{id:"zookeeper学习目标"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper学习目标"}},[t._v("#")]),t._v(" zookeeper学习目标")]),t._v(" "),n("ol",[n("li",[t._v("学会"),n("code",[t._v("ZooKeeper")]),t._v("的基本使用：命令行、"),n("code",[t._v("Java")]),t._v("编程")]),t._v(" "),n("li",[t._v("理解"),n("code",[t._v("ZooKeeper watcher")]),t._v("监听器工作原理：注册、监听事件、回调函数（考点）")]),t._v(" "),n("li",[t._v("能独立描述出"),n("code",[t._v("ZooKeeper")]),t._v("选举过程（难点、考点）")]),t._v(" "),n("li",[t._v("理解、并讲述客户端从"),n("code",[t._v("ZooKeeper")]),t._v("读写的过程（考点）")])]),t._v(" "),n("h2",{attrs:{id:"zookeeper介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper介绍"}},[t._v("#")]),t._v(" ZooKeeper介绍")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("Zookeeper")]),t._v("是一个分布式协调框架，是"),n("code",[t._v("Google")]),t._v("的"),n("code",[t._v("Chubby")]),t._v("的一个开源实现版。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("ZooKeeper")]),t._v("是一个开源的"),n("strong",[t._v("主从架构")]),t._v("的分布式框架，"),n("code",[t._v("leader")]),t._v("为主；"),n("code",[t._v("follower")]),t._v("为从，为其他的分布式框架"),n("strong",[t._v("提供协调服务（service）")]),t._v("。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("Zookeeper")]),t._v(" 作为一个分布式的服务框架")]),t._v(" "),n("ul",[n("li",[t._v("它提供类似于"),n("code",[t._v("linux")]),t._v("文件系统（有"),n("strong",[t._v("目录节点树")]),t._v("）的简版文件系统来存储数据")]),t._v(" "),n("li",[n("code",[t._v("Zookeeper")]),t._v(" 维护和"),n("strong",[t._v("监控")]),t._v("存储的数据的"),n("strong",[t._v("状态变化")]),t._v("，通过监控这些数据状态的变化，从而达到基于数据的集群管理")]),t._v(" "),n("li",[t._v("主要用来解决分布式集群中应用系统的"),n("strong",[t._v("一致性")]),t._v("问题")])]),t._v(" "),n("p",[n("strong",[t._v("hadoop生态圈：")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1472),alt:""}})]),t._v(" "),n("p",[n("img",{attrs:{src:s(345),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"为什么要用zookeeper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用zookeeper"}},[t._v("#")]),t._v(" 为什么要用ZooKeeper")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("分布式框架多个独立的程序协同工作比较复杂")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("开发人员容易花较多的精力实现如何使多个程序协同工作的逻辑")])]),t._v(" "),n("li",[t._v("导致没有时间更好的思考实现程序本身的逻辑")]),t._v(" "),n("li",[t._v("或者开发人员对程序间的协同工作关注不够，造成协调问题")]),t._v(" "),n("li",[t._v("且这个分布式框架中协同工作的逻辑是共性的需求")])])]),t._v(" "),n("li",[n("p",[t._v("ZooKeeper简单易用，能够很好的解决分布式框架在运行中，出现的各种协调问题。")]),t._v(" "),n("ul",[n("li",[t._v("比如"),n("strong",[t._v("集群"),n("code",[t._v("master")]),t._v("主备切换、节点的上下线感知、统一命名服务、状态同步服务、集群管理、分布式应用配置管理")]),t._v("等等")])])])]),t._v(" "),n("h2",{attrs:{id:"zkcli命令行操作zookeeper集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zkcli命令行操作zookeeper集群"}},[t._v("#")]),t._v(" zkCli命令行操作Zookeeper集群")]),t._v(" "),n("h6",{attrs:{id:"zookeeper脚本存放路径"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper脚本存放路径"}},[t._v("#")]),t._v(" zookeeper脚本存放路径")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("/kkb/install/zookeeper-3.4.5-cdh5.14.2/bin\n")])])]),n("h6",{attrs:{id:"zookeeper启动与关闭"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper启动与关闭"}},[t._v("#")]),t._v(" zookeeper启动与关闭")]),t._v(" "),n("p",[t._v("特别注意，启动zk集群的时候每个节点都要执行启动命令，否则报错。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 启动ZooKeeper集群；在ZooKeeper集群中的每个节点执行此命令")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ZK_HOME}")]),t._v("/bin/zkServer.sh start\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 停止ZooKeeper集群（每个节点执行以下命令）")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ZK_HOME}")]),t._v("/bin/zkServer.sh stop\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 查看集群状态（每个节点执行此命令）")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${ZK_HOME}")]),t._v("/bin/zkServer.sh status\n")])])]),n("h6",{attrs:{id:"客户端连接zkserver服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端连接zkserver服务器"}},[t._v("#")]),t._v(" 客户端连接zkServer服务器")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 使用ZooKeeper自带的脚本，连接ZooKeeper的服务器")]),t._v("\nzkCli.sh -server node01:2181,node02:2181,node03:2181\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## -server选项后指定参数node01:2181,node02:2181,node03:2181")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#客户端会随机的连接三个服务器中的一个")]),t._v("\n")])])]),n("h6",{attrs:{id:"查看通信端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看通信端口"}},[t._v("#")]),t._v(" 查看通信端口")]),t._v(" "),n("p",[t._v("查看"),n("code",[t._v("${ZK_HOME}/conf/zoo.cfg")]),t._v("配置文件：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /kkb/install/zookeeper-3.4.5-cdh5.14.2/conf/zoo.cfg\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The number of milliseconds of each tick")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("tickTime")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#集群进行通信的基本时间单位，2000毫秒")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The number of ticks that the initial ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## synchronization phase can take")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("initLimit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#集在启动的时候初始化的最长时间： 10*2000毫秒")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The number of ticks that can pass between ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## sending a request and getting an acknowledgement")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("syncLimit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#主节点与从节点进行通信的时间")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## the directory where the snapshot is stored.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## do not use /tmp for storage, /tmp here is just ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## example sakes.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dataDir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#往zk集群读写数据的路径，每个zk服务器都有这个路径")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## the port at which the clients will connect")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("clientPort")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#客户端与集群通信的端口")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## the maximum number of client connections.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## increase this if you need to handle more clients")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#maxClientCnxns=60")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Be sure to read the maintenance section of the ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## administrator guide before turning on autopurge.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The number of snapshots to retain in dataDir")]),t._v("\nautopurge.snapRetainCount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#快照默认保存多少个")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Purge task interval in hours")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('## Set to "0" to disable auto purge feature')]),t._v("\nautopurge.purgeInterval"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#每隔1小时清理以下快照")]),t._v("\n\nserver.1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node01:2888:3888  \nserver.2"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node02:2888:3888 \nserver.3"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node03:2888:3888\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#上面的1、2、3是服务器的id号，2888是zk集群内部各个服务器之间的通信端口，3888是用于选举的端口")]),t._v("\n")])])]),n("h6",{attrs:{id:"查看支持的命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看支持的命令"}},[t._v("#")]),t._v(" 查看支持的命令")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("zk: node01:2181,node02:2181,node03:2181"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CLOSED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("help")]),t._v("\nZooKeeper -server host:port cmd args\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stat")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看path节点状态（可设置watcher)")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" path data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看节点数据")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看节点有哪些子节点（可设置watcher）")]),t._v("\n        delquota "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" path\n        ls2 path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看节点有哪些子节点、状态、相当于ls+stat(可设置watcher)")]),t._v("\n        setAcl path acl "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置访问控制列表")]),t._v("\n        setquota -n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-b val path\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("history")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看session中，输入过的命令")]),t._v("\n        redo cmdno\n        printwatches on"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off\n        delete path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除节点")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),t._v(" path\n        listquota path\n        rmr path  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除节点")]),t._v("\n        get path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获得节点各种数据（可设置watcher）")]),t._v("\n        create "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" path data acl "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#创建节点并设置数据")]),t._v("\n        addauth scheme auth\n        quit "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#退出命令行")]),t._v("\n        getAcl path\n        close "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#关闭session")]),t._v("\n        connect host:port  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#连接zookeeper集群服务器")]),t._v("\n")])])]),n("h6",{attrs:{id:"常用命令-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用命令-2"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),n("p",[t._v("注意："),n("code",[t._v("zk")]),t._v("集群的每个服务器的文件系统的内容都是一致的，比如说，往"),n("code",[t._v("node01")]),t._v("上的"),n("code",[t._v("zk")]),t._v("服务器的文件系统写入数据，那么"),n("code",[t._v("node02")]),t._v("和"),n("code",[t._v("node03")]),t._v("上的"),n("code",[t._v("zk")]),t._v("服务器的文件系统也会写入相同的数据。（原理后面会讲）")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看ZooKeeper根目录/下的文件列表")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#创建节点，并指定数据")]),t._v("\ncreate /kkb\tkrystal "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#创建节点的时候一定要指定数据")]),t._v("\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获得某节点的数据")]),t._v("\nget /kkb\n\nkrystal\ncZxid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 0x300000007\nctime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Tue Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" 00:26:33 CST "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\nmZxid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 0x300000007\nmtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Tue Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" 00:26:33 CST "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\npZxid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 0x300000007\ncversion "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\ndataVersion "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\naclVersion "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nephemeralOwner "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 0x0\ndataLength "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\nnumChildren "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#修改节点的数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" /kkb kkb01\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除节点")]),t._v("\ndelete /kkb\n")])])]),n("h2",{attrs:{id:"java-api编程-重点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#java-api编程-重点"}},[t._v("#")]),t._v(" Java API编程（重点 ）")]),t._v(" "),n("h3",{attrs:{id:"原生api编程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#原生api编程"}},[t._v("#")]),t._v(" 原生API编程")]),t._v(" "),n("p",[t._v("比较复杂")]),t._v(" "),n("h3",{attrs:{id:"curator编程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#curator编程"}},[t._v("#")]),t._v(" curator编程")]),t._v(" "),n("p",[n("code",[t._v("Curator")]),t._v("对"),n("code",[t._v("ZooKeeper")]),t._v("的"),n("code",[t._v("api")]),t._v("做了封装，提供简单易用的"),n("code",[t._v("api")]),t._v("。它的风格是"),n("code",[t._v("Curator")]),t._v("链式编程，可以参考《使用"),n("code",[t._v("curator")]),t._v("做"),n("code",[t._v("zk")]),t._v("编程》。"),n("a",{attrs:{href:"http://curator.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Curator官网"),n("OutboundLink")],1),t._v("：http://curator.apache.org/")]),t._v(" "),n("h4",{attrs:{id:"创建maven工程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建maven工程"}},[t._v("#")]),t._v(" 创建Maven工程")]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xmlns")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://maven.apache.org/POM/4.0.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("xsi")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.w3.org/2001/XMLSchema-instance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xsi:")]),t._v("schemaLocation")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("modelVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.0.0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("modelVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.example"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("MyZookeeper"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.0-SNAPSHOT"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.zookeeper"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("zookeeper"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("3.4.13"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.curator"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("curator-recipes"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.2.0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.curator"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("curator-framework"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.2.0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.12"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("compile"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.testng"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("testng"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("RELEASE"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("log4j"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("log4j"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.2.17"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.maven.plugins"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("maven-compiler-plugin"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("8"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("8"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h4",{attrs:{id:"案例1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#案例1"}},[t._v("#")]),t._v(" 案例1")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jimmy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("day04")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFramework")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFrameworkFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChildData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCache")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCacheEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCacheListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("retry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetryNTimes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zookeeper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CreateMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("After")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Before")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorClientDemo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置要连接的zookeeper的服务器")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ZK_ADDRESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node01:2181,node02:2181,node03:2181"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置要操作zk节点ZNode")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ZK_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/zk_test"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ZK_PATH01 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/beijing/goddess/anzhulababy"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFramework")]),t._v(" client "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Before")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化，建立连接，运行@Test方法之前就会执行这个方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//客户端会随机连接某个zk服务器，如果连接失败，就会重新尝试连接到另一个服务器")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置重试连接策略，失败重试次数；10,每次休眠（重试间隔）5000毫秒")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetryNTimes")]),t._v(" retryPolicy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetryNTimes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获得客户端对象，参数1：指定连接的服务器集端口列表；参数2：重试策略")]),t._v("\n        client "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFrameworkFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("newClient")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_ADDRESS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" retryPolicy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//启动客户端，连接到zk集群")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zk client start successfully!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//运行@Test方法后才会执行该方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@After")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭连接")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("clean")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"close session"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//运行@Before方法之后执行这个方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建永久节点")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPersistentZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" zNodeData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"火辣的"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///a/b/c")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("creatingParentsIfNeeded")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果父目录不存在，则创建")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("withMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CreateMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PERSISTENT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建永久节点")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/beijing/goddess/anzhulababy"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" zNodeData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//指定路径及节点数据")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建临时节点")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEphemeralZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" zNodeData2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"流星雨"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("creatingParentsIfNeeded")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("withMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CreateMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EPHEMERAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ɪˈfemərəl")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/beijing/star"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" zNodeData2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询znode数据")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryZNodeData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查询列表")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ls"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getChildren")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//查询节点数据")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkExists")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//判断znode是否存在")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果存在则获得znode的数据")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"节点不存在"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("modifyZNodeData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//修改前的数据")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" data2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"welcome to jumanji"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"set"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改节点数据")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//修改后的数据")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 删除节点")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"delete"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ls"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getChildren")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//监听ZNode")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watchZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//cache: TreeCache\\PathChildrenCache\\DataCache")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置节点的cache缓存对象")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCache")]),t._v(" treeCache "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCache")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/zk_test"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置监听器")]),t._v("\n        treeCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getListenable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCacheListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//处理过程：")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("childEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFramework")]),t._v(" client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeCacheEvent")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChildData")]),t._v(" data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" NODE_ADDED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("添加了节点\n                            "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NODE_ADDED : "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"  数据:"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" NODE_REMOVED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("节点被删除了\n                            "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NODE_REMOVED : "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"  数据:"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" NODE_UPDATED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("数据被更新了\n                            "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NODE_UPDATED : "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"  数据:"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data is null : "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//开始监听")]),t._v("\n        treeCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭cache")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"关闭treeCache"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        treeCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorClientDemo")]),t._v(" ccd"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorClientDemo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPersistentZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEphemeralZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryZNodeData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("modifyZNodeData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watchZNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ccd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("clean")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" cmds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringBuilder")]),t._v(" text "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringBuilder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$ "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" cmds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                result "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("strong",[t._v("补充：")])]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Before")]),t._v(" – 表示在任意使用"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("注解标注的"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("方法执行之前执行\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@After")]),t._v(" – 表示在任意使用"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("注解标注的"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("方法执行之后执行\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v(" – 使用该注解标注的"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v("方法会表示为一个测试方法\n")])])]),n("h4",{attrs:{id:"案例2-另一中监听器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#案例2-另一中监听器"}},[t._v("#")]),t._v(" 案例2：另一中监听器")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jimmy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("day04")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFramework")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFrameworkFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCache")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCacheEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("framework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recipes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCacheListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("retry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetryNTimes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZKPaths")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorWatcherDemo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Zookeeper info\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ZK_ADDRESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"note01:2181,node02:2181,node03:2181"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ZK_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/zktest"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.Connect to zk")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFramework")]),t._v(" client "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFrameworkFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("newClient")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                ZK_ADDRESS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetryNTimes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zk client start successfully!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//path cache")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("///zktest/b/a")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCache")]),t._v(" pathCache "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCache")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ZK_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//只能监听ZK_PATH对应节点下一级目录的子节点的变化内容")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 即只能监听/ZK_PATH/node1的变化，而不能监听/ZK_PATH/node1/node2 的变化")]),t._v("\n        \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Listener for PathChildrenCache changes")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCacheListener")]),t._v(" listener "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCacheListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("childEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CuratorFramework")]),t._v(" client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCacheEvent")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" CHILD_ADDED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Node added: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZKPaths")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNodeFromPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" CHILD_UPDATED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Node changed: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZKPaths")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNodeFromPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" CHILD_REMOVED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Node removed: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZKPaths")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNodeFromPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              java  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//添加监听器")]),t._v("\n        pathCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getListenable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("listener"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//开启缓存")]),t._v("\n        pathCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PathChildrenCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StartMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BUILD_INITIAL_CACHE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Register zk pathCache successfully!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭缓存")]),t._v("\n        pathCache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭zk连接")]),t._v("\n        client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"zookeeper基本概念和操作-todo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper基本概念和操作-todo"}},[t._v("#")]),t._v(" Zookeeper基本概念和操作(TODO)")]),t._v(" "),n("blockquote",[n("p",[t._v("分布式通信有几种方式")]),t._v(" "),n("p",[t._v("1、直接通过网络连接的方式进行通信")]),t._v(" "),n("p",[t._v("2、通过共享存储的方式，来进行通信或数据的传输")]),t._v(" "),n("p",[t._v("ZooKeeper使用第二种方式，提供分布式协调服务")])]),t._v(" "),n("h2",{attrs:{id:"zookeeper数据结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper数据结构"}},[t._v("#")]),t._v(" ZooKeeper数据结构")]),t._v(" "),n("p",[n("code",[t._v("ZooKeeper")]),t._v("主要由以下三个部分实现")]),t._v(" "),n("ol",[n("li",[t._v("简版文件系统("),n("code",[t._v("Znode")]),t._v(")：基于类似于文件系统的"),n("strong",[t._v("目录节点树")]),t._v("方式的数据存储")]),t._v(" "),n("li",[t._v("原语：可简单理解成ZooKeeper的基本的命令")]),t._v(" "),n("li",[t._v("通知机制("),n("code",[t._v("Watcher")]),t._v(")。")])]),t._v(" "),n("p",[n("strong",[t._v("watcher示意图：")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1473),alt:"image-20200218003759092"}})]),t._v(" "),n("h2",{attrs:{id:"zookeeper数据节点znode"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper数据节点znode"}},[t._v("#")]),t._v(" Zookeeper数据节点ZNode")]),t._v(" "),n("p",[t._v("在"),n("code",[t._v("Zookeeper")]),t._v("里，我们不把文件系统的目录称为目录，而是称为节点"),n("code",[t._v("ZNode")]),t._v("。")]),t._v(" "),n("p",[n("strong",[n("code",[t._v("ZNode")]),t._v(" 分为四类：")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th"),t._v(" "),n("th",[t._v("持久节点")]),t._v(" "),n("th",[t._v("临时节点")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("非有序节点")]),t._v(" "),n("td",[n("code",[t._v("create")])]),t._v(" "),n("td",[n("code",[t._v("create -e")])])]),t._v(" "),n("tr",[n("td",[t._v("有序节点")]),t._v(" "),n("td",[n("code",[t._v("create -s")])]),t._v(" "),n("td",[n("code",[t._v("create -s -e")])])])])]),t._v(" "),n("h4",{attrs:{id:"持久节点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#持久节点"}},[t._v("#")]),t._v(" 持久节点")]),t._v(" "),n("p",[t._v("持久节点在会话结束之后，还会依然存在"),n("code",[t._v("zk")]),t._v("文件系统里。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 创建持久节点/zk_test，并设置数据my_data")]),t._v("\ncreate /zk_test my_data\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 持久节点，只有显示的调用命令，才能删除永久节点")]),t._v("\ndelete /zk_test\n")])])]),n("h4",{attrs:{id:"临时节点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#临时节点"}},[t._v("#")]),t._v(" 临时节点")]),t._v(" "),n("p",[t._v("临时节点的生命周期跟客户端会话"),n("code",[t._v("session")]),t._v("绑定，"),n("strong",[t._v("一旦会话失效，临时节点被删除")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## client1上创建临时节点")]),t._v("\ncreate -e /tmp tmpdata\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## client2上查看client1创建的临时节点")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## client1断开连接")]),t._v("\nclose\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## client2上观察现象，发现临时节点被自动删除")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /\n")])])]),n("h4",{attrs:{id:"非有序节点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非有序节点"}},[t._v("#")]),t._v(" 非有序节点")]),t._v(" "),n("p",[t._v("通过上面的方式创建的节点，"),n("strong",[t._v("默认都是非有序的")]),t._v("。")]),t._v(" "),n("h4",{attrs:{id:"有序节点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#有序节点"}},[t._v("#")]),t._v(" 有序节点")]),t._v(" "),n("p",[n("code",[t._v("ZNode")]),t._v("也可以设置为有序节点，主要是为了避免多个客户端写入同名称的文件导致文件重名的情况。防止多个不同的客户端在同一目录下，创建同名"),n("code",[t._v("ZNode")]),t._v("，由于重名，导致创建失败。")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1474),alt:"image-20200218005827323"}})]),t._v(" "),n("p",[t._v("一旦节点被标记上这个属性，那么在这个节点被创建时，"),n("code",[t._v("ZooKeeper")]),t._v(" 就会自动在其节点后面追加上一个整型数字。这个整数是一个由父节点维护的自增数字。")]),t._v(" "),n("p",[t._v("创建有序节点，使用"),n("code",[t._v("-s")]),t._v("选项："),n("code",[t._v("create -s")]),t._v(" ：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 创建持久、有序节点")]),t._v("\ncreate -s /test01 test01-data\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Created /test010000000009")]),t._v("\n")])])]),n("h2",{attrs:{id:"会话-session"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#会话-session"}},[t._v("#")]),t._v(" 会话（Session)")]),t._v(" "),n("h4",{attrs:{id:"什么是会话"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是会话"}},[t._v("#")]),t._v(" 什么是会话")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("客户端要对"),n("code",[t._v("ZooKeeper")]),t._v("集群进行读写操作，得先与某一"),n("code",[t._v("ZooKeeper")]),t._v("服务器建立"),n("strong",[t._v("TCP长连接")]),t._v("；"),n("strong",[t._v("此TCP长连接称为建立一个会话"),n("code",[t._v("Session")]),t._v("。")])])]),t._v(" "),n("li",[n("p",[t._v("每个会话有超时时间："),n("code",[t._v("SessionTimeout")])]),t._v(" "),n("ul",[n("li",[t._v("当客户端与集群建立会话后，如果超过"),n("code",[t._v("SessionTimeout")]),t._v("时间，两者间没有通信，会话超时")])])])]),t._v(" "),n("h4",{attrs:{id:"会话的特点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#会话的特点"}},[t._v("#")]),t._v(" 会话的特点")]),t._v(" "),n("ul",[n("li",[t._v("客户端打开一个"),n("code",[t._v("Session")]),t._v("中的请求以FIFO（先进先出）的顺序执行；\n"),n("ul",[n("li",[t._v("比如，客户端"),n("code",[t._v("client01")]),t._v("与集群建立会话后，先发出一个"),n("code",[t._v("create")]),t._v("请求，再发出一个"),n("code",[t._v("get")]),t._v("请求。那么在执行时，会先执行"),n("code",[t._v("create")]),t._v("，再执行"),n("code",[t._v("ge")]),t._v("t")])])]),t._v(" "),n("li",[t._v("若打开两个"),n("code",[t._v("Session")]),t._v("，无法保证"),n("code",[t._v("Session")]),t._v("间的请求按照"),n("code",[t._v("FIFO")]),t._v("策略执行；只能保证一个"),n("code",[t._v("session")]),t._v("中的请求的按照"),n("code",[t._v("FIFO")]),t._v("策略执行。")])]),t._v(" "),n("h4",{attrs:{id:"会话的生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#会话的生命周期"}},[t._v("#")]),t._v(" 会话的生命周期")]),t._v(" "),n("p",[t._v("会话的生命周期")]),t._v(" "),n("ul",[n("li",[t._v("未建立连接")]),t._v(" "),n("li",[t._v("正在连接")]),t._v(" "),n("li",[t._v("已连接")]),t._v(" "),n("li",[t._v("关闭连接")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1475),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#请求"}},[t._v("#")]),t._v(" 请求")]),t._v(" "),n("ul",[n("li",[t._v("读写请求\n"),n("ul",[n("li",[t._v("写请求：通过客户端向"),n("code",[t._v("ZooKeeper")]),t._v("集群中写数据")]),t._v(" "),n("li",[t._v("读请求：通过客户端从"),n("code",[t._v("ZooKeeper")]),t._v("集群中读数据")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(345),alt:"ZooKeeper官网架构图"}})]),t._v(" "),n("h2",{attrs:{id:"事务zxid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事务zxid"}},[t._v("#")]),t._v(" 事务zxid")]),t._v(" "),n("p",[t._v("客户端的写请求，会对"),n("code",[t._v("ZooKeeper")]),t._v("中的数据做出更改；如增删改的操作。**每次写请求，都会生成一次事务。**每个事务有一个全局唯一的事务"),n("code",[t._v("ID")]),t._v("，用 "),n("code",[t._v("ZXID")]),t._v(" 表示；全局自增")]),t._v(" "),n("h4",{attrs:{id:"事务的特点-acid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事务的特点-acid"}},[t._v("#")]),t._v(" 事务的特点：ACID")]),t._v(" "),n("blockquote",[n("ol",[n("li",[t._v("原子性（"),n("code",[t._v("Atomicity")]),t._v("）：事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。")]),t._v(" "),n("li",[t._v("一致性（"),n("code",[t._v("Consistency")]),t._v("）：一致性是指事务执行结束后，数据库的完整性约束没有被破坏，事务执行的前后都是合法的数据状态。")]),t._v(" "),n("li",[t._v("隔离性（"),n("code",[t._v("Isolation")]),t._v("）：隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。")]),t._v(" "),n("li",[t._v("持久性（"),n("code",[t._v("Durability")]),t._v("）：持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响。")])]),t._v(" "),n("p",[n("strong",[t._v("原子性示意图：")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1476),alt:"image-20200218014020278"}})]),t._v(" "),n("p",[n("strong",[t._v("持久性的理解：")])]),t._v(" "),n("p",[t._v("操作前A：800，B：200")]),t._v(" "),n("p",[t._v("操作后A：600，B：400")]),t._v(" "),n("p",[t._v("如果在操作前（事务还没有提交）服务器宕机或者断电，那么重启数据库以后，数据状态应该为")]),t._v(" "),n("p",[t._v("A：800，B：200")]),t._v(" "),n("p",[t._v("如果在操作后（事务已经提交）服务器宕机或者断电，那么重启数据库以后，数据状态应该为")]),t._v(" "),n("p",[t._v("A：600，B：400")])]),t._v(" "),n("h4",{attrs:{id:"zxid的结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zxid的结构"}},[t._v("#")]),t._v(" ZXID的结构：")]),t._v(" "),n("ul",[n("li",[t._v("通常是一个64位的数字。由**epoch+counter（累加器）**组成")]),t._v(" "),n("li",[n("code",[t._v("epoch")]),t._v("、"),n("code",[t._v("counter")]),t._v("各32位")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1477),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"watcher-监视与通知"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#watcher-监视与通知"}},[t._v("#")]),t._v(" Watcher：监视与通知")]),t._v(" "),n("h4",{attrs:{id:"为什么要有watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么要有watcher"}},[t._v("#")]),t._v(" 为什么要有Watcher？")]),t._v(" "),n("p",[t._v("首先思考一个问题：客户端如何获取"),n("code",[t._v("ZooKeeper")]),t._v("服务器上的"),n("strong",[t._v("最新数据")]),t._v("？")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("方式一")]),t._v("：轮询")]),t._v(" "),n("p",[n("code",[t._v("ZooKeeper")]),t._v("以远程服务的方式，被客户端访问；客户端以轮询的方式获得"),n("code",[t._v("znode")]),t._v("数据，效率会比较低（代价比较大）")])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1478),alt:""}})]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("方式二")]),t._v("：基于通知的机制")]),t._v(" "),n("p",[t._v("客户端在"),n("code",[t._v("znode")]),t._v("上注册一个"),n("code",[t._v("Watcher")]),t._v("监视器，当"),n("code",[t._v("znode")]),t._v("上数据出现变化，"),n("code",[t._v("watcher")]),t._v("监测到此变化，通知客户端，然后客户端就可以获取最新数据。")])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1479),alt:""}})]),t._v(" "),n("p",[t._v("可以看到，通过第二种"),n("code",[t._v("watcher")]),t._v("的方式，明显比第一种方法效率高。")]),t._v(" "),n("h4",{attrs:{id:"什么是watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是watcher"}},[t._v("#")]),t._v(" 什么是Watcher?")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("客户端在服务器端，注册的事件监听器")]),t._v("；")]),t._v(" "),n("li",[n("code",[t._v("watcher")]),t._v("用于监听"),n("code",[t._v("znode")]),t._v("上的某些事件\n"),n("ul",[n("li",[t._v("比如"),n("code",[t._v("znode")]),t._v("数据修改、节点增删等；")]),t._v(" "),n("li",[t._v("当监听到事件后，"),n("code",[t._v("watcher")]),t._v("会触发通知客户端")])])])]),t._v(" "),n("h4",{attrs:{id:"如何设置watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何设置watcher"}},[t._v("#")]),t._v(" 如何设置Watcher")]),t._v(" "),n("blockquote",[n("p",[t._v("注意："),n("strong",[t._v("Watcher是一个单次触发的操作,被触发过一次后就时效了")])])]),t._v(" "),n("ul",[n("li",[t._v("可以设置"),n("code",[t._v("watcher")]),t._v("的命令如下：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stat")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看path节点状态（可设置watcher)")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看节点有哪些子节点（可设置watcher）")]),t._v("\nls2 path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看节点有哪些子节点、状态、相当于ls+stat(可设置watcher)")]),t._v("\nget path "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获得节点各种数据（可设置watcher）")]),t._v("\n")])])]),n("h5",{attrs:{id:"示例1-使用ls-path-watch-设置监听器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例1-使用ls-path-watch-设置监听器"}},[t._v("#")]),t._v(" 示例1：使用ls path [watch]设置监听器")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置监测子节点有没有变化的监听器：")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#node01 上执行")]),t._v("\ncreate /zk_test krystal "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#创建节点")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /zk_test "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#设置监听器")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#node02 上执行")]),t._v("\ncreate /zk_test/dir01 dir01-data\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#观察node-01上变化")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("zk: node-01:2181,node-02:2181,node-03:2181"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CONNECTED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("87")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \nWATCHER::\n\nWatchedEvent state:SyncConnected type:NodeChildrenChanged path:/zk_test\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#node02 上执行")]),t._v("\ncreate /zk_test/dir02 dir01-data\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#再观察node-01上变化，此时没有变化，因为监听器触发过后就失效了")]),t._v("\n")])])]),n("h5",{attrs:{id:"示例2-使用get-path-watch-设置监听器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例2-使用get-path-watch-设置监听器"}},[t._v("#")]),t._v(" "),n("strong",[t._v("示例2")]),t._v("：使用get path [watch]设置监听器")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#监控节点数据的变化的监听器；")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#node02上")]),t._v("\nget /zk_test "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#node03上")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" /zk_test "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"junk01"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#观察node2上cli的输出，检测到变化")]),t._v("\n")])])]),n("h5",{attrs:{id:"示例3-节点上下线监控"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例3-节点上下线监控"}},[t._v("#")]),t._v(" "),n("strong",[t._v("示例3")]),t._v("：节点上下线监控")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#在client1操作")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 创建临时节点")]),t._v("\n\ncreate -e /zk_tmp tmp-data\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 在client2操作")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 在/zk_tmp注册监听器")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /zk_tmp "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),t._v("\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#在client1操作")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 模拟节点下线")]),t._v("\nclose\n")])])]),n("p",[t._v("观察"),n("code",[t._v("client2")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("WATCHER::\n\nWatchedEvent state:SyncConnected type:NodeDeleted path:/zk_tmp\n")])])]),n("p",[n("strong",[t._v("上下线感知原理：")])]),t._v(" "),n("ol",[n("li",[t._v("节点"),n("code",[t._v("1")]),t._v("（"),n("code",[t._v("client1")]),t._v("）创建临时节点")]),t._v(" "),n("li",[t._v("节点2（"),n("code",[t._v("client2")]),t._v("）在临时节点，注册监听器"),n("code",[t._v("watcher")])]),t._v(" "),n("li",[t._v("当"),n("code",[t._v("client1")]),t._v("与zk集群断开连接，临时节点会被删除")]),t._v(" "),n("li",[n("code",[t._v("watcher")]),t._v("发送消息，通知"),n("code",[t._v("client2")]),t._v("，临时节点被删除的事件")]),t._v(" "),n("li",[t._v("注意： 节点1时某分布式集群的节点，而临时节点是说zookeeper服务器文件系统的一个目录")])]),t._v(" "),n("p",[n("strong",[t._v("用到的zk特性：Watcher+临时节点")]),t._v("。通过这种方式，"),n("strong",[t._v("检测和被检测系统不需要直接关联（如client1与client2）")]),t._v("，而是通过ZK上的某个节点进行关联，大大减少了系统"),n("strong",[t._v("耦合")]),t._v("。")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1480),alt:"image-20200218022634477"}})]),t._v(" "),n("h2",{attrs:{id:"zookeeper工作原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper工作原理"}},[t._v("#")]),t._v(" ZooKeeper工作原理")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("ZooKeeper")]),t._v("使用原子广播协议叫做"),n("code",[t._v("Zab(ZooKeeper Automic Broadcast)")]),t._v("协议")]),t._v(" "),n("li",[n("code",[t._v("Zab")]),t._v("协议有两种模式\n"),n("ul",[n("li",[n("strong",[t._v("恢复模式（选主）")]),t._v("：因为"),n("code",[t._v("ZooKeeper")]),t._v("也是主从架构；当"),n("code",[t._v("ZooKeeper")]),t._v("集群没有主的角色leader时，从众多服务器中选举"),n("code",[t._v("leader")]),t._v("时，处于此模式。")]),t._v(" "),n("li",[n("strong",[t._v("广播模式（同步）")]),t._v("：当集群有了"),n("code",[t._v("leader")]),t._v("后，客户端向"),n("code",[t._v("ZooKeeper")]),t._v("集群读写数据时，集群处于此模式。")])])]),t._v(" "),n("li",[t._v("为了保证事务的顺序一致性，"),n("code",[t._v("ZooKeeper")]),t._v("采用了递增的事务"),n("code",[t._v("id")]),t._v("号（"),n("code",[t._v("zxid")]),t._v("）来标识事务，所有提议（"),n("code",[t._v("proposal")]),t._v("）都有"),n("code",[t._v("zxid")])])]),t._v(" "),n("h2",{attrs:{id:"hdfs-ha方案原理-重点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hdfs-ha方案原理-重点"}},[t._v("#")]),t._v(" HDFS HA方案原理（重点）")]),t._v(" "),n("h4",{attrs:{id:"监听器的重要逻辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#监听器的重要逻辑"}},[t._v("#")]),t._v(" 监听器的重要逻辑")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("关于ZooKeeper监听器有三个重要的逻辑：")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("注册")]),t._v("：客户端向"),n("code",[t._v("ZooKeeper")]),t._v("集群注册监听器")]),t._v(" "),n("li",[n("strong",[t._v("监听事件")]),t._v("：监听器负责监听特定的事件")]),t._v(" "),n("li",[n("strong",[t._v("回调函数")]),t._v("：当监听器监听到事件的发生后，调用"),n("strong",[t._v("注册监听器时")]),t._v("定义的回调函数。")])])])]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("函数大致类型：")])]),t._v(" "),n("ul",[n("li",[t._v("主函数：相当于整个程序的引擎，调度各个函数按序执行")]),t._v(" "),n("li",[t._v("回调函数：一个独立的功能函数，如写文件函数")]),t._v(" "),n("li",[t._v("中间函数：一个介于主函数和回调函数之间的函数，登记回调函数，通知主函数，起到一个桥梁的作用")])]),t._v(" "),n("p",[n("strong",[t._v("回调函数")]),t._v("就是一个通过"),n("a",{attrs:{href:"https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/2674905",target:"_blank",rel:"noopener noreferrer"}},[t._v("函数指针"),n("OutboundLink")],1),t._v("调用的函数。如果你把函数的"),n("a",{attrs:{href:"https://baike.baidu.com/item/%E6%8C%87%E9%92%88/2878304",target:"_blank",rel:"noopener noreferrer"}},[t._v("指针"),n("OutboundLink")],1),t._v("（地址）作为"),n("a",{attrs:{href:"https://baike.baidu.com/item/%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92/9019335",target:"_blank",rel:"noopener noreferrer"}},[t._v("参数传递"),n("OutboundLink")],1),t._v("给另一个函数，当这个指针被用来调用其所指向的函数时，我们就说这是回调函数。回调函数不是由该函数的实现方直接调用，而是在特定的事件或条件发生时由另外的一方调用的，用于对该事件或条件进行响应。")])]),t._v(" "),n("h4",{attrs:{id:"监听器逻辑的类比举例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#监听器逻辑的类比举例"}},[t._v("#")]),t._v(" 监听器逻辑的类比举例")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("为了便于理解，举例：旅客住店无房可住的情况")]),t._v(" "),n("ul",[n("li",[t._v("一哥们去酒店办理入住，但是被告知目前无空房")]),t._v(" "),n("li",[t._v("这哥们告诉客服：你给我记住了，帮我留意一下有没有空出的房间，如果有，及时通知我（"),n("strong",[t._v("类似注册监听器，监听特定事件")]),t._v("）")]),t._v(" "),n("li",[t._v("将近12点，有房客退房，有空闲的房间（"),n("strong",[t._v("事件")]),t._v("）")]),t._v(" "),n("li",[t._v("客服发现有空房（"),n("strong",[t._v("监听到事件")]),t._v("）")]),t._v(" "),n("li",[t._v("及时通知这哥们")]),t._v(" "),n("li",[t._v("这哥们收到通知后，"),n("strong",[t._v("做一些事")]),t._v("，比如马上从附近酒吧赶回酒店（"),n("strong",[t._v("调用回调函数")]),t._v("）")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1481),alt:""}})])])]),t._v(" "),n("h4",{attrs:{id:"hdfs-ha原理-难点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hdfs-ha原理-难点"}},[t._v("#")]),t._v(" HDFS HA原理（难点）")]),t._v(" "),n("blockquote",[n("p",[t._v("关键逻辑：")]),t._v(" "),n("p",[t._v("①监听器："),n("strong",[t._v("注册、监听事件、回调函数")])]),t._v(" "),n("p",[t._v("②共享存储："),n("strong",[t._v("JournalNode")])])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("在"),n("code",[t._v("Hadoop 1.x")]),t._v("版本，"),n("code",[t._v("HDFS")]),t._v("集群的"),n("code",[t._v("NameNode")]),t._v("一直存在单点故障问题：")]),t._v(" "),n("ul",[n("li",[t._v("集群只存在一个"),n("code",[t._v("NameNode")]),t._v("节点，它维护了"),n("code",[t._v("HDFS")]),t._v("所有的元数据信息")]),t._v(" "),n("li",[t._v("当该节点所在服务器宕机或者服务不可用，整个"),n("code",[t._v("HDFS")]),t._v("集群处于不可用状态")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("Hadoop 2.x")]),t._v("版本提出了高可用 ("),n("code",[t._v("High Availability")]),t._v(", "),n("code",[t._v("HA")]),t._v(") 解决方案")])])]),t._v(" "),n("blockquote",[n("p",[t._v("HDFS HA方案，主要分两部分：")]),t._v(" "),n("p",[t._v("①元数据同步")]),t._v(" "),n("p",[t._v("②主备切换")])]),t._v(" "),n("h5",{attrs:{id:"元数据同步原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#元数据同步原理"}},[t._v("#")]),t._v(" 元数据同步原理")]),t._v(" "),n("ul",[n("li",[t._v("在同一个"),n("code",[t._v("HDFS")]),t._v("集群，运行两个互为主备的"),n("code",[t._v("NameNode")]),t._v("节点。")]),t._v(" "),n("li",[t._v("一台为主"),n("code",[t._v("Namenode")]),t._v("节点，处于"),n("code",[t._v("Active")]),t._v("状态，一台为备"),n("code",[t._v("NameNode")]),t._v("节点，处于"),n("code",[t._v("Standby")]),t._v("状态。")]),t._v(" "),n("li",[t._v("其中只有"),n("code",[t._v("Active NameNode")]),t._v("对外提供读写服务，"),n("code",[t._v("Standby NameNode")]),t._v("会根据"),n("code",[t._v("Active NameNode")]),t._v("的状态变化，在必要时"),n("strong",[t._v("切换")]),t._v("成"),n("code",[t._v("Active")]),t._v("状态。")]),t._v(" "),n("li",[n("strong",[t._v("JournalNode集群")]),t._v(" "),n("ul",[n("li",[t._v("在主备切换过程中，新的"),n("code",[t._v("Active NameNode")]),t._v("必须确保与原"),n("code",[t._v("Active NamNode")]),t._v("元数据同步完成，才能对外提供服务")]),t._v(" "),n("li",[t._v("所以用"),n("code",[t._v("JournalNode")]),t._v("集群作为共享存储系统；")]),t._v(" "),n("li",[t._v("当客户端对"),n("code",[t._v("HDFS")]),t._v("做操作，会在"),n("code",[t._v("Active NameNode中edits.log")]),t._v("文件中作日志记录，同时日志记录也会写入"),n("code",[t._v("JournalNode")]),t._v("集群；负责存储"),n("code",[t._v("HDFS")]),t._v("新产生的元数据")]),t._v(" "),n("li",[t._v("当有新数据写入"),n("code",[t._v("JournalNode")]),t._v("集群时，"),n("code",[t._v("Standby NameNode")]),t._v("能监听到此情况，将新数据同步过来")]),t._v(" "),n("li",[n("code",[t._v("Active NameNode")]),t._v("(写入)和"),n("code",[t._v("Standby NameNode(")]),t._v("读取)实现元数据同步")]),t._v(" "),n("li",[t._v("另外，所有"),n("code",[t._v("datanode")]),t._v("会向两个主备"),n("code",[t._v("namenode")]),t._v("做"),n("code",[t._v("block report")])])])])]),t._v(" "),n("p",[n("strong",[t._v("元数据同步示意图：")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1482),alt:""}})]),t._v(" "),n("h5",{attrs:{id:"主备切换原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#主备切换原理"}},[t._v("#")]),t._v(" 主备切换原理")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1483),alt:""}})]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("ZKFC涉及角色")])]),t._v(" "),n("ul",[n("li",[t._v("每个"),n("code",[t._v("NameNode")]),t._v("节点上各有一个"),n("code",[t._v("ZKFC")]),t._v("进程")]),t._v(" "),n("li",[n("code",[t._v("ZKFC")]),t._v("即"),n("code",[t._v("ZKFailoverController")]),t._v("，作为独立进程存在，负责控制"),n("code",[t._v("NameNode")]),t._v("的主备切换")]),t._v(" "),n("li",[n("code",[t._v("ZKFC")]),t._v("会监控"),n("code",[t._v("NameNode")]),t._v("的健康状况，当发现"),n("code",[t._v("Active NameNode")]),t._v("异常时，通过"),n("code",[t._v("Zookeeper")]),t._v("集群进行"),n("code",[t._v("namenode")]),t._v("主备选举，完成"),n("code",[t._v("Active")]),t._v("和"),n("code",[t._v("Standby")]),t._v("状态的切换\n"),n("ul",[n("li",[n("code",[t._v("ZKFC")]),t._v("在启动时，同时会初始化"),n("code",[t._v("HealthMonitor")]),t._v("和"),n("code",[t._v("ActiveStandbyElector")]),t._v("服务")]),t._v(" "),n("li",[n("code",[t._v("ZKFC")]),t._v("同时会向"),n("code",[t._v("HealthMonitor")]),t._v("和"),n("code",[t._v("ActiveStandbyElector")]),t._v("注册相应的回调方法（如上图的①回调、②回调）")]),t._v(" "),n("li",[n("strong",[t._v("HealthMonitor")]),t._v("定时调用"),n("code",[t._v("NameNode")]),t._v("的"),n("code",[t._v("HAServiceProtocol RPC")]),t._v("接口(monitorHealth和"),n("code",[t._v("getServiceStatus")]),t._v(")，监控"),n("code",[t._v("NameNode")]),t._v("的健康状态，并向"),n("code",[t._v("ZKFC")]),t._v("反馈")]),t._v(" "),n("li",[n("strong",[t._v("ActiveStandbyElector")]),t._v("接收"),n("code",[t._v("ZKFC")]),t._v("的选举请求，通过"),n("code",[t._v("Zookeeper")]),t._v("自动完成"),n("code",[t._v("namenode")]),t._v("主备选举")]),t._v(" "),n("li",[t._v("选举完成后回调"),n("code",[t._v("ZKFC")]),t._v("的主备切换方法对"),n("code",[t._v("NameNode")]),t._v("进行"),n("code",[t._v("Active")]),t._v("和"),n("code",[t._v("Standby")]),t._v("状态的切换")])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("主备选举过程：")])]),t._v(" "),n("ul",[n("li",[t._v("//---------------------------启动"),n("code",[t._v("hadoop")]),t._v("和"),n("code",[t._v("zookeeper")]),t._v("集群，进行选举-----------------------//")]),t._v(" "),n("li",[t._v("启动两个"),n("code",[t._v("NameNode")]),t._v("、"),n("code",[t._v("ZKFC")]),t._v("，此时不知道哪个是主"),n("code",[t._v("NameNode")]),t._v("、哪个备"),n("code",[t._v("NameNode")]),t._v("。")]),t._v(" "),n("li",[t._v("两个"),n("code",[t._v("ZKFC")]),t._v("通过各自"),n("code",[t._v("ActiveStandbyElector")]),t._v("发起"),n("code",[t._v("NameNode")]),t._v("的主备选举，这个过程利用"),n("code",[t._v("Zookeeper")]),t._v("的写一致性和临时节点机制实现")]),t._v(" "),n("li",[t._v("当发起一次"),n("strong",[t._v("主备")]),t._v("选举时，"),n("code",[t._v("ActiveStandbyElector")]),t._v("会尝试在"),n("code",[t._v("Zookeeper")]),t._v("创建临时节点"),n("code",[t._v("/hadoop-ha/${dfs.nameservices}/ActiveStandbyElectorLock")]),t._v("，"),n("code",[t._v("Zookeeper")]),t._v("的写一致性保证最终只会有一个"),n("code",[t._v("ActiveStandbyElector")]),t._v("创建成功")]),t._v(" "),n("li",[n("code",[t._v("ActiveStandbyElector")]),t._v("从"),n("code",[t._v("ZooKeeper")]),t._v("获得选举结果")]),t._v(" "),n("li",[t._v("创建成功的 "),n("code",[t._v("ActiveStandbyElector")]),t._v("回调"),n("code",[t._v("ZKFC")]),t._v("的回调方法②，把选举结果返回给"),n("code",[t._v("ZKFC")]),t._v("，"),n("code",[t._v("ZKFC")]),t._v("从而将对应的"),n("code",[t._v("NameNode")]),t._v("切换为"),n("code",[t._v("Active NameNode")]),t._v("状态")]),t._v(" "),n("li",[t._v("而创建失败的"),n("code",[t._v("ActiveStandbyElector")]),t._v("也会回调ZKFC的回调方法②，将对应的"),n("code",[t._v("NameNode")]),t._v("切换为"),n("code",[t._v("Standby NameNode")]),t._v("状态")]),t._v(" "),n("li",[t._v("不管是否选举成功，所有"),n("code",[t._v("ActiveStandbyElector")]),t._v("都会在"),n("code",[t._v("ActiveStandbyElectorLock")]),t._v("临时节点上注册一个"),n("code",[t._v("Watcher")]),t._v("监听器，来监听这个节点的状态变化事件")]),t._v(" "),n("li",[t._v("//-------------------------------------"),n("code",[t._v("namenode")]),t._v("出现异常，进行主备切换---------------------//")]),t._v(" "),n("li",[t._v("如果"),n("code",[t._v("Active NameNode")]),t._v("对应的"),n("code",[t._v("HealthMonitor")]),t._v("检测到"),n("code",[t._v("NameNode")]),t._v("状态异常时，调用回调函数1，通知对应的"),n("code",[t._v("ZKFC")]),t._v("。")]),t._v(" "),n("li",[n("code",[t._v("ZKFC")]),t._v("会调用 "),n("code",[t._v("ActiveStandbyElector")]),t._v(" 方法，删除在"),n("code",[t._v("Zookeeper上")]),t._v("创建的临时节点"),n("code",[t._v("ActiveStandbyElectorLock")]),t._v("（或者"),n("code",[t._v("ActvieStandbyElector")]),t._v("与"),n("code",[t._v("ZooKeeper")]),t._v("的"),n("code",[t._v("session")]),t._v("断开，临时节点也会被删除，但有可能此时原"),n("code",[t._v("Active NameNode")]),t._v("仍然是"),n("code",[t._v("active")]),t._v("状态，会出现下面说得脑裂问题）")]),t._v(" "),n("li",[t._v("此时，"),n("code",[t._v("Standby NameNode")]),t._v("的"),n("code",[t._v("ActiveStandbyElector")]),t._v("注册的"),n("code",[t._v("Watcher")]),t._v("就会监听到此节点的 "),n("code",[t._v("NodeDeleted")]),t._v("事件。")]),t._v(" "),n("li",[t._v("收到这个事件后，此"),n("code",[t._v("standby NameNode")]),t._v("对应的"),n("code",[t._v("ActiveStandbyElector")]),t._v("再次发起主备选举，成功创建临时节点"),n("code",[t._v("ActiveStandbyElectorLock")]),t._v("，如果创建成功，则"),n("code",[t._v("Standby NameNode")]),t._v("被选举为"),n("code",[t._v("Active NameNode")]),t._v("（过程同上）")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("如何防止脑裂")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("脑裂")]),t._v(" "),n("p",[t._v("在分布式系统中双主现象又称为脑裂，由于"),n("code",[t._v("Zookeeper")]),t._v("的“假死”、长时间的垃圾回收或其它原因都可能导致双"),n("code",[t._v("Active NameNode")]),t._v("现象，此时两个"),n("code",[t._v("NameNode")]),t._v("都可以对外提供服务，无法保证数据一致性")])]),t._v(" "),n("li",[n("p",[t._v("隔离")]),t._v(" "),n("p",[t._v("对于生产环境，这种情况的出现是毁灭性的，必须通过自带的**隔离（Fencing）**机制预防此类情况")])]),t._v(" "),n("li",[n("p",[t._v("原理")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("//-----------------------------正常断开"),n("code",[t._v("Session")]),t._v("------------------------------------//")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("ActiveStandbyElector")]),t._v("成功创建"),n("code",[t._v("ActiveStandbyElectorLock")]),t._v("临时节点后，会创建另一个"),n("code",[t._v("ActiveBreadCrumb")]),t._v("持久节点")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("ActiveBreadCrumb")]),t._v("持久节点保存了"),n("code",[t._v("Active NameNode")]),t._v("的地址信息。")])]),t._v(" "),n("li",[n("p",[t._v("当"),n("code",[t._v("Active NameNode")]),t._v("在正常的状态下断开"),n("code",[t._v("Zookeeper Session")]),t._v("，会一并删除临时节点"),n("code",[t._v("ActiveStandbyElectorLock")]),t._v("、持久节点"),n("code",[t._v("ActiveBreadCrumb")])])]),t._v(" "),n("li",[n("p",[t._v("//-----------------------------非正常断开"),n("code",[t._v("Session")]),t._v("------------------------------------//")])]),t._v(" "),n("li",[n("p",[t._v("但是如果"),n("code",[t._v("ActiveStandbyElector")]),t._v("在异常的状态下关闭"),n("code",[t._v("Zookeeper Session")]),t._v("，那么"),n("code",[t._v("ActiveStandbyElectorLock")]),t._v("临时节点会被删掉，持久节点"),n("code",[t._v("ActiveBreadCrumb")]),t._v("会保留下来，"),n("code",[t._v("NameNode")]),n("strong",[t._v("还处于active状态")]),t._v("。或者由于"),n("code",[t._v("active NameNode")]),t._v("与"),n("code",[t._v("ZooKeeper")]),t._v("通信不畅导致，也会导致这种情况出现。")])]),t._v(" "),n("li",[n("p",[t._v("此时"),n("code",[t._v("standby NameNode")]),t._v("监测到这种情况，成功创建临时节点，选举成功，当这个"),n("code",[t._v("NameNode")]),t._v("将由"),n("code",[t._v("standy")]),t._v("变成"),n("code",[t._v("active")]),t._v("状态之前，会发现上一个"),n("code",[t._v("Active NameNode")]),t._v("遗留下来的"),n("code",[t._v("ActiveBreadCrumb")]),t._v("节点，那么会回调"),n("code",[t._v("ZKFC")]),t._v("的方法对旧的"),n("code",[t._v("Active NameNode")]),t._v("进行"),n("code",[t._v("fencing")]),t._v("隔离")])]),t._v(" "),n("li",[n("p",[t._v("//-------------------------------------进行隔离=====================//")]),t._v(" "),n("p",[t._v("①首先"),n("code",[t._v("ZKFC")]),t._v("会尝试调用旧"),n("code",[t._v("Active NameNode")]),t._v("的"),n("code",[t._v("HAServiceProtocol RPC")]),t._v("接口的"),n("code",[t._v("transitionToStandby")]),t._v("方法，看能否将其状态切换为"),n("code",[t._v("Standby")]),t._v("。")]),t._v(" "),n("p",[t._v("②如果"),n("code",[t._v("transitionToStandby")]),t._v("方法切换状态失败，那么就需要执行"),n("code",[t._v("Hadoop")]),t._v("自带的隔离措施，"),n("code",[t._v("Hadoop")]),t._v("目前主要提供两种隔离措施：\n"),n("code",[t._v("sshfence：SSH to the Active NameNode and kill the process；")]),t._v(" "),n("code",[t._v("shellfence：run an arbitrary shell command to fence the Active NameNode")])]),t._v(" "),n("p",[t._v("//=====================--成功"),n("code",[t._v("fencing")]),t._v("后---------------------------------//")]),t._v(" "),n("p",[t._v("③只有成功地"),n("code",[t._v("fencing")]),t._v("之后，选主成功的"),n("code",[t._v("ActiveStandbyElector")]),t._v("才会回调"),n("code",[t._v("ZKFC")]),t._v("的"),n("code",[t._v("becomeActive")]),t._v("方法"),n("code",[t._v("transitionToActive")]),t._v("将对应的"),n("code",[t._v("NameNode")]),t._v("切换为"),n("code",[t._v("Active")]),t._v("，开始对外提供服务")])])])])])])]),t._v(" "),n("h2",{attrs:{id:"zookeeper之攘其外-重点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper之攘其外-重点"}},[t._v("#")]),t._v(" ZooKeeper之攘其外（重点）")]),t._v(" "),n("h4",{attrs:{id:"zookeeper工作原理回顾"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper工作原理回顾"}},[t._v("#")]),t._v(" Zookeeper工作原理回顾")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("ZooKeeper")]),t._v("使用原子广播协议"),n("code",[t._v("Zab(ZooKeeper Automic Broadcast)")]),t._v("，保证分布式一致性")]),t._v(" "),n("li",[t._v("协议"),n("code",[t._v("Zab")]),t._v("协议有两种模式，它们分别是")]),t._v(" "),n("li",[t._v("①"),n("strong",[t._v("恢复模式（选主）")]),t._v("：因为"),n("code",[t._v("ZooKeeper")]),t._v("也是主从架构；当"),n("code",[t._v("ZooKeeper")]),t._v("集群没有主的角色"),n("code",[t._v("leader")]),t._v("时，从众多服务器中选举"),n("code",[t._v("leader")]),t._v("时，处于此模式；主要处理内部矛盾，我们称之为"),n("strong",[t._v("安其内")])]),t._v(" "),n("li",[t._v("②"),n("strong",[t._v("广播模式（同步）")]),t._v("：当集群有了"),n("code",[t._v("leader")]),t._v("后，客户端向"),n("code",[t._v("ZooKeeper")]),t._v("集群读写数据时，集群处于此模式；主要处理外部矛盾，我们称之为"),n("strong",[t._v("攘其外")])]),t._v(" "),n("li",[t._v("事务")]),t._v(" "),n("li",[t._v("为了保证事务的顺序一致性，"),n("code",[t._v("ZooKeeper")]),t._v("采用了递增的事务"),n("code",[t._v("id")]),t._v("号（"),n("code",[t._v("zxid")]),t._v("）来标识事务，所有提议（"),n("code",[t._v("proposal")]),t._v("）都有"),n("code",[t._v("zxid")])]),t._v(" "),n("li",[t._v("每次事务的提交，必须符合"),n("code",[t._v("quorum")]),t._v("ˈkwɔːrəm多数派")])]),t._v(" "),n("h4",{attrs:{id:"zookeeper集群架构图"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper集群架构图"}},[t._v("#")]),t._v(" ZooKeeper集群架构图")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("ZooKeeper")]),t._v("集群也是主从架构\n"),n("ul",[n("li",[t._v("主角色："),n("code",[t._v("leader")])]),t._v(" "),n("li",[t._v("从角色："),n("code",[t._v("follower")]),t._v("或"),n("code",[t._v("observer")]),t._v("；统称为"),n("code",[t._v("learner")])])])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1484),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("客户端与ZK集群交互，主要分两大类操作，读与写。")])]),t._v(" "),n("h4",{attrs:{id:"读操作原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#读操作原理"}},[t._v("#")]),t._v(" 读操作原理")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1485),alt:""}})]),t._v(" "),n("ul",[n("li",[n("p",[t._v("常见的读取操作，如"),n("code",[t._v("ls /")]),t._v("查看目录；"),n("code",[t._v("get /zktest")]),t._v("查询"),n("code",[t._v("ZNode")]),t._v("数据")])]),t._v(" "),n("li",[n("p",[t._v("读操作")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("客户端先与某个"),n("code",[t._v("ZK")]),t._v("服务器建立"),n("code",[t._v("Session")])])]),t._v(" "),n("li",[n("p",[t._v("然后，直接从此"),n("code",[t._v("ZK")]),t._v("服务器读取数据，并返回客户端即可")])]),t._v(" "),n("li",[n("p",[t._v("关闭"),n("code",[t._v("Session")])])])])])]),t._v(" "),n("h4",{attrs:{id:"写操作原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写操作原理"}},[t._v("#")]),t._v(" 写操作原理")]),t._v(" "),n("ul",[n("li",[t._v("写操作比较复杂，先举个生活中的例子：去银行存钱\n"),n("ul",[n("li",[t._v("银行柜台共有5个桂圆姐姐，编程从①到⑤，其中①②④⑤是"),n("strong",[t._v("下属follower")]),t._v("，③是"),n("strong",[t._v("领导leader")])]),t._v(" "),n("li",[t._v("有两个客户")]),t._v(" "),n("li",[t._v("客户①找到桂圆①，说：昨天少给我存了1000万，现在需要给我加进去")]),t._v(" "),n("li",[t._v("桂圆①说，对不起先生，我没有这么大的权限，请你稍等一下，我向领导"),n("strong",[t._v("leader")]),t._v("③汇报一下")]),t._v(" "),n("li",[t._v("领导③收到消息后，为了做出英明的决策，要征询下属的意见("),n("strong",[t._v("proposal")]),t._v(")①②④⑤")]),t._v(" "),n("li",[t._v("只要有"),n("strong",[t._v("过半数quorum")]),t._v("（5/2+1=3，包括"),n("code",[t._v("leader")]),t._v("自己）同意，则"),n("code",[t._v("leader")]),t._v("做出决定("),n("strong",[t._v("commit")]),t._v(")，同意此事")]),t._v(" "),n("li",[n("code",[t._v("leader")]),t._v("告知所有下属"),n("code",[t._v("follower")]),t._v("，你们都记下此事生效")]),t._v(" "),n("li",[t._v("桂圆①答复客户①，说已经给您账号里加了1000万。")])])])]),t._v(" "),n("p",[n("strong",[t._v("示意图如下：")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1486),alt:""}})]),t._v(" "),n("ul",[n("li",[n("p",[t._v("客户端写操作")]),t._v(" "),n("ul",[n("li",[t._v("①客户端向"),n("code",[t._v("zk")]),t._v("集群写入数据，如"),n("code",[t._v("create /kkb")]),t._v("；与一个"),n("code",[t._v("follower")]),t._v("建立"),n("code",[t._v("Session")]),t._v("连接，从节点"),n("code",[t._v("follower01")])]),t._v(" "),n("li",[t._v("②"),n("code",[t._v("follower")]),t._v("将写请求转发给"),n("code",[t._v("leader")])]),t._v(" "),n("li",[t._v("③"),n("code",[t._v("leader")]),t._v("收到消息后，发出"),n("strong",[t._v("proposal提案")]),t._v("（创建"),n("code",[t._v("/kkb")]),t._v("），每个"),n("code",[t._v("follower")]),t._v("先"),n("strong",[t._v("记录下")]),t._v("要创建"),n("code",[t._v("/kkb")])]),t._v(" "),n("li",[t._v("④若超过"),n("strong",[t._v("半数quorum")]),t._v("（包括"),n("code",[t._v("leader")]),t._v("自己）同意提案，则"),n("code",[t._v("leader")]),t._v("提交"),n("strong",[t._v("commit提案")]),t._v("，"),n("code",[t._v("leader")]),t._v("本地创建"),n("code",[t._v("/kkb")]),t._v("节点"),n("code",[t._v("ZNode")])]),t._v(" "),n("li",[t._v("⑤"),n("code",[t._v("leader")]),t._v("通知所有"),n("code",[t._v("follower")]),t._v("，也就是"),n("code",[t._v("commit")]),t._v("提案；"),n("code",[t._v("follower")]),t._v("各自在本地创建"),n("code",[t._v("/kkb")])]),t._v(" "),n("li",[t._v("⑥"),n("code",[t._v("follower01")]),t._v("响应"),n("code",[t._v("client")])])]),t._v(" "),n("p",[t._v("注意：如果第一步直接就连接到了"),n("code",[t._v("leader")]),t._v("，则直接跳到第三步。")])])]),t._v(" "),n("p",[n("strong",[t._v("示意图如下：")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1487),alt:""}})]),t._v(" "),n("p",[n("img",{attrs:{src:s(1488),alt:"image-20200218065532250"}})]),t._v(" "),n("blockquote",[n("p",[t._v("补充：")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("zookeeper")]),t._v("集群有个特点，服务器的个数是奇数个：3、5、7...")]),t._v(" "),n("p",[t._v("如果存活的服务器超过半数，那么zookeeper集群就可以正常对外服务")])]),t._v(" "),n("li",[n("p",[t._v("假如有个"),n("code",[t._v("follower")]),t._v("因为网络不畅等问题，导致还没有写入某节点，如果这时候有客户端刚好连接上了这个"),n("code",[t._v("follower")]),t._v("，并访问该节点。那么此时就会调用"),n("code",[t._v("client.sync()")]),t._v("方法进行同步，客户端会等待"),n("code",[t._v("follower")]),t._v("与"),n("code",[t._v("leader")]),t._v("进行通信同步节点，同步完成后就可以提供服务了。")])])])]),t._v(" "),n("h2",{attrs:{id:"zookeeper之安其内-重点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper之安其内-重点"}},[t._v("#")]),t._v(" ZooKeeper之安其内（重点）")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("leader")]),t._v("很重要？")])]),t._v(" "),n("li",[n("p",[t._v("如果没有"),n("code",[t._v("leader")]),t._v("怎么办？")]),t._v(" "),n("ul",[n("li",[t._v("开始选举新的"),n("code",[t._v("leader")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("ZooKeeper服务器四种状态：")])]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("looking")]),t._v("：服务器处于寻找"),n("code",[t._v("Leader")]),t._v("群首的状态")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("leading")]),t._v("：服务器作为群首时的状态")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("following")]),t._v("：服务器作为"),n("code",[t._v("follower")]),t._v("跟随者时的状态")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("observing")]),t._v("：服务器作为观察者时的状态")])])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("leader")]),t._v("选举分"),n("strong",[t._v("两种情况")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("全新集群"),n("code",[t._v("leader")]),t._v("选举")])]),t._v(" "),n("li",[n("p",[t._v("非全新集群"),n("code",[t._v("leader")]),t._v("选举")])])])])]),t._v(" "),n("h4",{attrs:{id:"全新集群leader选举"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全新集群leader选举"}},[t._v("#")]),t._v(" 全新集群leader选举")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1489),alt:""}})]),t._v(" "),n("ul",[n("li",[n("p",[t._v("以3台机器组成的"),n("code",[t._v("ZooKeeper")]),t._v("集群为例")])]),t._v(" "),n("li",[n("p",[t._v("选举前提：集群中过"),n("strong",[t._v("半数")]),t._v("（多数派"),n("code",[t._v("quorum")]),t._v("）"),n("code",[t._v("Server")]),t._v("启动后，才能选举出"),n("code",[t._v("Leader")]),t._v("；")]),t._v(" "),n("ul",[n("li",[t._v("此处"),n("code",[t._v("quorum")]),t._v("数是多少？"),n("code",[t._v("3/2+1=2")])]),t._v(" "),n("li",[t._v("即"),n("code",[t._v("quorum")]),t._v("=集群服务器数除以2，再加1")])])]),t._v(" "),n("li",[n("p",[t._v("理解"),n("code",[t._v("leader")]),t._v("选举前，先了解几个概念")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("obeserver")]),t._v("不参与选举，但能够响应"),n("code",[t._v("client")]),t._v("的读写请求。")])]),t._v(" "),n("li",[n("p",[t._v("选举过程中，每个"),n("code",[t._v("server")]),t._v("需发出投票；投票信息"),n("strong",[t._v("vote信息")]),t._v("结构为"),n("code",[t._v("(sid, zxid)")]),t._v("，"),n("code",[t._v("sid")]),t._v("是"),n("code",[t._v("serverid")]),t._v(","),n("code",[t._v("zxid")]),t._v("是事务"),n("code",[t._v("id")]),t._v("。")]),t._v(" "),n("p",[t._v("全新集群，"),n("code",[t._v("server1~3")]),t._v("初始投票信息分别为：")]),t._v(" "),n("p",[t._v("​\tserver1 ->  "),n("strong",[t._v("(1, 0)")]),t._v("\n​\t​server2 ->  "),n("strong",[t._v("(2, 0)")]),t._v("\n​\tserver3 ->  "),n("strong",[t._v("(3, 0)")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("leader选举公式")]),t._v("：")]),t._v(" "),n("p",[t._v("​\tserver1 vote信息 "),n("code",[t._v("(sid1,zxid1)")])]),t._v(" "),n("p",[t._v("​\tserver2 vote信息 "),n("code",[t._v("(sid2,zxid2)")])]),t._v(" "),n("p",[t._v("​\t"),n("strong",[t._v("①zxid大的server胜出；")])]),t._v(" "),n("p",[t._v("​\t"),n("strong",[t._v("②若zxid相等，再根据判断sid判断，sid大的胜出")])])])])]),t._v(" "),n("li",[n("p",[t._v("选举"),n("code",[t._v("leader")]),t._v("流程：")]),t._v(" "),n("blockquote",[n("p",[t._v("假设按照ZK1、ZK2、ZK3的依次启动")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("启动"),n("code",[t._v("ZK1")]),t._v("后，投票给自己，"),n("code",[t._v("vote")]),t._v("信息"),n("code",[t._v("(1,0)")]),t._v("，没有过半数，选举不出"),n("code",[t._v("leader")])])]),t._v(" "),n("li",[n("p",[t._v("再启动"),n("code",[t._v("ZK2")]),t._v("；"),n("code",[t._v("ZK1")]),t._v("和"),n("code",[t._v("ZK2")]),t._v("票投给自己及其他服务器；"),n("code",[t._v("ZK1")]),t._v("的投票为"),n("code",[t._v("(1, 0)")]),t._v("，"),n("code",[t._v("ZK2")]),t._v("的投票为"),n("code",[t._v("(2, 0)")])])]),t._v(" "),n("li",[n("p",[t._v("处理投票。每个"),n("code",[t._v("server")]),t._v("将收到的多个投票做处理")]),t._v(" "),n("ul",[n("li",[t._v("如"),n("code",[t._v("ZK1")]),t._v("上："),n("code",[t._v("ZK1")]),t._v("投给自己的票"),n("code",[t._v("(1,0)")]),t._v("与"),n("code",[t._v("ZK2")]),t._v("传过来的票"),n("code",[t._v("(2,0)")]),t._v("比较；")]),t._v(" "),n("li",[t._v("利用"),n("strong",[t._v("leader选举公式")]),t._v("，因为"),n("code",[t._v("zxid")]),t._v("都为"),n("code",[t._v("0")]),t._v("，相等；所以判断"),n("code",[t._v("sid")]),t._v("最大值；2>1；"),n("code",[t._v("(2,0)")]),t._v("胜出；"),n("code",[t._v("ZK1")]),t._v("更新自己的投票为"),n("code",[t._v("(2, 0)")])]),t._v(" "),n("li",[n("code",[t._v("ZK2")]),t._v("也是如此逻辑，"),n("code",[t._v("ZK2")]),t._v("更新自己的投票为"),n("code",[t._v("(2,0)")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("再次发起投票")])]),t._v(" "),n("ul",[n("li",[n("code",[t._v("ZK1")]),t._v("、"),n("code",[t._v("ZK2")]),t._v("上的投票都是"),n("code",[t._v("(2,0)")])]),t._v(" "),n("li",[t._v("发起投票后，"),n("code",[t._v("ZK1")]),t._v("上有一个自己的票"),n("code",[t._v("(2,0")]),t._v(")和一票来自ZK2的票"),n("code",[t._v("(2,0)")]),t._v("，这两票都选"),n("code",[t._v("ZK2")]),t._v("为"),n("code",[t._v("leader")])]),t._v(" "),n("li",[n("code",[t._v("ZK2")]),t._v("上有一个自己的票"),n("code",[t._v("(2,0)")]),t._v("和一票来自"),n("code",[t._v("ZK1")]),t._v("的票"),n("code",[t._v("(2,0)")]),t._v("，这两票都选"),n("code",[t._v("ZK2")]),t._v("为"),n("code",[t._v("leader")])]),t._v(" "),n("li",[t._v("统计投票。"),n("code",[t._v("server")]),t._v("统计投票信息，是否有半数"),n("code",[t._v("server")]),t._v("投同一个服务器为"),n("code",[t._v("leader")]),t._v("；\n"),n("ul",[n("li",[n("code",[t._v("ZK2")]),t._v("当选2票；多数")])])]),t._v(" "),n("li",[t._v("改变服务器状态。确定"),n("code",[t._v("Leader")]),t._v("后，各服务器更新自己的状态\n"),n("ul",[n("li",[t._v("更改ZK2状态从"),n("code",[t._v("looking")]),t._v("到"),n("code",[t._v("leading")]),t._v("，为"),n("code",[t._v("Leader")])]),t._v(" "),n("li",[t._v("更改"),n("code",[t._v("ZK1")]),t._v("状态从"),n("code",[t._v("looking")]),t._v("到"),n("code",[t._v("following")]),t._v("，为"),n("code",[t._v("Follower")])])])])])]),t._v(" "),n("li",[n("p",[t._v("当"),n("code",[t._v("ZK3")]),t._v("启动时，发现已有"),n("code",[t._v("Leader")]),t._v("，不再选举，直接从"),n("code",[t._v("LOOKING")]),t._v("改为"),n("code",[t._v("FOLLOWING")])])])])])]),t._v(" "),n("h4",{attrs:{id:"非全新集群leader选举"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非全新集群leader选举"}},[t._v("#")]),t._v(" 非全新集群leader选举")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1490),alt:""}})]),t._v(" "),n("ul",[n("li",[n("code",[t._v("follwer")]),t._v("隔一定时间就会向"),n("code",[t._v("leader")]),t._v("发送心跳，如果l"),n("code",[t._v("eader")]),t._v("挂掉以后，"),n("code",[t._v("follower")]),t._v("的心跳就收不到响应了，超过一定时间后，所有"),n("code",[t._v("follower")]),t._v("就开始重新选举。")]),t._v(" "),n("li",[t._v("选举原理同上比较"),n("code",[t._v("zxid、sid")])]),t._v(" "),n("li",[t._v("不再赘述")])]),t._v(" "),n("h2",{attrs:{id:"zab算法-难点考点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zab算法-难点考点"}},[t._v("#")]),t._v(" ZAB算法（难点考点 ）")]),t._v(" "),n("h4",{attrs:{id:"仲裁quorum"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#仲裁quorum"}},[t._v("#")]),t._v(" 仲裁quorum")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("什么是仲裁"),n("code",[t._v("quorum")]),t._v("？")]),t._v(" "),n("ul",[n("li",[t._v("发起"),n("code",[t._v("proposal")]),t._v("时，只要多数派同意，即可生效")])])]),t._v(" "),n("li",[n("p",[t._v("为什么要仲裁？")]),t._v(" "),n("ul",[n("li",[t._v("多数据派不需要所有的服务器都响应，"),n("code",[t._v("proposal")]),t._v("就能生效")]),t._v(" "),n("li",[t._v("且能提高集群的响应速度")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("quorum")]),t._v("数如何选择？")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("集群节点数 / 2 + 1")])]),t._v(" "),n("li",[t._v("如3节点的集群："),n("code",[t._v("quorum")]),t._v("数="),n("code",[t._v("3/2+1=2")])])])])]),t._v(" "),n("h4",{attrs:{id:"网络分区、脑裂"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络分区、脑裂"}},[t._v("#")]),t._v(" 网络分区、脑裂")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("网络分区：网络通信故障，集群被分成了2部分")])]),t._v(" "),n("li",[n("p",[t._v("脑裂：")]),t._v(" "),n("ul",[n("li",[t._v("原"),n("code",[t._v("leader")]),t._v("处于一个分区；")]),t._v(" "),n("li",[t._v("另外一个分区选举出新的"),n("code",[t._v("leader")])]),t._v(" "),n("li",[t._v("集群出现"),n("code",[t._v("2")]),t._v("个"),n("code",[t._v("leader")])])])])]),t._v(" "),n("h4",{attrs:{id:"zab算法介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zab算法介绍"}},[t._v("#")]),t._v(" ZAB算法介绍")]),t._v(" "),n("p",[n("code",[t._v("ZAB")]),t._v("算法由"),n("code",[t._v("raft")]),t._v("算法发展而来，"),n("code",[t._v("PAXOS")]),t._v("算法 -> "),n("code",[t._v("RAFT")]),t._v("算法 -> "),n("code",[t._v("ZAB")]),t._v("算法，这三个算法都可以用来解决分布式领域一致性的问题。")]),t._v(" "),n("h4",{attrs:{id:"zab与raft的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zab与raft的区别"}},[t._v("#")]),t._v(" ZAB与RAFT的区别")]),t._v(" "),n("p",[t._v("ZAB与raft很相似，但是有以下区别：")]),t._v(" "),n("p",[t._v("1、"),n("code",[t._v("zab")]),t._v("心跳从"),n("code",[t._v("follower")]),t._v("到"),n("code",[t._v("leader")]),t._v("；"),n("code",[t._v("raft")]),t._v("从"),n("code",[t._v("leader")]),t._v("到"),n("code",[t._v("follower")])]),t._v(" "),n("p",[t._v("2、"),n("code",[t._v("zab")]),t._v("任期叫"),n("code",[t._v("epoch")]),t._v("ˈ；"),n("code",[t._v("raft")]),t._v("叫"),n("code",[t._v("term")]),t._v("。  "),n("code",[t._v("epoch")]),t._v("---\x3eˈiːpɒk")]),t._v(" "),n("h4",{attrs:{id:"epoch"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#epoch"}},[t._v("#")]),t._v(" epoch")]),t._v(" "),n("p",[t._v("一开始，"),n("code",[t._v("epoch")]),t._v("=1，第一任"),n("code",[t._v("leader")]),t._v("挂了之后，就会有第二任"),n("code",[t._v("leader")]),t._v("，此时"),n("code",[t._v("epoch")]),t._v("=2，这个就叫"),n("code",[t._v("epoch")]),t._v(",理解为纪元或者任期即可。")]),t._v(" "),n("p",[t._v("查看当前"),n("code",[t._v("epoch")]),t._v("的值：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("方式1：查看/kkb/install/zookeeper-3.4.5-cdh5.14.2/zkdatas/version-2/currentEpoch文件的内容")])]),t._v(" "),n("li",[n("p",[t._v("方式2：通过某个事务来查看。")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1491),alt:"image-20200218064209321"}})])])]),t._v(" "),n("h4",{attrs:{id:"raft算法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#raft算法"}},[t._v("#")]),t._v(" RAFT算法")]),t._v(" "),n("p",[n("a",{attrs:{href:"http://thesecretlivesofdata.com/raft/#replication",target:"_blank",rel:"noopener noreferrer"}},[t._v("raft算法动图地址"),n("OutboundLink")],1),t._v("，"),n("strong",[t._v("以"),n("code",[t._v("RAFT")]),t._v("算法动图为例，分析ZAB算法")])]),t._v(" "),n("h5",{attrs:{id:"动图帮助说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动图帮助说明"}},[t._v("#")]),t._v(" 动图帮助说明")]),t._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"zookeeper.assets/image-20200219174111921.png",alt:"image-20200219174111921"}}),t._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"zookeeper.assets/image-20200219174402918.png",alt:"image-20200219174402918"}}),t._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"zookeeper.assets/image-20200219174549695.png",alt:"image-20200219174549695"}}),t._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"zookeeper.assets/image-20200219174725526.png",alt:"image-20200219174725526"}}),t._v(" "),n("h5",{attrs:{id:"阶段一-leader-election"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#阶段一-leader-election"}},[t._v("#")]),t._v(" 阶段一：leader election")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("1. //=====================--------选举过程=====================-------//\n2. 在`RAFT`协议里有两个`timeout`，第一个`timeout`是`election timeout`，第二个是`heartbeat timeout`。\n3. `election timeout`是`followe`r等待变成`candidate`的时长（超过这个时长，`follower`就变成`candidate`）。\n4. `election timeout`是随机生成的，在150毫秒到300毫秒间，每个`follower`的`election timeout`都可能不同。\n5. 事先过了`election timeout`的服务器会从`follower`变成`cnadidate`状态，并且开启新的一轮选举。比如说视频中的`Node A`。\n6. `Node A` 会给自己投票。然后发送投票请求给其它的服务器（`Node B`、`Node C`)。\n7. 如果收到投票请求的服务器还没有投过票，就会为该`candidate Node A`投票。（如果为其它`candidate`投过票了，就不会为该`NodeA` `candidate`投票了。）\n8. 投票后的每个服务器都会重置自己的`election timeout`。\n9. 一旦一个`candidate`得到了超过半数的投票，就会变成`leader`。\n10. `leader`开始发送`Append Entries`信息给每个`follower`。\n11. 这些`Append Entries`信息每隔`heartbeat timeout `时间就会发送一次。每个`follower`都会对这些信息进行响应，且会重置`heartbeat timeout`。\n12. //=====================第一任`leader`挂了，重新选举=====================-//\n13. `leader`的任期会一直持续下去，直到某一个`follower`超过`heartbeat timeout`时长依然没有接收到来自`leader`的心跳信息，该`follower`就会变成`candidate`。\n14. 比如视频中的`NodeA`停掉了，`Node C`获得过半的投票数后变成了新一任`leader`。过半数投票产生`leader`的机制可以保证每次任期都只有一个`leader`。\n15. //=====================-同一时间有两个`candidate`的情况=====================//、\n16. 假如有四个服务器`Node ABCD`，两个`candidate`，即 `NodeB NodeC`同一时间竞选同一个任期的`leader`。两个`candidate`都会为自己投票，并向所有的`follower`发送投票请求。\n17. 然后`NodeA`首先收到`NodeB candidate`的投票请求，而`NodeD`首先收到的是`NodeC candidate`的投票请求，那么这样的话，`candidateB`和`candidateC`都是拥有两票。票数相同，都没有过半，导致新一轮的`leader`的选举即将开始。\n18. 新一轮选举，率先到达`electin timeout`的的`follower`（视频中的`NodeA NodeC`）同时变成了`candidate`。\n19. 如此循环，直到只产生了一个`leader`。\n")])])]),n("h5",{attrs:{id:"阶段二-log-replication-复制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#阶段二-log-replication-复制"}},[t._v("#")]),t._v(" 阶段二：Log Replication（复制）")]),t._v(" "),n("ol",[n("li",[t._v("如果集群有一个"),n("code",[t._v("leader")]),t._v("后，那么以后集群内所有的改变，都要复制到集群的所有其它节点（服务器）。")]),t._v(" "),n("li",[t._v("这个要通过集群的心跳，使用"),n("code",[t._v("Append Entries")]),t._v("信息来完成。")]),t._v(" "),n("li",[t._v("//--------------------------------将某节点数据设置为5=====================------//")]),t._v(" "),n("li",[t._v("一个客户端向"),n("code",[t._v("leader")]),t._v("发送了一个更改的请求。比如说"),n("code",[t._v("set...5")]),t._v("，设置某个节点的值为5。")]),t._v(" "),n("li",[t._v("这个更改会被记录到"),n("code",[t._v("leader")]),t._v("的"),n("code",[t._v("log")]),t._v("日志文件里。")]),t._v(" "),n("li",[t._v("这些更改会通过"),n("code",[t._v("leader")]),t._v("下一轮的心跳发送给所有的"),n("code",[t._v("follower")]),t._v("。"),n("code",[t._v("followers")]),t._v("收到心跳后，返回心跳给"),n("code",[t._v("leader")]),t._v("进行响应，告知"),n("code",[t._v("leader")]),t._v("已经把要进行的更改记录下来了。")]),t._v(" "),n("li",[t._v("一旦超过半数的"),n("code",[t._v("follower")]),t._v("告知了"),n("code",[t._v("leader")]),t._v("，"),n("code",[t._v("leader")]),t._v("的对应节点的值就改成了"),n("code",[t._v("5")]),t._v("，那么一个"),n("code",[t._v("entry")]),t._v("会被提交 ?，同时会向"),n("code",[t._v("client")]),t._v("客户端响应：更改完成。")]),t._v(" "),n("li",[n("code",[t._v("follower")]),t._v("再一次收到"),n("code",[t._v("leader")]),t._v("心跳时，将节点值改为5，提交"),n("code",[t._v("log entry")]),t._v("。")]),t._v(" "),n("li",[t._v("如果要将该节点的数据加"),n("code",[t._v("2")]),t._v("，步骤跟上述一样，最终集群的该节点的值都变为了"),n("code",[t._v("7")]),t._v("。")]),t._v(" "),n("li",[t._v("//----------------------------------脑裂现象=====================-------------------------//")]),t._v(" "),n("li",[t._v("假设集群有5个服务器。假如因为网络问题，"),n("code",[t._v("AB")]),t._v("服务器与"),n("code",[t._v("CDE")]),t._v("服务器之间不能通信了，集群分成了两部分。一开始"),n("code",[t._v("Node B")]),t._v("是"),n("code",[t._v("leader")]),t._v("。")]),t._v(" "),n("li",[t._v("由于通信问题，"),n("code",[t._v("C")]),t._v("服务器超过"),n("code",[t._v("heartbeat timeout")]),t._v("时长没有收到l"),n("code",[t._v("eader")]),t._v("的心跳。C会变成"),n("code",[t._v("candidate")]),t._v("，经过"),n("code",[t._v("DE")]),t._v("投票过后，"),n("code",[t._v("Node C")]),t._v("也变成了"),n("code",[t._v("leader")]),t._v("。此时集群有两个"),n("code",[t._v("leader")]),t._v("，B和C。")]),t._v(" "),n("li",[t._v("一个客户端向"),n("code",[t._v("NodeB leader")]),t._v("发送更改某节点值为"),n("code",[t._v("3")]),t._v("的请求。"),n("code",[t._v("leader")]),t._v("通过心跳告知向所有"),n("code",[t._v("follower")]),t._v("发起更改提议，因为没有收到超过集群半数的"),n("code",[t._v("follower")]),t._v("的响应。导致"),n("code",[t._v("leader NodeB")]),t._v("的"),n("code",[t._v("log entry")]),t._v("始终是"),n("code",[t._v("uncommited")]),t._v("的状态。")]),t._v(" "),n("li",[t._v("另一个客户端向"),n("code",[t._v("NodeC leader")]),t._v("发送请求，更改刚才同一个节点的值为"),n("code",[t._v("8")]),t._v("的请求，"),n("code",[t._v("leader NodeC")]),t._v("通过心跳告知所有"),n("code",[t._v("follower")]),t._v("，超过半数响应，更改成功。"),n("code",[t._v("log entry")]),t._v("为"),n("code",[t._v("committed")]),t._v("状态，"),n("code",[t._v("leader")]),t._v(" 响应客户端。")]),t._v(" "),n("li",[t._v("//-------------------------------------网络修复好后=====================---------------//")]),t._v(" "),n("li",[n("code",[t._v("leader NodeB")]),t._v("看到更高任期的"),n("code",[t._v("leader")]),t._v("，进行让步，退让"),n("code",[t._v("leader")]),t._v("，变为"),n("code",[t._v("follower")]),t._v("。")]),t._v(" "),n("li",[n("code",[t._v("NodeB NodeA")]),t._v("将会回滚网络恢复前留下来的"),n("code",[t._v("uncommited entry")]),t._v("。然后匹配"),n("code",[t._v("leader")]),t._v("新的"),n("code",[t._v("log")]),t._v("。")]),t._v(" "),n("li",[t._v("最后，我们的集群再次实现了一致性。")])]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("补充：")])]),t._v(" "),n("p",[t._v("当"),n("code",[t._v("leader")]),t._v("收到一条"),n("code",[t._v("command")]),t._v("请求后，就把它加入自己的"),n("code",[t._v("log")]),t._v("中作为新的"),n("code",[t._v("entry")]),t._v("，然后给其他服务器发出"),n("code",[t._v("AppendEntries PRC")]),t._v("进行日志复制。一旦"),n("code",[t._v("entry")]),t._v("被"),n("strong",[t._v("安全的复制")]),t._v("了，"),n("code",[t._v("leader")]),t._v("就可以把这条"),n("code",[t._v("entry")]),t._v("给"),n("code",[t._v("apply")]),t._v("到状态机了，并给客户端返回结果。如果"),n("code",[t._v("follower")]),t._v("响应慢或者宕机了，"),n("code",[t._v("leader")]),t._v("会一直发送"),n("code",[t._v("RPC")]),t._v("直到所有"),n("code",[t._v("follower")]),t._v("都存储了"),n("code",[t._v("entry")]),t._v("。")])]),t._v(" "),n("h2",{attrs:{id:"zookeeper服务器个数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper服务器个数"}},[t._v("#")]),t._v(" ZooKeeper服务器个数")]),t._v(" "),n("ul",[n("li",[t._v("仲裁模式下，服务器个数最好为奇数个。"),n("strong",[t._v("why?")])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1492),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("5节点的比6节点的集群\n"),n("ul",[n("li",[t._v("成本更低，但是容灾能力一样")]),t._v(" "),n("li",[n("code",[t._v("quorum")]),t._v("小，响应快")])])])]),t._v(" "),n("h4",{attrs:{id:"_12-2-zookeeper状态同步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12-2-zookeeper状态同步"}},[t._v("#")]),t._v(" 12.2 ZooKeeper状态同步")]),t._v(" "),n("p",[t._v("完成"),n("code",[t._v("leader")]),t._v("选举后，"),n("code",[t._v("zk")]),t._v("就进入"),n("code",[t._v("ZooKeeper")]),t._v("之间状态同步过程")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("leader")]),t._v("构建"),n("strong",[t._v("NEWLEADER")]),t._v("封包，包含"),n("code",[t._v("leader")]),t._v("中最大的"),n("code",[t._v("zxid")]),t._v("值；广播给其它"),n("code",[t._v("follower")])]),t._v(" "),n("li",[n("code",[t._v("follower")]),t._v("收到后，如果自己的最大"),n("code",[t._v("zxid")]),t._v("小于leader的，则需要与"),n("code",[t._v("leader")]),t._v("状态同步；否则不需要")]),t._v(" "),n("li",[n("code",[t._v("leader")]),t._v("给需要同步的每个"),n("code",[t._v("follower")]),t._v("创建"),n("strong",[t._v("LearnerHandler")]),t._v("线程，负责数据同步请求")]),t._v(" "),n("li",[n("code",[t._v("leader")]),t._v("主线程等待"),n("code",[t._v("LearnHandler")]),t._v("线程处理结果")]),t._v(" "),n("li",[t._v("只有多数"),n("code",[t._v("follower")]),t._v("完成同步，"),n("code",[t._v("leader")]),t._v("才开始对外服务，响应写请求")]),t._v(" "),n("li",[n("code",[t._v("LearnerHandler")]),t._v("线程处理逻辑\n"),n("ol",[n("li",[n("code",[t._v("LearnerHandler")]),t._v("接收"),n("code",[t._v("follower")]),t._v("发送过来的封包"),n("strong",[t._v("FOLLOWERINFO")]),t._v("，包含此"),n("code",[t._v("follower")]),t._v("最大"),n("code",[t._v("zxid")]),t._v("（代称"),n("code",[t._v("f-max-zxid")]),t._v("）")]),t._v(" "),n("li",[t._v("将"),n("code",[t._v("f-max-zxid")]),t._v("与"),n("code",[t._v("leader")]),t._v("最大"),n("code",[t._v("zxid")]),t._v("（代称"),n("code",[t._v("l-max-zxid")]),t._v("）进行比较")]),t._v(" "),n("li",[t._v("若相等，说明当前"),n("code",[t._v("follower")]),t._v("是最新的")]),t._v(" "),n("li",[t._v("另外，若在判断期间，看有没有新提交的"),n("code",[t._v("proposal")]),t._v(" "),n("ol",[n("li",[t._v("如果有，那么会发送"),n("strong",[t._v("DIFF")]),t._v("封包将有差异的数据同步过去。同时将"),n("code",[t._v("follower")]),t._v("没有的数据逐个发送"),n("strong",[t._v("COMMIT")]),t._v("封包给"),n("code",[t._v("follower")]),t._v("要求记录下来.")]),t._v(" "),n("li",[t._v("如果"),n("code",[t._v("follower")]),t._v("数据"),n("code",[t._v("id")]),t._v("更大,那么会发送"),n("code",[t._v("TRUNC")]),t._v("封包告知截除（删除）多余数据.")]),t._v(" "),n("li",[t._v("如果这一阶段内没有提交的提议值,直接发送"),n("code",[t._v("SNAP")]),t._v("封包将快照同步发送给"),n("code",[t._v("follower")]),t._v(".")])])]),t._v(" "),n("li",[t._v("以上消息完毕之后,"),n("code",[t._v("leader")]),t._v("发送"),n("strong",[t._v("UPTODATE")]),t._v("封包告知"),n("code",[t._v("follower")]),t._v("当前数据就是最新的了")]),t._v(" "),n("li",[n("code",[t._v("leader")]),t._v("再次发送"),n("strong",[t._v("NEWLEADER")]),t._v("封包宣称自己是"),n("code",[t._v("leader")]),t._v(",等待"),n("code",[t._v("follower")]),t._v("的响应，循环上述过程。")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1493),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"分布式锁"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#分布式锁"}},[t._v("#")]),t._v(" 分布式锁")]),t._v(" "),n("h5",{attrs:{id:"原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),n("p",[t._v("之前我们学习过编程当中的锁的概念。怎么用"),n("code",[t._v("Zookeeper")]),t._v("实现分布式锁？")]),t._v(" "),n("p",[t._v("看下图，有很三个"),n("code",[t._v("client")]),t._v("客户端，都要访问"),n("code",[t._v("data")]),t._v("，但是同一个时间只能允许一个客户端访问。")]),t._v(" "),n("ol",[n("li",[t._v("三个"),n("code",[t._v("client")]),t._v("都争抢访问"),n("code",[t._v("data")]),t._v("数据，三个客户端都发送"),n("code",[t._v("creat -s -e /locker/node_data")]),t._v("命令，尝试在"),n("code",[t._v("locker")]),t._v("节点下创建一个临时有序子节点。")]),t._v(" "),n("li",[t._v("三个客户端都创建好节点之后，那么每个客户端都会对自己创建的节点进行判断，判断自己节点的的后缀编号是不是最小的，"),n("strong",[t._v("节点最小编号对应的客户端将获得先访问"),n("code",[t._v("data")]),t._v("的权限。加锁")]),t._v("。")]),t._v(" "),n("li",[t._v("另外两个客户端就会对比自己对应节点编号小的节点进行监听，比如"),n("code",[t._v("client2")]),t._v("监听"),n("code",[t._v("node_1,``clent3")]),t._v("监听"),n("code",[t._v("node_2")]),t._v("。")]),t._v(" "),n("li",[t._v("当"),n("code",[t._v("client1")]),t._v("访问完数据后，会把流关闭掉，客户端关闭会话"),n("code",[t._v("session")]),t._v("，然后"),n("code",[t._v("node_1")]),t._v("节点就会被删除掉。")]),t._v(" "),n("li",[t._v("此时"),n("code",[t._v("client2")]),t._v("监听到"),n("code",[t._v("node_1")]),t._v("被删除了，重新判断自己创建的临时节点"),n("code",[t._v("node_2")]),t._v("是否是列表中最小编号的。")]),t._v(" "),n("li",[t._v("判断为是后，"),n("code",[t._v("client2")]),t._v("获得访问"),n("code",[t._v("data")]),t._v("权限，开始访问。")]),t._v(" "),n("li",[t._v("如此循环即可，保证同一时间点只有一个客户端在访问"),n("code",[t._v("data")]),t._v("。")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1494),alt:"image-20200219154004216"}})]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("create -s -e /locker/node_ ndata\n")])])]),n("h5",{attrs:{id:"代码实现-todo-未消化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码实现-todo-未消化"}},[t._v("#")]),t._v(" 代码实现（TODO，未消化）")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jimmy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("day05")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log4j"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BasicConfigurator")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log4j"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zookeeper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zookeeper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Stat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DistributedLock")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义会话的超时时间")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" SESSION_TIME "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" threadId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZooKeeper")]),t._v(" zk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" waitPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" LOG_PREFIX_OF_THREAD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" SESSION_TIMEOUT "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" GROUP_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/disLocks"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" SUB_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/disLocks/sub"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" CONNECTION_STRING "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node01:2181,node02:2181,node03:2181"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" THREAD_NUM "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//确保连接zk成功；")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),t._v(" connectedSemaphore "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//确保所有线程运行结束；semaphore信号")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),t._v(" threadSemaphore "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("THREAD_NUM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" LOG "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DistributedLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//构造方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DistributedLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("threadId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"【第"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" threadId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"个线程】"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//程序入口")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//多个线程中zk是否是同一个对象？")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BasicConfigurator")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("configure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" THREAD_NUM"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" threadId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DistributedLock")]),t._v(" dc "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DistributedLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("threadId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//连接zookeeper集群")]),t._v("\n                        dc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createConnection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CONNECTION_STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SESSION_TIMEOUT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3、在createConnection中，线程等待结束，向下执行"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//GROUP_PATH不存在的话，由一个线程创建即可；")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("threadSemaphore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                            dc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GROUP_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"该节点由线程"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" threadId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"创建"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获得锁")]),t._v("\n                        dc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"【第"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" threadId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"个线程】 抛出的异常："')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            threadSemaphore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"所有线程运行结束!"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 获取锁\n     *\n     * @return\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeeperException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建临时有序节点")]),t._v("\n        selfPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SUB_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZooDefs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Ids")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OPEN_ACL_UNSAFE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CreateMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EPHEMERAL_SEQUENTIAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"创建锁路径:"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkMinPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//判断当前线程，创建的临时节点，时候是编号最小的；如果是，表示此线程可获得锁")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLockSuccess")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 创建节点\n     *\n     * @param path 节点path\n     * @param data 初始数据内容\n     * @return\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" needWatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeeperException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("exists")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" needWatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"节点创建成功, Path: "')]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZooDefs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Ids")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OPEN_ACL_UNSAFE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CreateMode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PERSISTENT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('", content: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 创建ZK连接\n     *\n     * @param connectString  ZK服务器地址列表\n     * @param sessionTimeout Session超时时间\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createConnection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" connectString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" sessionTimeout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IOException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        zk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZooKeeper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("connectString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sessionTimeout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1、创建连接，并等待"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//CountDownLatch")]),t._v("\n        connectedSemaphore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2、创建连接后，等待结束；理应执行3、"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 获取锁成功\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLockSuccess")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeeperException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("exists")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"本节点已不在了..."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"获取锁成功，赶紧干活！"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"删除本节点："')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除本节点")]),t._v("\n        zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//释放zk连接")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("releaseConnection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//threadSemaphore数字递减；达到零后，让等待的线程继续执行")]),t._v("\n        threadSemaphore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 关闭ZK连接\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("releaseConnection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zk "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"释放连接"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 检查自己创建的临时节点是不是最小的节点\n     *\n     * @return\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkMinPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeeperException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获得所有子节点的路径")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" subNodes "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getChildren")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GROUP_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//对子节点列表做排序")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("subNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获得当前线程创建的临时节点，在子节点列表中排第几？")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" index "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" subNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("substring")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GROUP_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("length")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"本节点已不在了..."')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当前线程创建的临时节点是最小的节点")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"子节点中，我果然是老大"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" selfPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获得锁")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//找到比自己编号小，紧邻的临时节点")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("waitPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GROUP_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" subNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"获取子节点中，排在我前面的"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" waitPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注册监听器")]),t._v("\n                    zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Stat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//没有获得锁")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeeperException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("exists")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"子节点中，排在我前面的"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" waitPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"已失踪，幸福来得太突然?"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//回调自己")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkMinPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//回调函数")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WatchedEvent")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("KeeperState")]),t._v(" keeperState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventType")]),t._v(" eventType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Event.KeeperState.SyncConnected =>> The client is in the connected state 客户端处于连接状态")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("KeeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SyncConnected")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" keeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventType"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("None")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" eventType"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//客户端连接上zkServer后，执行此分支")]),t._v("\n                LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"成功连接上ZK服务器"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//connectedSemaphore数字递减；达到零后，让等待的线程继续执行")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4、createConnection后，客户端成功连接zkServer"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                connectedSemaphore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5、CountDownLatch: connectedSemaphore 递减为0；理应执行 -> 2、创建连接后，等待结束"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventType"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NodeDeleted")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("waitPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"收到情报，排我前面的家伙已挂，我是不是可以出山了？"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkMinPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLockSuccess")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeeperException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("KeeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Disconnected")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" keeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"与ZK服务器断开连接"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("KeeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AuthFailed")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" keeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"权限检查失败"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("KeeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Expired")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" keeperState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            LOG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LOG_PREFIX_OF_THREAD "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"会话失效"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"zookeeper应用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper应用场景"}},[t._v("#")]),t._v(" ZooKeeper应用场景")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("NameNode")]),t._v("使用"),n("code",[t._v("ZooKeeper")]),t._v("实现高可用.")]),t._v(" "),n("li",[n("code",[t._v("Yarn ResourceManager")]),t._v("使用"),n("code",[t._v("ZooKeeper")]),t._v("实现高可用.")]),t._v(" "),n("li",[t._v("利用"),n("code",[t._v("ZooKeeper")]),t._v("对"),n("code",[t._v("HBase")]),t._v("集群做高可用配置")]),t._v(" "),n("li",[n("code",[t._v("kafka")]),t._v("使用"),n("code",[t._v("ZooKeeper")]),t._v(" "),n("ul",[n("li",[t._v("保存消息消费信息比如"),n("code",[t._v("offset")]),t._v(".")]),t._v(" "),n("li",[t._v("用于检测崩溃")]),t._v(" "),n("li",[t._v("主题"),n("code",[t._v("topic")]),t._v("发现")]),t._v(" "),n("li",[t._v("保持主题的生产和消费状态")])])])]),t._v(" "),n("p",[n("strong",[t._v("ZooKeeper应用场景图：")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(1495),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"扩展阅读"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#扩展阅读"}},[t._v("#")]),t._v(" 扩展阅读")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/hadoop-dev/p/5946870.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("follower与leader状态同步"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/u010670689/article/details/78054945",target:"_blank",rel:"noopener noreferrer"}},[t._v("主备切换示例"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"访问控制acl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#访问控制acl"}},[t._v("#")]),t._v(" 访问控制ACL")]),t._v(" "),n("ul",[n("li",[t._v("参考《访问控制ACL》")])]),t._v(" "),n("h2",{attrs:{id:"题库-本堂课知识点-todo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#题库-本堂课知识点-todo"}},[t._v("#")]),t._v(" 题库 - 本堂课知识点（TODO）")]),t._v(" "),n("ol",[n("li",[t._v("假设五台ZooKeeper服务器组成的全新集群，分别为zk1,zk2,zk3,zk4,zk5，sid分别为1、2、3、4、5，依次启动zk1,zk2,zk3,zk4,zk5。问哪台是leader，为什么这台是leader?")]),t._v(" "),n("li",[t._v("同一个客户端同时发起多次请求操作时ZooKeeper内部是如何操作的？多个客户端同时发起多个请求时又是如何操作的？")]),t._v(" "),n("li",[t._v("自己编写代码，完成zookeeper原生API下的增加节点、删除节点、修改节点等操作；其中一个自定义的方法要用到监听器")]),t._v(" "),n("li",[t._v("使用curator API完成增加节点、删除节点、修改节点等操作；其中一个自定义的方法要用到监听器")])]),t._v(" "),n("h2",{attrs:{id:"zookeeper总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper总结"}},[t._v("#")]),t._v(" Zookeeper总结")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1496),alt:""}})]),t._v(" "),n("p",[n("img",{attrs:{src:s(1497),alt:""}})])])}),[],!1,null,null,null);a.default=e.exports},345:function(t,a,s){t.exports=s.p+"assets/img/zkservice.3119bdf6.jpg"}}]);