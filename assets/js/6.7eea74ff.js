(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1880:function(t,s,a){t.exports=a.p+"assets/img/image-20200425030104111.87f13306.png"},1881:function(t,s,a){t.exports=a.p+"assets/img/clip_image004.96c982c4.png"},1882:function(t,s,a){t.exports=a.p+"assets/img/clip_image006.001263f6.jpg"},1883:function(t,s,a){t.exports=a.p+"assets/img/clip_image008.b7407eb8.jpg"},1884:function(t,s,a){t.exports=a.p+"assets/img/clip_image010.9915ee70.jpg"},1885:function(t,s,a){t.exports=a.p+"assets/img/clip_image012.1c15a5a0.jpg"},1886:function(t,s){t.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAdwB3AAD/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCACMASYDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD1iiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKie4jTvuOcYXk1FfSMPLjVipZuoqiQ2+YDduL5SXccKPpSubwpXV2XxfxFgpSVcjOWTAqyCCARyDWVvnBwCCGLY2rg5zxnI6VPazTbibhjjhVVUwM45/Wi450tLovUUUUznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAD0P0rk9Pubu81CSGS+nACsVCvjOPftXWVzesR6VpUH2mSxaQNIFO124z1Oa5MTTnNxcXsduGnCMZKS3FukvLaSMNfThWcKSJg3Hv6VBdXFxCkzR39w/zhY/mOeefxqrFqGkT2l1NHpplNsodlSdjkE4745q5F/Y8115IsiEEIm3mVhgHpx/9euaVCq72/N/5HTGrTVr/kv8wmlult2Zb6cOFBI3k4Pce/4e9Qw3k5ji82+uQzt/fxn2H1pttd6RcXqW/wDZxQMBiQ3IwMk/7VMa+0dTc79JkH2ZWLEyN1UgY5x6joaToVb3X5sarUrWf5L/ADL9g08yB7m+uI1afyx+8wQMHt9cVHK90l2FXULlo1AZwX5PONoPrV6PStOkiST7Jjcob/WN3H1p39j6b/z6/wDkRv8AGn7Kpa36v/IXtIXb/Rf5mJeXmoW5Xbe3G1s9Xzj2qt/auo/8/s3/AH1XSf2Npv8Az6D/AL+N/jR/Y2mf8+g/77b/ABrGWGrt3UvxZvDEUUrON/kjM0HULyfVo45rqWRCrZVmyOldXWdZ6bY29wJYbcI4Bw24mtGvQwtOcIWk7nm4ucJ1LwVgooorqOQKKQkKMkgD1NVZdQjXIiUysOw4oKjCUtiG+tGaZ7lpdkYUcAZziqKRvKxjEn3yGy3AIAOScdKsSXN1MmCmQSDt3DikQyFzJNEZH24GXGak7oc0Y2dvwJrS3eCcSSXCY2YbD9T6fSkmuJSZo1kbKnIOccUxThgYrN2Y9SJckY4qSZGV/IhiJDR42/3frzTI+1eX6Fy1k8y2RicnGCfepqyPtMtrCY4IWU+Z9wqSQO+afZX91LciOYAKep24xxQZSoyd5LY1KKKKZzhXM6jrOoRa41lBKqRmRVH7sEjNdNWHqelWZupr+SW4R1G4+WR2Hbit6Lim+YxrKTS5SO7udXtLeSZrxHVSQMQjscetN+3aiI8/2hGz+Qsu1IQRz7+lVIzpk5mjF/qPEe+UE8bcZ549qZANJnW38u8v1WZdikkAKB0BrZOFtfyMXGpf/gkH/CT6r/z2j/79ij/hJ9V/57R/9+xWmfDVgefNuT/wJf8ACj/hGtP/AOetz+a/4VtzUP5fwMeSv3/Eot4k1QW8biVNzMQf3YrUiuNXkt0kF3GWccbY1I3Yzj8qY3h2w8hVMlxhST1H+FViukRIM6zdIsZ2geZjacZxjHHBFZzdJ/CrfI0jGqt3+JS/4SfVf+eyf9+xR/wk+q/89o/+/YrT/wCEb09vm865O7nO5ef0o/4RrT/+etz+a/4VpzUP5fwM+Sv3/EzP+En1b/ntH/37Fa/h3V7zUbuWO5dWVUyMKBzmo/8AhGtP/wCetz/30v8AhV/SNJttPmkkgeVmZcHeRioqyouD5Vr6GlONZTXM9PU1aKKK887gHUVnaummx26/2m6+Q0gwGGRu7cVojqKoaxaWep2ot7mYxJ5gO4YB+gJ6ZqZWNIX6GVbJ4WtILmaBYoY0VfPHllRjJAJB685rQjOnfamhjkId4gTID8uwdMNngVQ0/QdKs4LlYtTnuIZ1CSeZPvAwTznJx1rSt7TT4LlyHjaQxLFs2qGCr9Oe/NToXeRUhm0WYxfZ2B3sdkkY5yDg5OcnkUSyaGLiWGXe0jZR/wBy7ZB6nOORx1HpTrPSdKtZU8i55XdhUcA8kHAx0xjGBTbnTrGS6MraisRY8IAoGfz9j+tGgXkasdunlJ5bHZtG3jtT/s4/vH8qVJIkRVVhgDjApfOj/vUrId5Dfs4/vH8qPs4/vH8qd50f96jzo/736UrILyBIQh3bs8U6hZEbIB5xRWkdjKd76hVea7CZCox2/ebHC0+5haeBo0fY38LYzg1li2voYC106M2/B8rOCvbimzSlCMtW/kTSkSjfK5cZAZFBxiljikkV/LRo0bjG4cU21dYLjdK5GV754HvWkjrIu5GDD1BoNJycNEjKZQlwsWdzBcEEgf0poiO1wsmHzkkjJHbHAqzfBo7mKREdyx6AgDIFQG5leGY7C0sROF3nn9KRpFtxTQ8QTLEYlZo3DH51H+eKZLJPHAgkuXRsnc2eKjW4kE5V4VMZI3DqTn8easTqsrASRrCkXzEEZP6UD1TXMKs+9I8zDcpKs7N1yKp39tBeaWY3mxmQHMbDt0qRY1RGTFv/AH1zJnB/PpTSmIFTMS4bnbIKCoLlleLtqaWmwfZtOhh3s4VeC/XFWqRBtRVHQDFLVHnzk5SbYVVvbaOZJPO2mIrlw2cY75q1VfULeO9sprV2A81Cv3sYPY8VUXqQzJOj6TvmAkhVp4cMBKRhAMZHpwajt9E0eKQTRzxSMjICC4YZ/hGMceoqwuh+VfLcpJbqghaIxeXjdkDJJ69qgg8MRwRxKt0D5U8cq7mLE7c9ST3zV3ZNkbP2Z/7y0fZm/vLU+9f7y/nRvX+8v507sVkQtbOYwA4B9R2rIfwxaT/6NLK8rrmRt5BY7uMnjnpweo7Vulk2D5lP41ipoMa3RuC0JUybzFzz6fNnt6Yx9aV2OyNFLMxoqKwwowMkk/nTvszf3lqcFQAAwx25o3L/AHh+dO7FZEH2Zv7y1JDE0ZYkg8dqfvX+8v50oZTnDA/Q1LbsNJBRRRWZYDrWFr2mSarZiCGQRuJQ24k4A78Dqa3R1FZniHUZtKsVuIIEkPmqp3e/bHfNRJXNIO1zAs/DN+tveW9/dQTrcxqoYKfkwSe9alvpctvctcibMi26xRZOfmA6njp0/KqFj4pub+yvnt0iaW3RWQSRFdxJPHHXgVrQahdz3jItquxbZZdu0Ehm6DIOe3pmpszTnRl2+i39u9vIrWgeKQyMQDgk45H5v+Yqtd+EJLtWBudmeMbicgsSR14GDx71dtte1UrbtLZW7mQ4deUIG/aSv6cH0+tSXXiFkkuGhe28mGQDLRtnbznPvhW/SizDmiasSeVEkec7FCg/Sn1aQxyRrIgBVwGUkdj0pdq/3R+VTylc5Uoq3tX+6Pyo2r/dH5Ucoc5Xh/1n4GrFKFUZwoHHpSVpBWRjUd2FFFFWZiOiupV1DA9QRVWSxjzvSR4tvPDcVbqlqFyqIYRyzDkc9PY0jWm5XtEgcyzQ+R5xmLHIdAPlwaYJZYmYuCjsOAUAGM9vekjijMGCd0mM/K4B+lTvDHJ+8WF5HQBceYORSOq8Voxks9wIT+824cocDBPv9Pypd1xM8ucsOAmFHAzSukMLu00UqIy/M+7PX2FQxSw2zbLZCY5OAQT830PY/X86BJK2iC9ubSxjEskpjklPCuOPcZH8qfCzPNCvylmG4huwqWK0jeR5HVsZDNHMQ/I6H2NS2iAyySjo3uf60EucVG3Ut0UUVRxhVDUVZo5ljyWZSBjrzV+mXDqkTM0hjAH3guSPwwaqLsxM5DQtMvtOvpZ54XbKsqDzCcjgjOWIB460yz03VotQhkma4eJVO8+acsS3Qjd0ArobG8kkllEl3I5WVlijaLaJFxwSdtU7O91lru2E2GS6iMjhYSRCQ2MA8cfWruTY0aKv0U+YVin/AAL6ZrnbfTbqK682RZTi5ZziNWDKWOBktxxjtXX/AMI9a4+XV/EUSSDyfmil3NhS2V34Cj5PTvRzDsZGsaJr8utXs1jFIbe4xjMwIGAOgJzzzWpqVjqtzAiwLKuIYwEEm0bgec4b0/lUusahr8OsTLa3aJBGwGz7MzDbjJ5Cnmupt3MlvE7HJZAScY7UrhYytOjkitAs3meZuOTI2Sf1NaNr95vpVilHQ0N6AlqJRRRWRYDrWbq2rDTrfznijkJcAKzbfx/CtIdaz9Vjsobbzb5j5QcAf7x6d/1qJXNYW1uUdP8AEsV9BNMkNtG0TBFAlDbxjIwQM/hiprLW3utzfZUiByRluWxx6ADp3NRWEGj3djcJamR4IyIpVBZuwOOCfapNNh0ieSZrF2ZpU2SMVcAqM8ZPHc1Opd4lWz8XWt5f/YorQq4yVZioXj3z78etWG16Dz5Y47RXWKTY7bQvTGSM9eWH1yabb2GhSNGkJ4KkLy20AHpnOOopZG0N55d0vmSGYpIFVmIcYJ4HQcLRqF4iar4qh0kqr27yZjLAKNvI6Lz/AJFMl8WxrYW94lsWSeAzAFsYA7fWpNQ/sWXUFjvJGN1BGXUBX4BGT046CmhvD9naqftKCEo0YHzMAueV745Io1C6JrbxEs+mNfNDsVZfK25zznHX8alstZN2/lGEJKE3kBw4AzjqDTdPi06/ts2u8xCQS/OjLluoPPXpWh9n/wBv9KNR+6LHMzttIGMVJTEh2Nu3Z49KfVRvYyqWvoFFFFWZjZH8uNn9BmsdJJHSa7wHZMYBXPP0rarJZvId1mJUn5iBJjjmkzpoNWatqQ2pb7aDJCoLEknZjHH1qS2knibakeBtLuEHPWpEijnm8xU3SEc4lzgVD+5SU26seWxyT19KR0Nqd0LMVSSRXQbZTuWSZDkH2PpT4XmWBlDLBxkyDkt+H9aJ52gdA8O/ayoCWJyO/bpTpPLR4fLTaJiwZN3HA/CgndLQQiG1VhsPmuPvngc1b0+N44W345ORht1UUtTcXMzr96PHBbg5FXrK1aBdznDEfdB4FMiq1yWvqWqKKKZxhVLUr2Wyt55kUOYkLBSQM8epq7Va+SBIXlnUugGSu3dk9sD1q47ksxbfxW891BAbaRVkVsyHbtVlx3zjHOPrVZPGMsktvEsESySLucsxIUc4wQOTx0zWir6ReXSq1rI0jnBLw8fU8Y/OoftmgXc6Rtas0ko+UPCoyM49fWquhWNYXEuByPypftEnqPyFSi2jAAywAo+zJ6tTuhWZGZ5Ng5H5VVbU511M2flOw8oSb1TOMkjB/Krxtk2Yy2K577d4d3MVtZ3Ktsdki3bOcfMQeBmi6CzEv/F0ljOY1gEgBcNhsY2jpnBGfb0xWxbX7XNrFcLwsqBwCOmRmq1w+imdLS48tml3MQ6ggFcdfetGOCFo1MbEoR8uMYxRdBZjPtEnqPyqWCV3LBiMY9KPsyerU+OJY8kE/jSbVhq9x1FFFZFgOoqnqNrb6jGI5XACnIygbn8auDrVKZbkN+5iVuudxI+lRJs1ppPcpW2h29vZyW3nR/OoHmLDhgR3qxZaZa2crt5vmoygCN04XkkkfXNKRf8Aa3i/77P+FThJMDKkHviouzXliVbbSbW2KYnLbJRIBtwMDOFx/wACPP0qCbw9YyyzSLO8ZmdnbaM/McYP1GOPrWlsf+6fyo2P/dP5UczDkiZl14b067vIruSaQyoMEt8wfjHORUk2iW0sKx+fnYhRGdMkA9ckYOfer+x/7p/KjY/90/lRzMOSJDptnBp3m7JAfNIJCqQAQMZ5J61e86P+9+lV9j/3T+VGx/7p/Ki7DliWVkRsgNzj0oqGJWD5KkDFTVcNjGokmFFFFWZhVDVlxAJMkY4YgDpV+kYAqcgH60FwlyyTMWwvWW8CM5CH5fmOfwHpRErSXsbrJnLEgben61aKpHBG6KF+8TgdTVewO+/HDjjPJ4qTuuvekkUV0yWKZmub2eQ7jx5mFH9TWhEznakOyQgZBcYX8M85qW6kiEz/ALgKwOS+Rz+dRqpd2upWQcYVSRn2OaByqSnG8y9Zj5GbcGJbnC4qxUVsmy3QZB4zkVLVHnzd5MKKKKCQqG6lthG63GDGFy+4cY96mrP1bT31C2lt1wA+MEjIGCD0qo7kso2n/CN2t1NDaSW6XcrFjsC+Ypx2+napIm0fCWyXLlgynbzk7TlR7DNZ9t4Tnt71JRNiFZWkaNMrnI/xweuKs22hX0V2s0kyMCcylRhnwDt57Y+tXoLU3ftEfv8AlR9oj/2vyqDyJP7ho8iT+4adkLUsGePaOuD7Vgrp3h6OaWNCyPPJkqSfv5yMZ447DtWx5Um1fk6GsoaLdIcqInYTGVJJGclTnPTOOM4osh3ZPfXukxXa3F3qslvJGSijzQoUkDIx9MVopdwyIro5dSMhhzmuauPCM0krSwypG7GTBC4I3fnnnnpmtqzsZbWzht8FjGgDNn7x7n8TzRoGpd+0R/7X5U6OVZMhc/iKreRJ/cNS28bIW3Ljik7WBXuTUUUVkWFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABTZCRGxHYU6kYZBHrQNbmb9oUpGuDhT/e+9UlhHGs7ssjEkdGfdWZqbXaQosczKySjcVGMrnGOlX9NYNdP8pBK98VPU75wtS5k9x2phU27LXzXbk4XNVV+aFHaJsMCCvXaB7YrWuozLbsqkhuoxWe376NOo3/AH/lJBIpsilO8UjQtwBAgz29c1LWVZuseouN/wArfKF2nj8a1aEc9WHLIKKKKZkFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAZt8scV1HkqPNYcHufak05ibqRSpG0EDOPX2q3eWkN3GolXJjYOh7hh0qrBPHFcqPKCtIPmKoep980up1xlzU7Lc0qo3MUhBt0Yqr8rg/mKvVl6/Yi9slw7I8bgqygn6jAoZlQtzpN2QtojLMqlnJVj16Ae1adZdliC43MuPMH3tuPzrUoQ6/xBRRRTMAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigCG6kMVs7qhcgfdBxmspY3YK+cEcjvWzJGJUKMSAe4ODWTfRC3jLIzFgMZJzSZ14d6WNWKVZYwysG7HHY+lMuZvJiJXbuPTJotY1jtkVR2yT6n1qnqEEYnE2Ms64OTkDHoKDKEE6lhtwFnaKCNoyccjP8q1AMACsLTp2lv/ACSFUKMgqOeK3aEXXXLaIUUUUzmCiiigAooooAKKKKACiiigAooooAKKKKACiiigD//Z"},1887:function(t,s,a){t.exports=a.p+"assets/img/clip_image016.349b09c7.jpg"},1888:function(t,s,a){t.exports=a.p+"assets/img/image-20200425031735191.d19720cb.png"},1889:function(t,s){t.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAB5AHkDASIAAhEBAxEB/8QAHAAAAQUBAQEAAAAAAAAAAAAABgADBAUHCAIB/8QAQhAAAQMDAgQCBgcGBQMFAAAAAQIDBAAFEQYhBxIxQRNRFCJhcYGxCDI0VHKRkhUjQlJicxYkM0ShF8HwQ1Oy4eL/xAAbAQACAgMBAAAAAAAAAAAAAAAABQQGAQMHAv/EADERAAEDAgQFAgQGAwAAAAAAAAEAAgMEEQUSITETIkFRYTJxgZGhsQYUI0JS0RWi4f/aAAwDAQACEQMRAD8A6/iRo5iskx2iShO5QPIeynvRI33Zn9ApQ/sjH4E/IU9QhM+iRvuzP6BS9Ejfdmf0Cns18KgOtCE16JG+7M/oFL0SN92Z/QKdKkgZzVder/ZbLHMi73SHBbAzzPuhHzrIBcbBYc4NF3GymeixfuzP6BXwxYw/2zH6BWc3Pjjw5iLLbd2fmqHaJFWsfngA/nVeOP8AonOFRr4kfzGD/wDqpQoKki+Q/JQ3YjSg24g+a1YRY33Zn9Ar76JG+7M/oFANo40cObg4GxfxFcO3LLZW1v7yMf8ANHVuuMC4xhJgTGJTJ6LZcC0/mK0yQSxetpC3RVMUvocD8V7MWKD9nZ/QK+CNFP8At2f0CnFKSSUk1k9241WeycRJ+mrxBcjw47iWhOaWHE8xSkkrSBkAc2CRnGN6IYJJiRGL2WJ6mOnAMhtdat6LG+7M/oFL0SN92Z/QK8Qp0OZCamRJDT8d1AW262rmSpJ6EEVJzWqxG63ggi4TBixhuI7Oc/yChXla/ka/SKMTQVQsovh/ZGPwJ+Qp49KZh/ZGPwJ+Qp49KEL4SAKq9SX21aftjt0u8xuJEZGVOLPfyA6knsB1pjWepLZpXT0m83Z4NsMjYDdTiuyUjuTXP5avPEW9t3/U6VIhD1rdat+RpvspQ7k9z3921TaSjM3M42altdiAprNYLuPT+1c6g4m6v1gtcbR8f9h2kkg3CQjL7o80Don4An2ihqPoiE5I9Mujkq8TCcqelrKznvgZrRYtrbbQkFIISMADoB5U8/GU2gcjWQPLam7JWRDLCLD6quyxyzuzTOv9h7IOasaGEBMeC0ykdAlsDFNv214Jx4YxRJIWv+RI99QH3FA7o/KtzZXnUqO+Jg0QncLMy8kpkQmnEnY5QDVJHtcqyS/TtN3OZZpQOcsOHkJ8inuPYc0eLeST1wfI1FmRWXuqADjqOtbxKdnDRaeFreM2K8xuLnEJNsXbpTFhRK5eUXR97wkI/rKOhPsGPdWX6nctnM1GgyFXGQCtyfcFg/5t5RyeXO/IkbDOCSScDajG5wS2kgpKkHY0D6ktyY7a5DWUsZ/eBPVAJ3IqTSQwxvzsFvAUWtqKiVojeboy4I8TXNH3dFnuUpTtgkuhJSs5MRxX8af6T3HtyMHOetEKCgkhWQe4od0tZNMf4Vt7FqgQHLYWULZw0lQVkAhR23UeufOiUJ9vQ1U8QqI55S5jcqvGF0stNCGPfmHRejQVRqaCqgpoi+H9kY/An5CnXDhBPlTEXPojP9tPyFBHHbUb+nuHc1cNR9PnKTCiBP1udw4yPaBk1sijMrwwdVpnlbFG57tgFlurrseJHEB1YPPpqxOFthv+GU/3X7Rt+WPOjqyQ9sYGT9bHnWYWq4Q9L6IdixkKRcoLYDkSSgod8dZx6yDuQT5Z2ArQPQNZ6YTbpy5L+qPHITNgMRUIWySnILawRsDgHm7U9qXxwMa0OAGw8+VVabNNI+RzSSd/HYIyYtoKQMfkK8SreUDoPfiqBGqtarRiHoiPHHZc26oB9/KgZqDc9VaztzC7leYGnnLezhUhmE674yW8jKwpWxx1x3FJDXwMeGOlaCdtQnZgcWZhG6w3Nvqpt3iAArCQOU70PTG9zV9rPUdiskYOXK4tM+M2Fto+staSNiEjf5Cs0lcSLEsktRZ7jecc/IkD509pmSPF7aKvVkkMbst9VbS28kgde1N+IprCXRlOMZqmkaqhXKCtqyelP3N9KkxmkxypXPjb2f8ANGcXQVue4XsX20MXBGom4/pDokuLDj60/wCo0tKjgA4IG22xrfNK2nDTLpdRqaN1QXGLWwv/AMVC8gODlxk+yhm9wko5kqSChQOR2ok4cWmLrPUF0RMnzmrfBZa8FEZ0slS15yVHGdsHaqi9pcNyf07AdVcJouLkKKXCOcoSR+8cx05QTv3xXqOsibK6MO1aLnwF6lpnvhEhbubDyUTfRw1c5ar0vQtxfJivgvWxaj9UjdTXx3I9oPnXRAIz8a5G1vpC96WlW+dAmt3GXHCpjS47RQtotDmWSN/U9vw711Fo+8sah01br3HUnw5sdD2B/CSNx8DkfCkuIcCcNqqc3a/e3dWHB3zRh1LOLOb9lcmgqjU0FUtTxFsT7Iz/AG0/IVhn0kbs6jWukLcwYhMVS7iUSl8jS1pICUqPbPKr863SJ9jZ/tp+QrnnjdIZb42xnZsB2dGYs2VoSz4vIkqVlZT3AzvUmlkMTnSBpcWtJsNzYbBLsUaXwiPNlzOAv21U9y/W/iDdLcmdYnI061SEypbywlQQkZKW0OD6wWrBwegFStXau1Q1clRLFYETGgkFUh9fKgqO5wM9KDXGY9vsk+9aPnRWmnGi443jnaJSMZT3Srfoas7tKvDunYkqyIQ9JeDaiFgK9UjJVucda5ziGMSS1UbomtERcWBshIyusCc/jXTWyd0lII4JGveeIBmJjAOYbAN310TT114mzQf3tohDyRgkfmTVNK1NdP8ACc+BeT6ZdFylwUspSMrKgD0TjOxGPgKstMt6xFxLt8fZMTwlAtJKc83bYD396d0LZ2bjx+SHwlxmOgz+XqOYIABx58xB/Kp2D8LEa99HUiIiMCQOiB3BBy5lCrmTUtMyog4gMhLCJD0I3yqXoSwaXs+r2LdxDbmSdRSm21sLnpzFJUPVbSo/WWOhJ2zsKMoHFjQCLlcrXOjxLYxCeLLDimkqRICSUlSQlOwBHeo3GCfqFd0Nhm2aKi3TXW2rReUMF9UR5R5SpaRuk7kAjGM96zbRbdzat0qBEk6DipgynGFKusdHjuqSo+tlRyr2Z8q6k2NtU3iynWw0vp8P6VRdM6ifwIgN9yN/fv7oz1Bb+E/EGcmFpm4x7fqJwKVFejsqbS4tIJwoYAPTORgjGRULSnEHVNukO6Svljl3S7QCpJU0+kOqQkd+cjnONwruCKq9D3M3jW+gLq9BgRZDj0xh0w4yWUOcmQkkDvv8quPpGwn7XrvT19tQQibMaWwebYKUkgAnz2Xj4VDr6YSxGncL8pIzHYi/Ua20XumqHNP5yM5bEB2UbtNuh66q2c194OTJ0tf4ilDJPoiVfnyHeqhOsNJNXBU8Qlwpis8zzluW24c9cqx/3oe/amvWMl2xRZGPreE5j5KqfYr3eptwES5afehIKFEvFRKQR0G/xrkdY5zY3zZWloGuSYXt7EXPsr7TyB0jYgXAnbPEfuDZTZS9N6veVJac9Kfba8HxGH3EKQlX8OMjr3ox+i9NW5oCRanFZXark9GA8kk84+ZoFt7d5N/u6bFpaTckrdaSp2OpCUJd8PormOw3Boo+jLFlWuZrC1THUuPxrkhLqkbp8TlPNj/ztVp/C9PVtppXPceAQxzA4gnUa6DbU+ErxCeF1XGGtAku8OIBANtt/AW2GgqjU0FU8W1F0U/5Nn+2n5Csn1aRb/pIaWluDDVwtj8Qk9CocxHv6j861iLj0Nkn/wBtPyFZX9JKHKjWK06wgIBlafuCJGSMgIV6pJ9meXNS6HWbJ/IEfNQMRH6Wf+JB+Szu5WWzX7WerJJYTHhImejNojEtt+on1lkDYnPem7fPkM8NWJ0RaUvsMAJWpvnHqucpJHu3+FXDEH9h8IU3GW423KuYK+cnYOSVd/whWT7qb4XQbVcdOXLS0mWy67HfeZWlLgSXWVHZaM9R191UjGKCsrxLUzXdEyVtmnXlAIcfjopmG1MNM6OKPle+N1yDbmJBA+V1c6p0DrC2Wlm6W2+yb640+hb0KPFQ14jOcq5epKum2e9UOmrm7ZOMFlvVxtN0tMOchUB5c+KpgFah6vXruE70TzrE6w14d24jXoMoAHIq4tMBIx/SAaFNQQeGhhyGXdQOT5ikENuJluzH0K7FIyR7xtT6i/x0dQ2WCB2axbyMsLO7gWvbfZL6oVfDs6RoFw6zng6t7dRdaFxgvFxd1PpfR9ilvsTZc1EqSphRCkMNnO+Oxwr2bUCcNbbw7nTNSp1g3axMbuzwZE17w1BrmOw9YA4OaXDrXNssN3bm63tL7dxcjpjs3oIUpS2U7JDickpVjbmA6dfOjeeeB93kuXaa7pt55487ji3OUrPckZG/wq1lslMzglrgO4Gt90nDmVbuOHtvf0u2AtZZ0IFr0nrrTb+ndURNSr/aakRre0QUR0OEhRyknf1v+M9quuOkw6j4mWewW2UErtTSnnXgkK8JxWD8SAlO3tpnUWu+H2mku/8ATrTsF66lJQmcmOfDYz3yd1fDb5UFWoaQfZXJvN5cfuchZcffU442eYnOAds1Cxqpkp6XimN5cQWizcx16kbWHk6oo44nyfl2vaG3BOuUadATcm6PLZHuLEJaJ05EyRklDha8MDboQOu+aqw5rRnGY9lkjG+HVtn5V6tkuwNWs2+FfW+RXMA4qVzOAq9qvKmGrVcAkeh6zluDGAHPDdrg1PCWTyuqGtFz++JwH+vp9l1KeUuijbAXGw/bI36l26J+HGsBpJuYjU1pktLuExTxlRSl5srKQEt8qfWT6qNidsg5xVx9G1wXCLqrUKQrkuV9dW2T3QAMfOsp1rFv0CyquFwvTEpmKf3aPRuRRWoFIIwd1etsOnWt84I2JWnuGtmgOo5X1M+kP/3HDzkfAEV2TBats+EiTM0knLy3DeXUCzgDtboqNNFK3EuEQQ1ozcxF7nToSjg0FUamgqtqZIuifY2f7afkKj3+2RbxZZlrmoC48tlTLiSOyhj/AO6kw/sjH4E/IU6v6tZBsbhYc0EWK5HVIvdlvA0bqGc64nT7ihb21JASUqB5XM9Veqds9AcDoaVxNunOByXHQ44kYCwSlXuyCDitj49cPV6qtqL3ZW0i+29J8MDb0hvqWz7epHt271zazPfUVsvJU082SlxCxhSVA4IIPTfb4Grjh8kdTFmboeo89/iuf4rBLSTWdq3ofHb4IhLNoaWVi3xlHrzLRzHPxqSzc2Gk8jaENpHQJSBQyXnD/EcV4OVHPMc1O4ISoTkahFLt1SpKkqIUk7lJ3B9/nVa6bWVFRgx8k5J8MVUcxHUmvmT516bGG7FeTNfcK8bubTSORpKG0jslIFNuXIOHlUA5nbcZqrQw65jCDjzqUgMRhnPMusGNqy1xU4/s/wAIl6HHWe5U2Nqqnxb1OfuoaWgO6CU/I15kPqcHZKfKmoMWfd7pHs1ojqlT5KuRptPzPkAM5PbGayWtAJk26rOZznBkY1RPwm0w5rPXcaD++VaYBTJn8zqlIPKfVRuepP8Axnyrr1CAnp08vKhHhXomJojS7VuZUl2W6Q7MkD/1XD/2HQeyjADB696pVfOyaX9MANHYWXQsJonU0A4hu47r0aCqNTQVUJNEXw/sjH4E/IU8elMw/sjH4E/IU8aELyUgpx2rJ+MPCOLql1y9WJbUC+4yvmGGpWOy8dFYGOYfHNazvS3zW6CeSB2eM2Kj1NLFUsLJBcLhm7Q7nYrmu132A9AmNnAQ6Nle1JGyh7RXgKBAIPWu0dT6asupYJhXu2xpzB6JdRkpPmD1B9oxWQak+jzGUpb2mL8/CzuI8tPio9wUNwPzqzU2OQyACYZT9FTav8Nzxm8JzBYelXlvTiXVJ6BPv5aNLhwX4kQ1lLUK23BI/iYkhOfgvlNQE8K+JhXyjS2D5mU3j/5UyFXTPFxIEpdh1Y024ZQ0t5ZHrOECmFOJSComtCtXA7iFOWBLNrtiO5cfLqgPcgb/AJ1oOlfo/afguok6iuEq9vJ38LHgsZ/CCSficVHlxSkiHqv7KVT4JXTO1bYeVhmktOah1ncPQtPQlOpBw9KcHKyyPMq7n2DJ9ldPcK+HFp0PBWWyJlzeTiTMWjClf0p/lT7Opxk0YWm2wbVDRCt0NmJGbGENMoCUj4CpnbvVcrsVlquUaN7d1bMNwWGj5zq7v2SSBgV9wKQ6UqWJ0kaCqNTQVQhF8P7IzsfqJ7eyns0Gsf6DX4B8q9UIRhmlmg+lQhGGaWaD6VCEYZpbf+Cg+lQhGGaWaD6VCEYZpZoPpUIRhmlmg+lQhF5IxQd4S/IfnTrP+oKg0IX/2Q=="},1890:function(t,s,a){t.exports=a.p+"assets/img/clip_image023.c1273083.png"},1891:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAAFjCAYAAADinsSzAAAQmklEQVR4nO3dsWsk5/2A8RQqXIZU+R8M4eb72r8mQR4S0kguQpprgzhIkaDqwBF3rg4OEkjAKgIiTbqgJqlcORA14QxXuHCRXJFgcCABFwIHQgIJ8yvkVxqNZle7Wn090u7ngQef9rS7r0b7Pvu+M/LpK18BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAl0bbtlsR8eOIeBERn0VER3IyP4uIF6WUx23bbk3dh1uhbdutpmn+cAcOLsmrvlyL2MTZSqb77jeje/9x6U7fK113RHIqT98r3QfvRPf2W2exaZrm6dSdWJk42y517z+e/gCTvPCPT0sXEV0p5aOpO7EyEfGXiOg++dn0B5bkhX//+XloPp26EytT94JTH1SSV63zc+pOrIzQkHdXoSGZrtCQTFdoSKYrNCTTFRqS6QoNyXSFhmS6QkMyXaEhma7QkExXaEimKzQk0xUakukKDcl0hYZkukJDMl2hIZmu0JBMV2hIpis0JNMVGpLpCg3JdIWGZLpCQzJdoSGZrtCQTFdouLQnB9E92j071k8eRne8f/W2k4Or34tXz0u3s312+/H+xYtvzFfPrx9H/zHq4w5f3PVxHu0u9pjMUWh4I4/3S3e4F92Th9Ed7l2e6GOTvju6GponD8c/b2f7ciBmxWjW/fvjqx+fHHh9TKnQcGkP98Ynfl01jN3+5OHVSNxkRfNo92wF1b9tLFo72/Mfvzq28uLtKzS8sTU4/Yl/uHfxcX8FM/x4GIfDvThfgfRXNHXVNHzR9u/X//z+uIa39Vc4/HIVGt7IuiLp/7c7OotEndD98zbd0eKhGXq8Xy49Tr3v8PHrc+5sx0IrmuF9mafQcGnrVqg7ujgZ3F/d1Ak8jEd/WzVr+7VIBIYrmOHYatCsaO6OQsMbWyMzvL1O8ke7F+dA6knd/oqmP/HHQnDdeZx5cbKiuVsKDZd2VgBqVA73zibx8OpTf+tUw7LsyeAaq1lXtqpWNHdLoeGN3Nm+fMWmf+zrFmm42umHpl49GgvG2Naof3m6/v1YkK7bkg0Vny9HoeHSvnp+EY2xFchwm9S/X72t3meR0Ixti+rf72zP3wLVq1b1hLWwTKPQ8EbWFcXO9sVEruHo/4Tw2OXtOvnHfuamH64arOFzD0NUVzv956ormxqW+jjD2/nlKDRc2nkBGE7ger6mv6qooVh0RbPM39exDccxHG8NznXneng7Cg3JdIWGZLpCQzJdoSGZrtCQTFdoSKYrNCTTFRqS6QoNyXSFhmS6QkMyXaEhma7QkExXaEimKzQk0xUakukKDcl0hYZkukJDMl2hIZmu0JBMV2hIpis0JNMVGpLpCg3JdNcmNKWUv0ZE98lPxYa8S/7jF+eh+dvUnViZiHgREd0H7wgNeZf88N3z36n+8dSdWJmmaX4SEd3bb0X34bvRfX44/QEmN9nPD88i8/1vn4WmlPJs6k6sTNu2WxHxsu4FSd4p/9S27WtTd+JWaNt2q2map6WUjyLi9A4cXHKTPY2Ij0spz9YmMlgv6ot16nEAWGOEBkA6QgMgHaEBkI7QAEhHaACkIzQA0hEaAOkIDYB0hAZAOkIDIB2hAZCO0ABIR2gApCM0ANIRGgDpCA2AdIQGQDpCAyAdoQGQjtAASEdoAKQjNADSERoA6QgNgFullPLpgr/58MXUYwVwT2ma5vkioWma5tdTjxXAPaVpmu98EZP/XRObH049VgD3mIj4/azAlFL+GxH/iohvTD1OAPeYUsrBNauZ3089RgD3nDfeeOP/mqb5Z9M0o9unUsqzqccIYA2IiN9+cdJ3LDS7U48PwBoQET8aXGWqf/7z66+//rWpxwdgDXjw4MFXm6b598jW6TdTjw3AGhERvxsJzQ+mHheANaKU8r3h1unNN9/8+tTjArBGtG37WkSc9lYzL6ceE4A1pGmaX7msDSCVBw8etL3QfGvq8QBYU2po2rbdmnoswCXatt2KiB9HxIuI+GzBf3qAd9BSyuRj4Mp+FhEvSimP1+YNo23braZp/nAHDi7Jq75ci9jE2Uqm++43o3v/celO3ytdd8T77H9+Of0YeHNP3yvdB+9E9/ZbZ7Fpmubp1J1YmTjbLnXvP57+AJO88I9Pz7bBpZSPpu7EykTEXyKi++Rn0x9Ykhf+/efnofl06k6sTN0LTn1QSV61zs+pO7EyQkPeXYWGZLpCQzJdoSGZrtCQTFdoSKYrNCTTFRqS6QoNyXSFhmS6QkMyXaEhma7QkExXaEimKzQk0xUakukKDcl0hYZkukJDMl2hIZmu0JBMV2hIpis0JNMVGpLpCg3JdIWGZLpCQ17j8X7pdravvrZ2tqM73p9+fPdBodkQH+1Gd3IQ3avnF5Omf9uj3fFj9+ThxWTa2Y7zF8zQJw+v3v/kIEYn6JizxnC4F93h3uzHuO7vh1/LycH45856nOP9Mvr1PtodPw6zHn/TFZoNcmf7IjT9gBzvl5mTdRiaV8+vfs7x/sUknhWiWQ7HMIzNMADD73F/fIu+4Me+hrHQ1K+nxrj/3PXP9XaBuf64C80GOGuinxycRWcsAMN38GVWNMusZrqji1DV8cyK1nBCz1pZzLrfycHVmHVH81dGh3vXP/6sFSEvv/6m7sTKCM3i3/BhAPofD1cI81Y09XjXFU3/MR/tXo3V0P7E7j92f4tTA1Afb/j1LBOzeV4Xmnnbs1nx4uXXitBsgHWJ31+9vHp+Non6k7Wet6kfLxKaodetZuoKof/5wy3NvJVKPziLhqa/QqrhWHRbZ0WzukKzAfYncv9kcJ0g/RXE2DmQGqh5W6f+9qSeAxobSw3IrOcYbsPmnaiu8Vx029QdzV6dWNHkKjQbZD8yffsnc+uE6a8A+iua4Ytn+Fj1XM5YaMYuE9cx1dVSfxs2FpJFrzBVd7ZvJzRWNKspNBvgrHf+/uSoHw/Pgwy3TmMnjusqpIaqxuK6FVC9Xw1QPzT9rV4dyzKXsqvD7Z4VzTQKzYZ4vH95CzKcPDUMw/vVENTJNHY5eXgyeOzk8Lzbu6OroRmeT+qvaBa9jF5jdRuhsaJZTaHZEE8OLl8F6k/4sW1StYalTsQvKzRjn3+TFc3wNdF/jH5YF3nssR/4W/bneDZVodkg6wqhvkPXSVJPmNYVwNjl7boymLd1qvdZNTT96K1yjmbs6ld/ddL/Ouf9wN4yis64QrMB1gkznEh1Io+9KPqTvK5kuqPxd/DrVjT9S9WzJmINTX8Lt+yKZuyS+NgP+I3FbpEVzXAbNut4cPzYCQ05x3mvLaFZ7hhO3YmVERry7io0JNMVGpLpCg3JdIWGZLpCQzJdoSGZrtCQTFdoSKYrNCTTFRqS6QoNyXSFhmS6QkMyXaEhma7QkExXaEimKzQk0xUakukKDcl0hYZkukJDMl2hIZmu0JBMd21CU0r5a0R0n/xUbMi75D9+cR6av03diZWJiBcR0X3wjtCQd8kP3z3/FcUfT92JlWma5icR0b39VnQfvhvd54fTH2Byk/388Cwy3//2WWhKKc+m7sTKtG27FREvh7/kneSd8E9t2742dSduhbZtt5qmeVpK+SgiTu/AwSU32dOI+LiU8mxtIoP1or5Ypx4HgDVGaACkIzQA0hEaAOkIDYB0hAZAOkIDIB2hAZCO0ABIR2gApCM0ANIRGgDpCA2AdIQGQDpCAyAdoQGQjtAASEdoAKQjNADSERoA6QgNgHSEBkA6QgMgHaEBkI7QAEhHaACkIzQAbpVSyqcL/i7nF1OPFcA9pWma54uEpmmaX089VgD3lKZpvvNFTP53TWx+OPVYAdxjIuL3swJTSvlvRPwrIr4x9TgB3GNKKQfXrGZ+P/UYAdxz3njjjf9rmuafTdOMbp9KKc+mHiOANSAifvvFSd+x0OxOPT4Aa0BE/Ghwlan++c+vv/7616YeH4A14MGDB19tmubfI1un30w9NgBrRET8biQ0P5h6XADWiFLK94ZbpzfffPPrU48LwBrRtu1rEXHaW828nHpMANaQpml+5bI2gFQePHjQ9kLzranHA2BNqaFp23Zr6rEAl2jbdisifhwRLyLiswX/6QHeQUspk4+BK/tZRLwopTxemzeMtm23mqb5wx04uCSv+nItYhNnK5nuu9+M7v3HpTt9r3TdEe+z//nl9GPgzT19r3QfvBPd22+dxaZpmqdTd2Jl4my71L3/ePoDTPLCPz492waXUj6auhMrExF/iYjuk59Nf2BJXvj3n5+H5tOpO7EydS849UEledU6P6fuxMoIDXl3FRqS6QoNyXSFhmS6QkMyXaEhma7QkExXaEimKzQk0xUakukKDcl0hYZkukJDMl2hIZmu0JBMV2hIpis0JNMVGpLpCg3JdIWGZLpCQzJdoSGZrtCQTFdoSKYrNCTTFRqS6QoNyXSFZkN8tBvdyUF0r56Xbmc7rtz2aHf82D15GN3x/tmfd7bj/AUz9MnD2cf+ycOz51lmvP3nnefhXnSHe4s/9qzxD63P/er54vdZ9mvcJIVmg9zZvghNfyIf75eZk3UYmlfPr37O8X6ZG5qTgziP27wX4qzn7Y7KpUDO+7xFXvDXfc6yj8nFjrvQbIDz3oWfPBx/R+9//Gg3rl3RLPPuP1wJ3TQ0j3aXW20su6Lh7b7+pu7EygjN4t/w4YTtfzyc4PNWNPV4j61oTg7Gvx+He+OT+KahuW6lNO95htuuWSs23s7rTmg2wLra6K9eXj0/m2z9yVrP29SPFwnNvOfsn/s53LtY+cx6Ic7ztkJzuHf9c9UgLrtCsxKafdyFZs2tq4tXzy+vDOqWqH+ydmxlUQM1b+t0k+1J/z5DF1nRLLpV6z/HbaxoZq2uOFuh2SBnTZC69Tk5iPMVSI1T/116eN9Zx3vZ78PY1mvshOxwtbWIO9u3E5p+jPvHsZ7jmvp7e9cVmg1w1jt/f1tTPx5O7uHWaezEcf+kbv28ZcaXHZrhdm9R6336Aa7Hc7jdtGWar9BsiMf7V8+X9N/N69ZoeL864etkGwtAPxQ32VYsG5r+amueNbA1NP2xDb+u/vMMVzXDWI19jf3n4VWFZkM8Obh8crM/sce2SdU6IWuYrgvN2MS9zswVTf810Y/t8OeIHu3GpUvlNRpPHl79gcCx0AxDzqvfB6HZEOu2p151qZOtnjCtK4Cxy9t18l23dbrJNmKZqzvLhGb4g4L9sdWvqwamxnZ4AnosHrNuv0kIN0Wh2QDrJBq+M9cJPvai6E/+upLpjsZXGmMnkzO8biKP/fDe2Anc/ueOraRmRa1/1W2Z/+2BQkPyS1BoSKYrNCTTFRqS6QoNyXSFhmS6QkMyXaEhma7QkExXaEimKzQk0xUakukKDcl0hYZkukJDMl2hIZmu0JBMV2hIpis0JNMVGpLpCg3JdIWGZLpCQzJdoSGZrtCQTHdtQlNK+WtEdJ/8VGzIu+Q/fnEemr9N3YmViYgXEdF98I7QkHfJD989/1XCH0/diZVpmuYnEdG9/VZ0H74b3eeH0x9gcpP9/PAsMt//9lloSinPpu7EyrRtuxURL4e/5J3knfBPbdu+NnUnboW2bbeapnlaSvkoIk7vwMElN9nTiPi4lPJsbSIDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwT/h/kOPlTRhiC10AAAAASUVORK5CYII="},1892:function(t,s,a){t.exports=a.p+"assets/img/clip_image030.fdd56649.png"},1893:function(t,s,a){t.exports=a.p+"assets/img/image-20200425043540704.89dd7bee.png"},1894:function(t,s,a){t.exports=a.p+"assets/img/image-20200425043623721.671da87e.png"},1895:function(t,s,a){t.exports=a.p+"assets/img/clip_image038.07a2376e.png"},1896:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAADcCAYAAABeUvdvAAAeKUlEQVR4nO3dT0gbef8H8Hd+/E6pu7ANIush7oOHGlihYBYcDzUeWh5wtodOKAa2D+tSmnjoLtR6MPFY04O60PWwJhQq3YXk0PTwPJPL8wia51CFbqDFQyLFg/Igj+g8PTxmrnkOMtPERPPH/JmZvF8g6ybfTD5jzfftd+Y787Xl8/k8iIiIavR/7S6AiIjMiQFCRER1YYAQEVFdGCBERFQXBggREdWFAUJERHVhgBARUV0YIEREVBcGCBER1YUBQkREdWGAEBFRXRggRERUFwYIERHVhQFCRER1+f92F0Cksdls7S6BLIKrVLQGRyBtYLPZ2FmewZ8HNRJ/n1qDIxBqu7MfdrP99cj6288K+2BGHIG0WOEvOv9KMv8Hn/W3Hz9H7cMAabNO/uU3e+fF+tuvkz8/RsAAaSH+sn9i9s6L9bff2X1Ip9NtqqRzMUAMoNOCxeydF+tvP4aHMTBAWqTTQuI8Zu+8WH/7MTyMgwFiEJ0QMGbvvFh/+zE8jIUBQi1h9s6L9bcfw8N4GCAtUO3owqqjELN3Xqy//RgexsQAoaYye+fF+tuP4WFcDJAmq3VUYaVRiNk7L9bffgwPY2OAGJAVQsTsnRfrbz+Gh/HxXljUcOUC0OyhyPrbi+FhTAyQJiv3l5/2YTbjX4WVmL2jIuNheBgXA4QaxuyHTVh/e5X744PhYWw8B0INYbXOi/W3Fkeu5sQAoUuzWufF+luL4WFeDBC6FKt1Xqy/tTjTytwYIFQ3q3VerL+1GB7md+mT6IqiYGtrC2/evAEAfPHFF/jmm28wOjp66eLIuKzWebH+1mJ4WMOlRiCpVArffvstRFHEf/7zHwDA69ev4fF4MDU1BVVVG1JkOYqiIBQKIZvNNu09qDyrdV6sv7UYHtZR9wgklUrB4/EgEAjgb3/7GxwOh/5cMpmEKIq4evUq5ufnG1LoWVtbWwiHw7h3715Ttk/lWa3zYv2txfCwlrpGIKqqYnZ2FpIkYWlpqSg8AGB8fBzBYBDhcJgjBAuxWufF+luL4WE9dQXI27dvsbm5iYcPH8Jut5dt4/f7Icsyuru79cdSqRRCoRD29/eL2u7v7yMUCiGVSgEAstksFhcXYbPZYLPZMDU1VfTLFo/H8eLFCwDAs2fPEI/H9efS6TSmpqbOfa32+lAoBEVR9PcZGRnRt5NOp+H1emGz2eD1evW6NKqqIplM6m1GRkYQjUbLHrKLx+OIx+NIpVJ6WzOyWufF+luL4WFNdQXIzs4OAOBPf/rTuW2cTifGx8eLRicnJycIh8MlHa2qqgiHwzg5OYGiKHC5XHj9+jVkWYYsyzg6OoLb7a74S5dKpeB2u/H+/XvEYjHEYjG8f/8ebre7KAS2t7cRDocxNzeHzz//HLIso7e3Fz6fD4uLi3j48CG8Xi9isRgODg7g8XigKIpe6/T0NERRxPDwMGRZxvfffw+/34/p6emSfdve3sYvv/yC2dlZxGIxjI2NVfdDNhCrdV6sv7UYHtZV1zmQvb09AKch0WhbW1sAgOXlZQwNDQEAhoeHkUgk8O9//xsAMDExgc8++wyJRAI//fQTBgYGig6rvXz5Uh8Z3b59G3/5y18wOzuLtbW1ohGTKIoYHx8HAAwODiKRSGBmZgZ7e3v6vn355ZfweDzY2trC+Pg41tfXsbKygo2NjaKZZjdu3IDL5SrapmZzc1NvPzExgXA43PCfW7NYrfNi/a3F8LA2w94La319Hd3d3XA6nXA4HBU/OJlMBpubm5BluSgk7HY7JicnIYoi3r59W9TpDw8P699rgREIBIqCsaenp+h9ZFlGIBAomaY8MDCAQCAAWZZLAgQAvvnmmyr22lh4V13jMXP9DA/rqesQ1hdffAEATZmmOzY2hkAggJmZGfT19cHr9SIajVY8Ga+NTvr7+0ue0x47OTkpevzsyX8AuHr16oXvs7KygpWVFf0cS+GX9lw5550rMiozd1RkPAwPa6prBOJyuQCc/tWvHWY6S1VV/PWvf8X169cxMDBQ9bbtdjt+/fVXTExM4O3bt5iZmUEikQAARCIRPHjwoJ6SG0qSJExOTra7jKax2mET1t9aPGzVOeoKEO3QTzqdPjdA3r59C5/Ph1gsVjFAcrlc0f9ns1mMjo5idHQUjx8/RjqdxvPnz+H3+/HnP/+57LmXrq4uAMDh4WHJ+x0eHha1uQxJkgCg7GEqK7Ba58X6W4sj185S1yEsh8OBYDAIv99fMsUV+HSdiCAIuHnzZsnzWoeuKfwLJRqNwuVyFR2yGhoa0s85nHfY7OuvvwYA/P3vfy95TntMa3MZt27dQiKRKPmrSlVVfTqvWVmt82L9rcXw6Dx1n0R/9OgR1tfX4fF4EIlEMDQ0hCtXrmB3dxfz8/P6zKPC8wyDg4MAgNnZWTx9+hQ9PT345z//idXVVb3NjRs3AABzc3N4+PAhenp6cHh4iF9++QWSJJWMLnZ3d2G32+F0OhGLxeDz+QAAd+7cAXB6a5VwOIxYLFb2nEetJEnC6uoq3G43ZFlGf38/Dg8PEY/Hsbm5ieXl5Uu/RztYrfNi/a1V7rDVeUcnyDrqDhCHw4G1tTX8/vvv8Pv9Rc9JkoQ//vij5BfI6XRClmWIogiPxwMACAaDWF5ehtvtBnA6m2ljYwOzs7N6G61d4fsMDw9DEASIoghJkvDq1StMTEwAAHw+nz5VVhCEc2dG1bvf8XgckUgEoijqjwuCgI2NDVN+aKzWebH+1uI5j85lyzfot1U75KSNBi6iqir29/crttW22d3dXXb0oG0HQNHI5LzHG01RFBwdHdX8PkZaE91qnRfrb62LwkP7Y6rWQCn8I6ze15rt52hWDQsQqp5RAsRqnRfrb61KIw8GiPVxQakOZbXOi/W3Fg9bEcAA6UhW67xYf2sxPEjDAOkwVuu8WH9rMTyoEAOkg1it82L9rcXwoLMYIB3Cap0X628thgeVY9i78VLj8K66xmPm+hkepOEIhIiqZuTwKJz+a+aANhOOQDqI2Q6baIxy3Uy9rFK/WcIDMO/P2mw4AiEiUzPj7YOsggFCRKbF8GgvBggRmdLZ8DDyITarYoAQkekwPIyBAUJEpsLwMA4GCBGZBsPDWBggRGQKDA/jYYAQkeExPIyJAUJEhsbwMC4GCBEZFsPD2BggRGQKDA/jYYAQkeExPIyJAUJEhlHu1iQMD+NigBCRITA8zIe3c+9QyWSyYpvx8fEWVFIbRVGwtbV1YZuuri6Mjo62qCJqBN4U0ZwYIB1KFMWKbZq1poKiKPj5559x7949DAwM1PTao6OjirUHg8GmBUg2m8Xc3BxevXrVlO13IoaHefEQVgcLBoPI5/PnfjXL1tYWwuHwpbYhy/K5dc/Pzzeo0lK//fYbEolE07bfaThN19wYIETUFgwP82OAUFXS6TRCoRBsNpv+tbi4iP39/ZK2yWQSU1NTZdvF43G8ePECAPDs2TPE43HD1K6qKqLRKLxeL2w2G0ZGRhCNRqGqKgAgFAphfX1d/z6VSjW9dqtieFgDA4QqSqfTcLvd2NnZgSzLkGUZwWAQMzMzePToUVHbaDSqn6OQZRmRSAQzMzOYmJiAoiiGrV1VVUxPT8Pv92N4eBiyLGNsbAx+vx/T09Mtr9vKGB7WYctz9fmWs9lsAJp3krqa97PZbBAEAWNjY2VfU3gewev14uDgAGtra7Db7frj0WgUfr8fmUwGAwMDyGazcLlcWFhYwOPHj/V2WiceiUTw4MEDJJNJiKKov66W+rX3kCQJ165dK2k7ODiIiYmJmmvXapJluWj2WTweh8/nw8bGBkZHRxEKhRAOh2v6t2v1v3ejafXX2tFrQVH4umrCo7BNve9p1p+12XAWFlX08uVLHB8fF3XA5bx79w4AcPfu3aLHh4aGqg6LRqu2dlmWIQhCydTl27dvY29vD06ns5lldgSOPKyHAdLBxsbGqpqxpHW+yWQSmUwGHz9+LDuLant7GwDKdraNDo/JycmqrlOptvaVlRUEg8Gyr2d4XB7Dw5p4DoQqSiaT6OvrgyiK+kV82vkNozNz7VbB8LAujkDoQoqiQBRFBAIBPHnyBA6HQ3/u7NXsfX19+msK2wFAKpVCV1dXSy8aq6V2SZKws7NTdjvJZBKDg4MciTQAw8NaOAKhCx0dHQE4vXK9sANWVVWfjqvRTmqfvdWIqqrweDx4/vx5k6stVkvtt27dQiKRQDabLXo8nU5DFEW8efOm+QVbHMPDejgCoQs5nU4IgoD5+Xl0dXWhp6cHh4eHWF5e1q/IzuVyAIDR0VEEAgGIoohYLIbr168jl8vpwXH//v2ibe/u7jb1HEMttUuShNXVVfzwww8IhULo7+/H4eEhZmdnIQgCbt68WbTtdDqNr776qmSkRad42KozcARCF7Lb7Xj69CkAwOPxwOVywePxwOv1IpPJAAA+fPigt19aWkIwGITP54PL5YLb7cb79++xsbGhdyrDw8MQBAGiKJZcR9Ku2h0OB+LxOHp7eyGKot62t7cX8XhcD4o7d+4AANxuN29pcg6GR+fgdSBtYITrQOqhHd5xOp0Vp8Wqqqpf6V1uBlal5ws1ov5aalcUBUdHR+eOjio9f1YnXQfSiFuy8zoQ8+AhLKpaLVNx7Xb7he0rPd9otbyXw+G48NBUpec7Fe+q23l4CIuILo2HrToTA4SILoXh0bl4CIuI6mb28KhmZU7gdJXLr7/+GltbW+jv72/LbXmMiAFCRHUxe3gA1a3MCZwuvtbT06PfcJMBcooBQkQ1s0J4AKWztS66U7SqqshkMuju7m5liYbGACGimlglPGrV6pmDZsCT6ERUtU4NDwDY398vWYkyHo8jFApBURQsLi7qK1lqK22m02l9hUuv11uyiqWqqkgmk+eugml0DBAiqkonhwdw2tmHw2GcnJzoj21vbyMcDmNubg6ff/45ZFlGb28vfD4fFhcX8fDhQ3i9XsRiMRwcHMDj8egrc2qrYIqiqK+C+f333+urYJohRHgIi4hq1mnhUYkoivr6NIODg0gkEpiZmSlajOzLL7+Ex+PB1tYWxsfHsb6+jpWVFX21S82NGzfgcrmKtmlUDJAOot2SwqxYvzEwPEoNDw/r32uBEQgEim5109PTU/QaWZYRCASKwgM4vWtCIBAoWV7ZiBggRFQ1I4dH4SE2m83W0vthlbu1zdWrVy98zcrKStF/y/n1118vV1iTMUCIqCpmCQ/APDdTlCQJk5OT7S6jbgyQDmKWD9VZVrmbrdnrNyqz3sRRkiQAMPxhqotwFhYRmZZZwwP4tArm2ZGdqqr6dF6jY4AQkSmZfVqxJEkQBAFutxvJZBLZbBapVArT09PY3Nw0RTjyEBYRmY7ZwwP4tApmJBIpuieXIAhFK3gaGVckbAOzrkjYLqy/vWpZkbCQ1gE2ekXCi8LDrCsSaqtcArUtftZuHIEQkWlYYeRRjllXueQ5ECIyBauGh5kxQIjI8DohPGw2m+GnTJ/FQ1hEZGhWDo+zgWG2czcMECIyLCuGh9lGGRdhgBCRKZg5PKwUGoUYIERkeGYMj1pDw2yHrwAGCBEZSLmL58wWHlYdbZTDWVhEZAhWCA/AnCOJejFAiKjtzHDbjlrUGiJmDR0GCBG1ldXCQ2PWUKgFA4SI2saK03Q7CQOEiNrC6uFR7cl0M49UOAuLTEVRFGxtbV3YpqurC6Ojoy2qqHGy2Sx2d3cvbNPf32+qu7Wep9PCI5/PW3J2FgOETOXo6Kho7YRygsFg0wIkm81ibm4Or169avi2d3d3K+6bLMtNC5Bm7luhTgwP7b9WCxEGCJmSLMttWUv6t99+QyKRaOp7ZDKZtowyWrFvnRoehf9f2MbMh68AngMhohbp9PCo9LgZMUDI8tLpNEKhkH67bJvNhsXFRezv7xe1U1UV0WgUXq8XNpsNIyMjiEajUFUVABAKhbC+vq5/n0qlWr4vZ1W7bwCQTCYxNTVVtl2z943hgZLnrRAkDBCytHQ6DbfbjZ2dHciyDFmWEQwGMTMzg0ePHuntVFXF9PQ0/H4/hoeHIcsyxsbG4Pf7MT093cY9OF+1+wYA0WhUP78iyzIikQhmZmYwMTEBRVGaWifDw7q4JnobcE302hTWn81m4XK5IEkSrl27VtJ2cHAQExMT+v97vV4cHBxgbW0NdrtdfzwajcLv9+vnG5LJJERRLDm3Eo/H4fP5sLGxgdHRUYRCIYTD4Zp+ltX+/LUaAoEArl69WvL8rVu3iiYHVLtv2s9sYWEBjx8/1ttpARSJRPDgwYNz9+2ya6IXqmYbldZEr+a1rf5sacz6GasXT6KTpb18+RLHx8dFHWw5sixDEISSE/O3b9/G3t4enE5nM8usS7X79u7dOwDA3bt3ix4fGhpq6Ql7jjyshwFCpjQ5OVnVLCytc00mk8hkMvj48SPC4XBJu5WVFQSDwbKvb3V4/PTTT1V16tXu2/b2NgCU3Y9mhQcPW3UGngMhS0smk+jr64MoivoFiNo5ALMz6r4xPDoHRyBkWYqi6OcUnjx5AofDoT+XTCaL2kqShJ2dnbLbSSaTGBwcNNRhrFr2ra+vT39NYTsASKVS6OrqatgNDa16Y0QNw6MYRyBkWUdHRwAAURSLOk5VVfHixYuitrdu3UIikUA2my16PJ1OQxRFvHnzpvkF16CWfdMmG5y9BYyqqvB4PHj+/HlDamJ4dB6OQMiynE4nBEHA/Pw8urq60NPTg8PDQywvL+tXXOdyOQCnI5DV1VX88MMPCIVC6O/vx+HhIWZnZyEIAm7evFm07XQ6ja+++qrkL/pWqWXfRkdHEQgEIIoiYrEYrl+/jlwupwfH/fv3i7Zdz76VO2xlpUBheJTHEQhZlt1ux9OnTwEAHo8HLpcLHo8HXq8XmUwGAPDhwwcAgMPhQDweR29vL0RR1Nv29vYiHo/rnemdO3cAAG63u+m3/bhILfsGAEtLSwgGg/D5fHC5XHC73Xj//j02Njb0jr7efeM5j87F60DagNeB1KYR9WuHppxOZ8Vpr4qi4Ojo6NwZWJWeP6vZP/9a9k1VVf3q83IzsMrt20XXgVwUHtpzl7l+pN3XgTA8LsZDWNQRapmu6nA4Ljx8U+n5Vqtl3+x2+4Xta9k3jjyIh7CIqGYMDwIYIERUI4YHaRggRFQ1hgcVYoAQUVUYHnQWA4SIasbwIICzsDqK2ddjZv3GwPAgDUcgRFQ1I4dHPVe+MzwuhwFCRFVheNBZPITVQcz6AeGV9O1l9ENvZ8Ojmp8zw6MxOAIhItNieLQXA4SITInh0X48hEVEpnPZ8GBwNAZHIERkKgwP42CAEJFpMDyMhQFCRKbA8DAeBggRGR7Dw5gYIERkaAwP42KAEJFhMTyMjQFCRKbA8DAeBggRGR7Dw5gYIERkGOVuisjwMC4GCBEZAsPDfHgrkw6VTCYrthkfH29BJUT1nSwHGB7txgDpUKIoVmzTrA+koij4+eefce/ePQwMDDTlPcg8GB7mxUNYHSwYDCKfz5/71SxbW1sIh8NN2z6ZB8PD3BggRNQWDA/zY4BQVdLpNEKhEGw2m/61uLiI/f39krbJZBJTU1Nl28Xjcbx48QIA8OzZM8Tj8ZbuBxkDw8MaGCBUUTqdhtvtxs7ODmRZhizLCAaDmJmZwaNHj4raRqNR/fyKLMuIRCKYmZnBxMQEFEVpR/lkMAwP67Dl+S/Rcq1eI7vc+9lsNgiCgLGxsbKvmZ+f17/3er04ODjA2toa7Ha7/ng0GoXf70cmk8HAwACy2SxcLhcWFhbw+PFjvZ0WQJFIBA8ePEAymYQoivrr6qnfTKxSfzqdrul1WlAUvo7hYS2chUUVvXz5EsfHx0XhUc67d+8AAHfv3i16fGhoqOqwIOtieFgPA6SDjY2NFY00zqMFRzKZRCaTwcePH8vOotre3gYAOJ3OkucYHp2N65dbE8+BUEXJZBJ9fX0QRRFbW1sAPp3fIKqE4WFdHIHQhRRFgSiKCAQCePLkCRwOh/7c2avZ+/r69NcUtgOAVCqFrq6usreroM7B8LAWjkDoQkdHRwBOr1wvDAVVVfXpuJpr164BgD5KKWzr8Xjw/PnzJldLRsbwsB6OQOhCTqcTgiBgfn4eXV1d6OnpweHhIZaXl5FIJAAAuVwOADA6OopAIABRFBGLxXD9+nXkcjk9OO7fv1+07d3dXdjt9rLnTMjceNiqM3AEQhey2+14+vQpAMDj8cDlcsHj8cDr9SKTyQAAPnz4oLdfWlpCMBiEz+eDy+WC2+3G+/fvsbGxoXcqw8PDEAQBoiiWXEdC5sfw6By8DqQNjHAdSD2y2SyA01FJpSm9qqrqV5+Xm4FV6flCVrmOwuz1V3MdCMOjszBA2sCsAdIurL+9qg0Qhkfn4SEsIro0hkdnYoAQ0aUwPDoXZ2ERUd3aFR7ZbBa7u7vnPt/f38+7H7QAA4SI6tLOkcfu7m7FVTUDgQCWlpYqTvig+vEQFhHVzCiHrTKZTMlKmsfHx4hEIlhZWcHvv/9+6feg8zFAiKgmRgmP8zgcDjx48ACSJMHv9zftfYgBQkQ1MHp4FNJurVNIURREo1GMjIzAZrPB6/UW3dNNURSEQqGyK2WmUimEQiF9OnMqlTp35c1C+/v7CIVCSKVSSKVS8Hq9Zd8bOF2xMxQKnfve2vZVVUUymdS3NTIygmg0ClVVa/shXVaeWg5AvpU/+la/X6Ox/vbS6j/7Vc9rG0WW5TyAfCaTKfv83t5eHkB+YWGh6DFBEPKCIOQjkUheluV8MBjMA8hHIhG9nSRJeQD5XC5XtM1AIJAHkD8+Ps5HIpE8gHwgEMjLspyPxWL6tvf29opel8lk9LaCIORjsZjeHkB+Y2NDb6vVc9H+5nI5vZaFhYW8LMtF9Zytu5nM+1ttYgyQ2rD+9jJaeOTznzpULQgKv7TO9GxnHgwGy3bwZ8MoFouVdOy5XE7voLVAKAwdrY0gCPlgMFj0uNZeEISizl17vDDkqgkQ7fvC+gq3J8tytT/GS+MsLCKqSb6OQ1D1vKYa5c5xSJIEWZYxNjamz8BSVRXhcBixWKzk5p3ass7v3r3DwMAARkZGAAA7OzsYHR0FALx9+xbA6V2ptZU3v/vuu6Lt2O12/Pjjj/D5fAiFQiWzv3788ceix7Rpxh8/fqxpn2VZRiAQ0Gsr3F4gEIAsyxgfH69pm/XiOZAOoh2rNdsX6zdG/YCxwgMonoV1fHyMQCCARCKBrq6uos5aO3fg8/lK9u/KlSsAilfUlCQJq6ur+uu1ABkeHtbbXblypWRbPp+v6P0KffbZZw3Z55WVFaysrJT9t9KeaxWOQNqgmR8oomap9fe21b/nDocDS0tLODo6wuzsLOLxeMloIxgM6iOMs7q6uvTvvV4vfD4f0uk0XC4XZmZmEAgEitbEkWX53Fq6u7svuTcXkyQJk5OTTX2PajBAOgADizqF3W7HkydP4HK5EIlEMD8/D+BTh97X11fV4R0tZNLpNE5OTgBAv3BRW3lzeHi4ZOXNZvnvf/+rfy9JEgC07DDVRXgIi4gsZWBgAJFIBOFwGKlUCsDp6EQ7LKUoSlH7bDaLkZGRoim1hYexCg9fAZ+mB//jH/8oee9QKISpqalLT6c9W+OrV6/072/duoVEIlFyd2RVVfXpvK3CEQgRWc53332H1dVVzM7OYm1tDXa7HbOzs3C73fj222/x9OlT9PT0YHd3Vx+laAGh0Q5jbW5uQpIkfbShrbzp8/nwr3/9C6IoIpfLYX19XT9RX+/tU7SRz9zcnL6C5+vXr3FwcKC30YLN7XZDlmX09/fj8PAQ8Xgcm5ubWF5eruu969Ky+V5ERA1S6TqQwjaxWEx/7I8//tCv89C+JEkqmdqbz3+6luTsNvL50ym72nThwq+z7fL5i6fXAiia9pvL5fILCwsl2zy7v3t7e/qUX+1LEISSqb3NxgWliKjj7O/vQ1VV2O32khPttShcWbOalTqrpSgKjo6O0N3dfeF5Fq0dUHllz2ZggBARUV14Ep2IiOrCACEiorowQIiIqC4MECIiqgsDhIhMrdw9u6g1GCBEZAkMktZjgBCRpTBIWocBQkSWxCBpPgYIEVkag6R5eDPFDsAPD9GnzwFvvtE4HIEQUUfhH1SNw3thEZGp1RsI7PoujyMQIuo4DI/G4DkQIuoIDI3GY4AQkaUxOJqHAUJElsTgaD4GCBFZCoOjdRggRGQJDI7WY4AQkakxONqH03iJiKguDBAiIqoLA4SIiOrCACEiorowQIiIqC4MECIiqgsDhIiI6sIAISKiujBAiIioLv8DLVTuOZS1ltsAAAAASUVORK5CYII="},1897:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005118989.44400b9c.png"},1898:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005130096.047d5e6e.png"},1899:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005140397.1612e4e7.png"},1900:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005208823.e68df922.png"},1901:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005216316.d7ce32f8.png"},1902:function(t,s,a){t.exports=a.p+"assets/img/image-20200426031953090.dab6359b.png"},1903:function(t,s,a){t.exports=a.p+"assets/img/image-20200426032123292.6d3474f0.png"},1904:function(t,s,a){t.exports=a.p+"assets/img/image-20200426032416699.3660421a.png"},1905:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005452899.c6e4e4bd.png"},1906:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005531276.4d9ccf28.png"},1907:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005607470.d16ca275.png"},1908:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005649884.b3e5097f.png"},1909:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005656263.bef2c1d2.png"},1910:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005707333.9ce02e70.png"},1911:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005715680.9a0e19c2.png"},1912:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005743034.e5c40ed2.png"},1913:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005802071.3153cde7.png"},1914:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005808500.f5a56de7.png"},1915:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005815737.af87d87f.png"},1916:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005822545.004970d3.png"},1917:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005828396.f93ff961.png"},1918:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZMAAAGPCAYAAACZCD2BAAAgAElEQVR4nO3df2xUdcLv8U8tVmU7ly41zLQ6Wy7gqMXWtsMtAm4A2SdaJuBm2dTUvaZNZDTkoQngc1tN6l/bLLe4tJhy/9Bmw/izoakrIdQRnw1ro7uxTzyUrVket7qEtQidJ4LNFslibp37R++c7TDTFvzOzKHD+5UQmDMz53xJSt/9nu85Q040Go0KAAADNzk9AADA3EdMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjM3LxEEmJibU29urcDiskZERjY2NZeKwANKooKBAXq9XGzZs0OOPP67c3FynhwQH5USj0Wg6DzAxMaFt27bJsqx0HgaAg0pLSxUKhQjKDSztM5Pe3l5ZlqXb/luhVv18h7z3rdat+QXpPiyANPvHxTGd/cvH+uitF3Xy5EkdOHBAW7dudXpYcEja10zC4bAkadXPd+iuBzYSEiBL3JpfoCX+n+jHjz8nSTp27JjDI4KT0h6TCxcuSJIW/ffl6T4UAAf8sHiJJLEWeoNLe0y+/PJLSdICd0m6DwXAAfkLPZKkSCTi8EjgJC4NBgAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYm+f0AHB9eekp/1W/9ufPd6vQ69Ox37TIvaRcy9fXxj1/+NdBLfX/S8J2SXrj2YAuXhid9Rj5Cz36xf/uu+oxAXAGMUGCp1+24h6/9JQ/YdtUF7+O6P5lFXHbzo8MS1LSkMTEYjSd8yPDevf/7LyaIQNwGDFBUgO/7dSJd0P24ytnLA//a7sW379WkjT+1dmEKPzpvVe15rH/JUk69psWSdJDT7bGvab3l3WzjiN/oefaBw8g44gJplXxSINW/qwxYfvhXwclxQcnFpsH65rlWVahH/zQbQfmoSdb9cazAZ3+U78dIImZSTZqaGiQ1+tVSUmJVqxYoYqKitnfhKxATDCtE++G4mYnU5X/y//Uyp81yr20XKc+/nc99GSrjv2mRT9Y6Naf3ntVF7+OJMxm/tC9Jy4msyn0+lgvmWM++eQTffLJJ5KkvLw8bdq0SZs3b9Z9993n8MiQbsQE05ptZiJJkb8Oyb2kXNLk2knkr0P6bCCs/IWehHWWN54N6M+/74lbRzn866DODR+fdgwP1jXPuO6C60soFNLnn3+uU6dOqbe3V2+99Zbee+89NTU1aePGjU4PD2lETDCt2WYmkhQ5NaRl/39t5NzwcW3+t66kAZKUMMso9Pq0+d+6UjhiOK2srExlZWWSpLq6Ou3fv19Hjx7V7t275ff75Xa7HR4h0oWYIM7UBe/YzCS2dhGLwdSZybnh4xq/cE7jF87prpU1kqa/7PfKmc6x37Tos4HwrGOautiPuaO4uFi/+tWv5HK51Nvbq5dfflnPP/+808NCmhAT2E7/qV+u24sladrZhaS42cTTL1t2PB7+13Z7+5WL6wO/7Uw4zkNPttpXeB3+dVD5P3QnXPGFue+pp57SO++8o0OHDmnDhg1avXq100NCGnAHPGxT1z+kyW/wp//UH/eal57y2/eQxCyrfkTS5AL79znOn3/fI+mflw4P/LYzLj6Y2woLC7VlyxZJ0vHj06+PYW4jJrB9/h/vatn/eFjS5Kkq95Jy+/RSbMby9MuWen9ZZwdg4Led+vw/3tXTL1taVv2IfQqs95d1eukpv/1r6trL1OP8+fc9+rC7LW62s/Jnjfrm64jeeDaQ/r80MmLp0qWSpHPnzjk8EqQLp7kgafLUU9FdlSr0+vTGswFVPFwvz7IK+/Leikca7NfGTm391fp3Sf9cWI+dGnvj2cC0p7mmHuf8yLA+7G6TNP3HuBz+dZBF+ixQXDz5w8jo6OwfoYO5KScajUbTeQC/f/KbxEwfxwFgbov9MGBZyf+dnz17Vps2bZLH41FfH/cOZSNOcwFIO2Ym2Y+YAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMBY2mNyxx13SJLGIn9L96EAOOCbryOSpEWLFjk8Ejgp7TFZuHChJOnCmc/SfSgADvh69LQkyeVyOTwSOCntMVm7dq0k6aO3XtSZ/xzQ5Uvj6T4kgAy4fGlcZ/5zQH/o3iNJWr9+vcMjgpNyotFoNJ0HmJiYUENDg06ePJnOwwBw0OLFi9Xd3a28vLxpX+P3+yVJlmVlaljIoLTPTHJzcxUKhbRt2zbdfffdTIWBLOFyubR06VJt3bp11pAg+6V9ZoIbDz+BIhm+LrIblwYDAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAyIjbb79dknT+/HmHR4J0ICYAMiI/P1+SdPnyZYdHgnQgJgAyYtmyZZKkgYEBh0eCdCAmADJi7dq1kqQjR444PBKkAzEBkBHr1q1TQUGBTpw4obfffjsl++zp6VFLS0vcNr/fr+Hh4WnfMzw8rEAgkLDN7/dP+57Ozk51dnYmfS4QCMx4vGR6enrk9/sVDAav6X3Xs3lODwDAjWH+/Pl67rnn1NzcrN27d2vevHnatGmT0T6HhoZUXl4et629vV0vvPCCurq64ra3tLQoHA7bj2Px6O7u1quvvhq3raGhQY2NjfZrGxsbFQgEFIlE1Nraam/v7OxUZWWlfD5f3LECgYBGR0enHXdNTY0sy7qWv+p1LycajUadHgSyS+wfZLb9Y0Fq7Nu3T6+99pokaeXKldq+fbtKS0u/1778fr+am5vV1tY24+uqqqrsuAwPD2vnzp3q6+uTNDlLGBoasiPh9/vV3d2dEIjh4WHV1dXZz/X392vXrl2zfp13dnYqFAqpvb3dPtWXjYgJUo6YYDYHDx7Uvn379O2330qSvF6v1q1bp3vvvVder1cFBQVyuVxyuVzT7uPKCMTEAlNbWxu3PRaDK00NTUtLi8rLy+PeGwwGdfz48Vn/Th6Pxw6UJDs2V85yJNmn2aa+fq4jJkg5YoKrcf78eYVCIb3zzjsaGxub9nXTfR0FAgFVVlbGxSR2KmvqN/BAIKCOjg5J0s6dO9XR0RH3e1NTk3bt2pWw/5lmEoFAYMYQxGYj00kWu7mOBXgAjsjLy9OCBQtmnH1MJ9lieE9PjwYHB9Xd3a2hoSFJk3GprKycdX9VVVWyLMv+VVVVdc1jmqqxsTFuf83NzZImA2VZlioqKoz2fz1iAR5AxvX29mr//v0aHx+XJLndbq1bt04lJSXyer1avHixJKm4uDjp+yORiOrr6+1o9Pf3q62tTc3NzfL5fDp79qx9pdTUtZLR0VH7VFddXZ08Hk/cfq+cccw0w0h29VdNTU3cTCl2imzqgnt/f7/27Nmj+vr6rJqdEBMAGfXmm29q7969kqSysjJt27ZNK1euvKZ9tLa2qqenR9LkjKStrU01NTX284888oiGhoYSrujyeDyqrKzU4OCgfZprJo2NjQnrHbHAJFukj7nyyrFwOBz3WJLa2tqSrvnMVZzmApAxH3zwgfbu3avc3Fzt2LFDoVDomkMyVSQS0SuvvJKwrtLY2JiwaO7z+VRfX6/BwUF7htLU1GQ/fzX3igwPDysUCsmyrBlD1NraGneaK3bqLHaaK/YrEonYUZzriAmAjLh06ZJ2794tSXrmmWf0xBNPGO/T7XZPuxDe3Nwcd1Ng7FRYR0eHPB6PLMvSnj17VFRUpK6uLh09etR+bVdXV8Lie+xqsPb2dklSR0fHjDc6xm6EvDJSPT099tVcXV1dWXOqi5gAyIj3339fkUhEZWVleuyxx9J2nGAwqGAwqNraWrndbjsor7/+esIMpq+vTz6fzz511dTUJL/fn3BXfSAQUF1dnSzLsiPj8/lkWVbSO9k7Ozvj7kmZqqKiQvX19fL7/dPeVT8XsWYCICP6+/slSY8++mha9j84OKhwOBx3SW9ra6taWloUDAYT1k9iY4rdCxILjWVZ9nvcbnfCPq9kWZb98ShVVVVyu92KRCL2/qbOXmJj8Pl8qq2ttWcoV67LzEXcZ4KU4z4TJLNlyxadPn1ahw4dktfrdXo4SDFOcwHIiIsXL0qa/IwuZB9iAiAjvvrqK0lSYWGhwyNBOhATAIAxYgIAMEZMAADGiAkAwBgxAQAY46ZFGNm4caMikUjS56berFVWVjbj/+8AYG5jZgIjGzduvKrXlZSUpHkkAJxETGCkurpaknTTTTN/KZWXl2diOAAcQkxgpLq6WtXV1fruu++SPp+bm6tbbrmFmABZjpjAWGx2kszExITuv/9+3XXXXRkcEYBMIyYwVl1drdtuu005OTlJn2dWAmQ/YgJjy5cv1wMPPKBoNKpkH0JdVlbmwKgAZBIxQUrETnXFZiexqJSUlBAT4AZATJASNTU1uvnmm+3Hsajcc889WrBggVPDApAhxAQp4XK5tGbNmoTtq1atcmA0ADKNmCBlNm3aZP85dppr9erVTg0HQAYRE6TM6tWr5XK5JE2e5iotLeU/QgJuEMQEKZOXl6cNGzbYj5mVADcOYoKUqqmpsf/Meglw4yAmSKkVK1bYf+aSYODGkZGPoJ+YmFBvb6/C4bBGRkY0NjaWicPCITk5OYpGozN+zArmvoKCAnm9Xm3YsEGPP/64cnNznR4SHJQTTXbLcgpNTExo27ZtsiwrnYcB4KDS0lKFQqEZgxL7/234XpCd0j4z6e3tlWVZKiy8WTt23KnVqxeooID/kyvbffttVHl5yT+rC9lhbOz/6uOP/64XX/xSJ0+e1IEDB7R161anhwWHpH3NJBwOS5J27LhTGzcWEpIbBCHJfgUF8/STnyzUc8/9SJJ07Ngxh0cEJ6U9JhcuXJAkLV/+g3QfCoADliy5TZJYC73BpT0mX375pSSppOTWdB8KgAM8njxJUiQScXgkcBKXBgMAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjM1zegC4vrW0nFJ5eb5qaxdN+5pAYEj19R7V1i5SS8sphcMXkr6uqsqlrq677feMjn476/E9njz19ZV/v8HjunHu3DlJksfjcXgkSBdiAmN9feUKBv8iSWptXaLW1iUJr+nvH9Prr0fitnV3l8rnmz/tfoeHL2nnzs9TO1g4IhYTt9vt8EiQLsQERmIzl9iM41rU1Z2c9TUeT973GRauM8xMsh8xga2z84xCodGE7eHwBbW1fRG3rbn5RwmnvoLBv+j48fG4bVNPbV2JmcmN44svJr9+Fi2a/nQp5jZigjgNDR41Nt5pP062ZtLScmra97e3L9PatQWSkp/auhY+33zWS7LA2NiYDh48KEny+/0OjwbpQkyQUrt2xc8kqqpcM74+2WxmqmQzIMwtXV1dGh8fVyAQ0Jo1a5weDtKEmCClrmVm4vPN/15rLZgbPv30Ux05ckR9fX0qKirS5s2bddNN3I2QrYgJ4oRCownrJsnWTMrL842PNdNlxFNNDRSubydPntTIyIhOnTqlgwcPanx8XHl5edq+fbtWrFjh9PCQRsQEcUzXTK7mNFd//5iKi2+Ju4w4GPyL3O6bk15WjLnjiSeeiHt85513yu/3a9myZQ6NCJlCTGCbGpGZzPQN/2pmEUNDF1Ve/gP7cU/Pf8Xtt7PzzDWNB9eP0tJSFRcX63e/+50k6cyZMzpz5ozC4bA2bdqkzZs367777nN4lEgHYoKUmW39w+2+WZL07rsX1NEx+ZNqT89/qa3tC1nWP0+BNDbeqZaWUwoEhriaa4557bXXJE1ewTUyMqLPP/9cp06dUm9vr9566y299957ampq0saNGx0eKVKNmCBthocvxd2Y2Nz8I/X3j6myMl8+33wND1+y12L8/o+T7iMY/AuL9HNQQUGBCgoKVFZWJkmqq6vT/v37dfToUe3evVt+v5+74bNMTjQajabzALHryqf+5Akgu8R+GLAsa8bX7d69W729vfrpT3+q559/PhNDQ4ZwnR6AjHnqqac0f/58HTp0SH/84x+dHg5SiJgAyJjCwkJt2bJFknT8+HGHR4NUIiYAMmrp0qWS/vnhj8gOxARARhUXF0uSRkcTP1QUcxcxAZBRRUVFkohJtiEmADKKmUl2IiYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABhLe0zuuOMOSdLf/vaPdB8KgAMikW8lSYsWLXJ4JHBS2mOycOFCSdJnn11K96EAOOD06ckfFF0ul8MjgZPSHpO1a9dKkl588UsNDPxd4+MT6T4kgAwYH5/QwMDftWfPF5Kk9evXOzwiOCknGo1G03mAiYkJNTQ06OTJk+k8DAAHLV68WN3d3crLy7uq1/v9fkmSZVnpHBYyKO0zk9zcXIVCIW3btk133303U2EgS7hcLi1dulRbt269ppAgO6V9ZoIbDz91YjZ8jWQfLg0GABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIg426//XZJ0vnz5x0eCVKFmADIuPz8fEnS5cuXHR4JUoWYAMi4ZcuWSZIGBgYcHglShZgAyLi1a9dKko4cOeLwSJAqxARAxq1bt04FBQU6ceKE3n777ZTss6enRy0tLXHb/H6/hoeHp33P8PCwAoFAwja/3z/tezo7O9XZ2Zn0uUAgMOPxkunp6ZHf71cwGLym911v5jk9AAA3nvnz5+u5555Tc3Ozdu/erXnz5mnTpk1G+xwaGlJ5eXnctvb2dr3wwgvq6uqK297S0qJwOGw/jsWju7tbr776aty2hoYGNTY22q9tbGxUIBBQJBJRa2urvb2zs1OVlZXy+XxxxwoEAhodHZ123DU1NbIs61r+qtelnGg0GnV6EMgusX+E2fAPBOm1b98+vfbaa5KklStXavv27SotLf1e+/L7/WpublZbW9uMr6uqqrLjMjw8rJ07d6qvr0/S5CxhaGjIjoTf71d3d3dCIIaHh1VXV2c/19/fr127ds36Nd/Z2alQKKT29nb7VF+2ICZIOWKCa3Hw4EHt27dP3377rSTJ6/Vq3bp1uvfee+X1elVQUCCXyyWXyzXtPq6MQEwsMLW1tXHbYzG40tTQtLS0qLy8PO69wWBQx48fn/Xv5PF47EBJsmNz5SxHkn2aberr5yJigpQjJrhW58+fVygU0jvvvKOxsbFpXzfd11QgEFBlZWVcTGKnsqZ+Aw8EAuro6JAk7dy5Ux0dHXG/NzU1adeuXQn7n2kmEQgEZgxBbDYynWSxm4tYgAfguLy8PC1YsGDG2cd0ki2G9/T0aHBwUN3d3RoaGpI0GZfKyspZ91dVVSXLsuxfVVVV1zymqRobG+P219zcLGkyUJZlqaKiwmj/1wsW4AE4qre3V/v379f4+Lgkye12a926dSopKZHX69XixYslScXFxUnfH4lEVF9fb0ejv79fbW1tam5uls/n09mzZ+0rpaaulYyOjtqnuurq6uTxeOL2e+WMY6YZRrKrv2pqauJmSrFTZFMX3Pv7+7Vnzx7V19fP+dkJMQHgmDfffFN79+6VJJWVlWnbtm1auXLlNe2jtbVVPT09kiZnJG1tbaqpqbGff+SRRzQ0NJRwRZfH41FlZaUGBwft01wzaWxsTFjviAUm2SJ9zJVXjoXD4bjHktTW1pZ0zWcu4TQXAEd88MEH2rt3r3Jzc7Vjxw6FQqFrDslUkUhEr7zySsK6SmNjY8Kiuc/nU319vQYHB+0ZSlNTk/381dwrMjw8rFAoJMuyZgxRa2tr3Gmu2Kmz2Gmu2K9IJGJHcS4iJgAy7tKlS9q9e7ck6ZlnntETTzxhvE+32z3tQnhzc3PcTYGxU2EdHR3yeDyyLEt79uxRUVGRurq6dPToUfu1XV1dCYvvsavB2tvbJUkdHR0z3ugYuxHyykj19PTYV3N1dXXN6VNdxARAxr3//vuKRCIqKyvTY489lrbjBINBBYNB1dbWyu1220F5/fXXE2YwfX198vl89qmrpqYm+f3+hLvqA4GA6urqZFmWHRmfzyfLspLeyd7Z2Rl3T8pUFRUVqq+vl9/vn/au+rmCNRMAGdff3y9JevTRR9Oy/8HBQYXD4bhLeltbW9XS0qJgMJiwfhIbU+xekFhoLMuy3+N2uxP2eSXLsuyPR6mqqpLb7VYkErH3N3X2EhuDz+dTbW2tPUO5cl1mruA+E6Qc95lgNlu2bNHp06d16NAheb1ep4eDFOA0F4CMu3jxoqTJz+hCdiAmADLuq6++kiQVFhY6PBKkCjEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAAGN8ajCMbNy4UZFIJOlzUz8htaysbNr/8hTA3MfMBEY2btx4Va8rKSlJ80gAOImYwEh1dbUk6aabZv5SKi8vz8RwADiEmMBIdXW1qqur9d133yV9Pjc3V7fccgsxAbIcMYGx2OwkmYmJCd1///266667MjgiAJlGTGCsurpat912m3JycpI+z6wEyH7EBMaWL1+uBx54QNFoVMn+F+iysjIHRgUgk4gJUiJ2qis2O4lFpaSkhJgANwBigpSoqanRzTffbD+OReWee+7RggULnBoWgAwhJkgJl8ulNWvWJGxftWqVA6MBkGnEBCmzadMm+8+x01yrV692ajgAMoiYIGVWr14tl8slafI0V2lpqQoLCx0eFYBMICZImby8PG3YsMF+zKwEuHEQE6RUTU2N/WfWS4AbBzFBSq1YscL+M5cEAzeOjHwE/cTEhHp7exUOhzUyMqKxsbFMHBYOycnJUTQanfFjVjD3FRQUyOv1asOGDXr88ceVm5vr9JDgoJxosluWU2hiYkLbtm2TZVnpPAwAB5WWlioUCl11UGL/1w3fF7JH2mcmvb29sixLtxXeplU7Vsm72qtbC25N92HhsIlvJ5Sbx0+q2ewfY//Q2Y/P6qMXP9LJkyd14MABbd261elhwSFpXzMJh8OSpFU7VumujXcRkhsEIcl+txbcqiU/WaIfP/djSdKxY8ccHhGclPaYXLhwQZK0aPmidB8KgAN+uOSHksRa6A0u7TH58ssvJUkLSvh8JiAb5XvyJUmRSMThkcBJXBoMADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAMurcuXOSJI/H4/BIkErEBEBGxWLidrsdHglSiZgAyChmJtmJmADIqC+++EKStGjRIodHglQiJgAyZmxsTAcPHpQk+f1+h0eDVJrn9ABwfTvWckzucreW1y6f9jVvBN5QRX2Fltcu17GWY/os/FnS1xVVFWlz12b7PRdHL856/HxPvn7R94vvN3hcd7q6ujQ+Pq5AIKA1a9Y4PRykEDGBsV/0/UKHg4clSQ+1PqSHWh9KeM3p/tMaen0obtvPu3+uQl/htPs9P3xe7+58N7WDhSM+/fRTHTlyRH19fSoqKtLmzZt1002cGMkmxARGYjOX2IzjWvTW9c76mnxP/vcZFhw2Pj6ukZERjYyM6NSpUzp48KDGx8eVl5en7du3a8WKFU4PESlGTGAb6BzQidCJhO2fhT/Th20fxm17sPnBhFNfh4OHde74ubhtU09tXYmZSfZat25dwrZAIKDNmzcTkixFTBCnoqFCKxtX2o+TrZkcazk27fsfbn9Yi9culpT81Na1KPQVsl4yR7lcLnm9XhUXF6uoqEh+v18//vGPnR4W0oiYIKWO7joa97ioqmjG1yebzUyVbAaE69/777/v9BCQYcQEKXUtM5NCX+H3WmsBcP0hJohzInQiYd0k2ZqJu9z8ozBmuox4qqmBAnB9IiaIY7pmcjWnuU73n5ar2BV3GfHh4GHlu/OTXlYM4PpHTGCbGpGZzPQN/2pmEZGhSNzM5s89f47b70DnwDWNB4DzuGsIKbO5a/OMIcl3T94z8vm7n2vZw8skTYbkw7YP49ZOVjau1DeRb/RG4I30DhhAyjAzQdqcHz4fd2Pig80P6nT/aRVVFqnQV6jzw+fttZiX/C8l3cfh4GEW6YE5ICcajUbTeYDYh7k9bT2dzsMAcFDshwHLshweCZzCaS4AgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjBETAIAxYgIAMEZMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjaY/JHXfcIUka+9tYug8FwAHfRL6RJC1atMjhkcBJaY/JwoULJUkXPruQ7kMBcMDXp7+WJLlcLodHAlEd8xQAAAD2SURBVCelPSZr166VJH304kc6M3BGl8cvp/uQADLg8vhlnRk4oz/s+YMkaf369Q6PCE7KiUaj0XQeYGJiQg0NDTp58mQ6DwPAQYsXL1Z3d7fy8vKcHgockvaYSJNBOXDggI4dO6azZ89qfHw83YcEkGYul0uLFi3S+vXr9eSTTxKSG1xGYgIAyG5cGgwAMEZMAADGiAkAwBgxAQAYIyYAAGPEBABgjJgAAIwREwCAMWICADBGTAAAxogJAMAYMQEAGCMmAABjxAQAYIyYAACMERMAgDFiAgAwRkwAAMaICQDAGDEBABgjJgAAY8QEAGCMmAAAjP0/1cc2ZdMMYP8AAAAASUVORK5CYII="},1919:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005842986.479b8a07.png"},1920:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005850439.ac157895.png"},1921:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005906856.ee2ec203.png"},1922:function(t,s,a){t.exports=a.p+"assets/img/image-20200426005952009.0324a3c7.png"},1923:function(t,s,a){t.exports=a.p+"assets/img/image-20200426010013779.aa3400bb.png"},1924:function(t,s,a){t.exports=a.p+"assets/img/image-20200426010030011.e80c6d78.png"},1925:function(t,s,a){t.exports=a.p+"assets/img/image-20200426010041088.b624c7dc.png"},1926:function(t,s,a){t.exports=a.p+"assets/img/image-20200426010052043.594dfdba.png"},1927:function(t,s,a){t.exports=a.p+"assets/img/image-20200520163606933.d7fe072e.png"},1928:function(t,s,a){t.exports=a.p+"assets/img/image-20200520163622841.5e366753.png"},1929:function(t,s,a){t.exports=a.p+"assets/img/image-20200520163703746.d6c5741e.png"},1930:function(t,s,a){t.exports=a.p+"assets/img/image-20200520164434735.f18fe29d.png"},1931:function(t,s,a){t.exports=a.p+"assets/img/image-20200520164504586.3a996b54.png"},1932:function(t,s,a){t.exports=a.p+"assets/img/image-20200520165057110.c1bd6527.png"},1933:function(t,s,a){t.exports=a.p+"assets/img/image-20200520165553364.6793375d.png"},1934:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180103088.5a33b18f.png"},1935:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180111291.76b24595.png"},1936:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180120650.c68e92f9.png"},1937:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180128773.707a7f9f.png"},1938:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180205807.af81e8e0.png"},1939:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180213999.972ff5f6.png"},1940:function(t,s,a){t.exports=a.p+"assets/img/image-20200520180219573.8ee368b0.png"},1941:function(t,s,a){t.exports=a.p+"assets/img/clip_image002-1589972438366.1a6e4e15.png"},1942:function(t,s,a){t.exports=a.p+"assets/img/clip_image002-1589973691401.59eac2f8.png"},1943:function(t,s,a){t.exports=a.p+"assets/img/clip_image010-1589973691401.a120d536.jpg"},1944:function(t,s,a){t.exports=a.p+"assets/img/clip_image012-1589973691401.ca1ef9a1.jpg"},1945:function(t,s,a){t.exports=a.p+"assets/img/clip_image014.5331ff2b.png"},1946:function(t,s,a){t.exports=a.p+"assets/img/clip_image016.c75aafcc.png"},1947:function(t,s,a){t.exports=a.p+"assets/img/clip_image018-1589973691402.6617875f.png"},1948:function(t,s,a){t.exports=a.p+"assets/img/clip_image020.7bbc2453.png"},1949:function(t,s,a){t.exports=a.p+"assets/img/clip_image022.9c0de0e3.png"},1950:function(t,s,a){t.exports=a.p+"assets/img/clip_image024-1589973691402.e062b578.png"},1951:function(t,s,a){t.exports=a.p+"assets/img/clip_image026-1589973691402.d7814f53.png"},1952:function(t,s,a){t.exports=a.p+"assets/img/clip_image002.b7ac9818.jpg"},1953:function(t,s,a){t.exports=a.p+"assets/img/clip_image004-1589975572673.e9cdde0d.png"},1954:function(t,s,a){t.exports=a.p+"assets/img/clip_image006-1589975572674.b36d82a3.png"},1955:function(t,s,a){t.exports=a.p+"assets/img/clip_image008-1589975572674.78442edf.png"},1956:function(t,s,a){t.exports=a.p+"assets/img/clip_image010.6b109cb1.png"},1957:function(t,s,a){t.exports=a.p+"assets/img/clip_image012.c311999e.png"},1958:function(t,s,a){t.exports=a.p+"assets/img/clip_image014-1589975572674.82cd6a7f.png"},1959:function(t,s,a){t.exports=a.p+"assets/img/clip_image016-1589975572674.19262877.png"},1960:function(t,s,a){t.exports=a.p+"assets/img/clip_image018-1589975572674.c43c6539.png"},1961:function(t,s,a){t.exports=a.p+"assets/img/clip_image020-1589975572674.4a340cec.png"},1962:function(t,s,a){t.exports=a.p+"assets/img/clip_image002-1589987318431.5da12052.jpg"},1963:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjMAAACkCAYAAABirq8QAAAcwElEQVR4nO3du07j2tvH8S+v/rdg+QZgCgv5AkJhIZQi0OzKQmmmC1VkmqkmZbppiFIl3TQRSrWbDUWEUAq4AAu5mMkNWL4I3iI25OCEHIgTh99HmmLIilnBj53H63jAz5+viIiIiOTU/227AiIiIiLrUDIjIiIiuaZkRkRERHJNyYyIiIjkmpIZERERybU5yYzNXb3O36KZXW1EFqb4lHUofuQr27X4X78+apkRERGRXFMyIyIiIrmmZEZERERy7SBZAbhQ9HhyjI/fEfU5afR4Bob9XC6lmYUDrmod2m//V3mVX6284lPlFT8qr/L7Ef+r1Wc+tcyIiIhIrh3M3ptpmGUd9Zsc9cJsayXyIcWnrEPxI1/ZrsX/+vVRy4yIiIjkmpIZERERyTUlMyIiIpJrSmZEREQk1+YMABYRERHZfWqZERERkVxTMiMiIiK5pmRGREREck3JjIiIiOTa/+a9WCnXadHloONnVZ8RyT4Pk/s/7DG7zKtrTf882Mw5qJTrtKwVjx/XdbDFFSS3G58ryPj8yny5i59NU3x+KfsW/2qZERERkVyb2zIjGfM7HIwmyWaRv1WHww39unan9jVavHZFxudXtmXTrcobOr7iU3JMLTMiIiKSa1tpmSnYRWqnFiXDePvZIIr4GzxS7/k8p76nzO9Ti8P4LYOgy/dOSlnT5ubslAvLeH+iiCIaj7dc+6NjO8afbl4+PP6y5Sc/r0Mp+bhRQOO2w3XWQ01m9Il/NO5l/G8fcd+/5XwXNlr9dPPPMVGfk0Zv6hxPxiZRxH1wy/knjSXadPwUimV+WyP1J2IQRfz3+DBxzSxXn7ljsnZgzNVne/u8byxa9Tqt0R+l/C0WjZ+Vjr/w/XDTJq6tYpnfjhXXKeK+e8v5jPosHv8rXr9Lx/8i52v17wtZTeYtM4Wix5PrjCUyAIeGQck55jjlPVbR48kdDTY4tFx+F82JkjZ3VRdv9MIFMAw895KbyeJLH3/58u+fd7Q+Fl61zp2dXp9dUpj6rAYlp5o+UHCPpJ3jNJVySjkj/huV1z/Bm46fSrnOkzP5OQ0ODQvveL14bne63ANY7sRrNneuBVGf73uSyKxqs/Gz2v1w0/5JYu69QpTcamo8rxr/i1+/y8X/Kudr2e8XWU22LTN2mSdneEYH/S7fR1phCqbJsW3yMvUmC88ZL18oejw5BoeWTaE3nmn/Cfr8++DTDuObpDm8oEsYXNgm11M3z+WOv1T55PNGAVe3Hdrxry7YZZ5ci9JpkYI//aSwMRN94km9Z7OpvZ2v5AnapFI848fYzWjfTJ/jSrlOa/JPZZdpWQYQ0ei+P+kW7DK/XYtDy+XO9jlfdbLAxuPH5h+LYf2bjZEnXZOCaeKaE9fK0vXxOe8e8+palFyPm3D4OypllxIRjdsMYz8D72PQFhzTsmT8LH18VrkfbppFyRptiTGplKu0LKbjZ+X4X/D6XSH+l7/el/1+kVVl2jJTOR4+zQ+/GMeb2J7DkPaMLqb7bm2s/HPvcfjEN8XnutN7v3ABQp96P5pbr8WPv1z54eeNaIxciADP/gONCDCM1JaoXVEonlICCLojXQEh7V6Ho26wxZpt3uQ5bndqHEw0USfxfN9tjDVHP/sdvscxVzotUlixDpnGjzn6lBjyHPpTTewr1cfvcNKPAAPvskjFLtOyYNC/zb6bdcdsOn5WvR9u1jBxeO9SCt9b8AwLdyQM14n/Ra7fMQvH//Lna9nvF1lNhi0zSRYc8Gupp4GAfzc6DX7Z4y9aPvm8Bl61jpdaxsAygR29qR/HXYH3L/uxDsHiFjnHJpYxu+yzHzBwHA7jG+7yT19ZxI9PvX9KyTHw3CreacT9zHFrq9fnuXdLw6riGQ4tF3UvAZuPn10VEUyd+pA/EZQMg29v8bNO/C96j14m/lc9X5v+/pLE/k3NNk0qZ5f8MIwP+0tlnuTilXQm3+b9fcKQv7DzXXHPvQYnYTLA0qDkuJQcd6ppfz0h148BF+6wa/L+UU3rmcWP7odzLR7/+3G977P9SmbsMn9dC4I+v27f+4k/HhuySXldwTgkGPYOSKrkaXLGy6bJ0af8ns3Hz7Pf49zvASYF+yyedWHRqpZh6nevUh+Tm9P3MVYlt0zFz+M18ZkyiJ+dvB/OE/EnpZVlN+I/q+tdVpXhmBmffwMAix8bGcWd3DADfk32E2/FMPjB4p8czFqa58hMmdXy5Qfix8nejPNbsOMv7yhKGdS+2PGzj5+QZ7/DUaM5HJOQNOOvWZ9KuYpnwH23yVV8D2h9wkyvfNt0/Oza/XAO0+YiXvbhvQtq9+J/s+dL1pXpAOD2y3DQ6KFT5W/ZHv9CNE0qxSKVlb8kk2ZAi3/s94MU7CK1uL/k0MjyG3jYtA5Qcj3ubHN8YNjan3fz3s/X6DROczg90dnvqdmLSP4+JdfjZizmyvyOn3xX71LJIH7sMn/LRW4mjl2wky+XT6hPPOCXoMu5H86Zrr1PRr+IZ5+g1eNnkePv2v0wYdHyyu9xYtrcXcarDAcvIy0wuxb/m77eZV3ZdjP5HU7MZFqay5PlThSIaPi9VQ/Ov4FLyYKSW+V19NBR3F9iubzWTyem4W2Q3+Hq2KNlDddRKE1+3LU+bwb8BxqnFp4xOQgvotEP8L56QjNyfj23ijd5foPu6tOyJ46/qfg5tBw8y5muO0DwOH6dLF2feD0ZAq7eFnJLn669X967aKfvRSMLt60cP4scfwfvhwnDolWdWOxvLEZiOxz/G7neZS2ZL5r33Gtw0uxyH01MD4wi7vuPdNe4qNqdJlfByHGjiPtuk4NGg6tkOmIUkeWk4nanwUm3P/V5B1EwXKtgp2/kIdeNJo2xv2nAVdY3vx02PL8Bg9HTG0Xc95ufshvtRuPH77wdezD68+S6San/MvV5W0+mOTHmYWK69upTj3dXci8a+7sSMYjCiXKrxc8ix9/F+yEEXDW73I9UaxD0OZkxLmY3439z17us7oCfP19nvbhvW4Tvj2TRrEXldRDyfIrPhOJhFYqfVa0Sby/8s9HNN2VZ+xb/2mhSREREcm2/pmZ/GT7ntf3IpuUzKB4kS6vEm80/G6mLyNDcbiYREZH1Lb6flMgqlMyIiIhIrmnMjIiIiOSakhkRERHJNSUzIiIikmtKZkRERCTX5iQzNnf1On83simkyLoUn7IOxY98ZbsW/+vXRy0zIiIikmtKZkRERCTXlMyIiIhIrr0tmlcoejw5xsfvGN3C/sMNxyZXe1R5lV+tvOJT5RU/Kq/y+xH/q9VnPrXMiIiISK7N2c5gmGUd9Zsc9cJsayXyIcWnrEPxI1/ZrsX/+vVRy4yIiIjkmpIZERERyTUlMyIiIpJrSmZEREQk1+YMABYRERHZfWqZERERkVxTMiMiIiK5pmRGREREck3JjIiIiOTa3GSmUq7zWrazqovIUhSfsg7Fj3xl+xb//9vabzZtbuxjLhz4NbZZlciWmUXuLh1K8T5ogyjg122H9i6s+i07zqRSvuSHZXAIQMQgeOR7x19oszzsMq+uNXuDPdPm5uwUz3rfpG8Q9Pn10EuPz2XLz/wMwQfvEdmuTJOZgmnjnp1y8XaRAARZVkFkvuTLZMShYdGqeljNBte6mctMJjdeFW9sM2CDQ8vlyTM/3v3XLPJ3IvbG2dxVp3clPrQcWpYBUw+Fy5aP3zO187HBoeXwI/Jp78Q+PiLTMhwzY+JennJhRPzX73LS7HKf3S8XWYDNXfxlMuh3OanVOKg1uepHgIF3WaSw3QrKDisUL4eJTNTnqlnjoFbjoNnlPgIMh99Fc867TW4unZGHvBmigEa3OTx2fPxGBGDRSusyWKq8yY0XJzJR8P4ZajVOun3+Ux4jOyzDZCbkutHgqNHhuufzrAtDdkyheDq8kQddjnpJt0BIu9fgKgAMh9r+dDHLpzJxLQOIaNyOdMeEPue3fQbAoWXPTIaHiVBEY+5Dns95o8O1P3LzDH2u4+NjmBPHX7K8ffaWjJ00xrtVn/3e+HFEdoxmM4nEjo1h/8D9iz/1Wvtl2B16ZM57upavy+SbARARTH7nhz7/RYBh4aaFj13myTG4767ZjRmFi43LmVG+cjxslbx//KA7TGQHbW8AsMhOMbHiL6M/aV8oYTR8ujZMQE+oMouBNRUiSaKTZti1Oeg3OZ/OoRdSORt2T6Ul4YuXH4//QrHMb8cadntFAY3HB7XMyE5Ty4wIMP8LZ8RUU74IgM+/ASRjqypJC4xpc+PF3ZcYfJtomamUXUpRn+8rDqwt2GVaFgyC7kLJ0Ozy7y1L2B5PSSIDYFh4bpU7dbHKDlMyIyLyCdqdeLyL4dCq1nmt13mtunjR43DM1SS7TMsKuPpoltMMhaLHU9yqc9T5OJNZrLyFZ0Ujg3+TAfBQcstUVqinSBaUzIgAEPInWqDYsuMS5AvxOW92aQTvgTQIupx0wukuzLdp2Batepz41Ou8JtOiDYenep1XL30GXaHoxeNsmhwt0KqzTPn7x9HBvyHt3u3bDKh/1DojO0pjZkQACAkiwIi7Aibv9+ZwbaRBpHEDMkfoc93xuR79mVnk96zBwSsYTUzOFxjHslj5YTJfMtLGjCXXxpoVF9kgJTMisZdoeMcuHdvgjzfDJzM9/oZKZmQ5yYBbgpf3RerCHke1XkrpeNG6WSsAxzOfCLoLJTKLl/8gmQdmDo4X2QHqZhKJPfceh2MeLJe/bwucmVSKHi0LiPrUV5xxIl+AaXNTHF1LxqRSjmOHiMbDusGTLOoYcLXAGJlly7cfhuvPlFyPGzst/gO6SmZkR2XYMpO21Dckfcat5L+znkhENs7nvHvMq2tx6FR5dUZfGy6GpriU2UwuHAfPcadeWXsNGQD7OJ4VNXHPTARdDkaTlmXLhz2+9y2eHAPPreKNfQzFv+w2tcyIjPI7HDT7wyXoY4Mo4Er7MslHQp9f/YDBVOzUVl5DJmvPvQYn3bTPoPiX3ZZhy0zIdaM2PjBOZBeFPc4baeMZROYJafc6tNcKHZ/z2ozMx+9wsExStGz52LPf4SgnyZdIQi0zIiIikmtKZkRERCTXDvj583XblRARERFZlVpmREREJNfmJjOVcp3Xstavlt2k+JR1KH7kK9u3+N/eCsCmzY19zIUDv2qd95UxRXaB4lOWFq/eO6/I2Dpamy4Pw4X7LvlhGfEu2BGD4JHvHT99zRjT5ubsFM96XxBsEPT59dAb2a9JZPdkmswUTBv37JSLtwsLIG07WZHsKT5lv6QtVGpwaLk8eWbK4qQ2d9XpZOnQcmhZBiiplx2W6QrA7uUpF0T813+k60Mt5cIR2Q7Fp6xrzhoxdplX1+L+cTSB2Gz5QvFymMhEfa5u45YV0+bu0qVkOPwu+tM7aEcBjccHrpN9nEybm0sXz7BolW3aC22jIJK9jBfNa4wsmrc/fXWyDxSfsinxHklBd8GVgD+jvIlrGSTbELx1EYU+57cmf6sOh5ZNoTeRLDUmfmHoc31rclF1ODRMCqAtDWQnaTaTiMgGFYqnlBbeHPKzypt8MwAigsmxLqHPfxFgWLgmi4tCJTKys5TMiIhsilnkt2Nw311wvMmnlzewphKWJNFZTOXM4RC4f1EXk+wuJTMiIhthcnPpcBj1qS+UB3xmeZ9/AwAD77JIJUloTJsb7zQeC2bw7YOWmYJdpmXBYOEuL5HtUDIjIrIJ9hmewcQg3uzKtztd7gEMh1a1zmu9zmvVxYseuVpgkl6h6PHkWgz6TY408Fd2nJIZEZFPFw/KXbiVZRPlfc6bXRpB9PaTQdDlpBNixeNp/sxYO6ZQ9HhyDO67zekZTyI7aHuL5omI7KnhoNzFW1k2Vj70ue74I7P0GI6zmTU4mPFE5txXIiP5oJYZEZFPZVNzjKVaWTZbflwyoJfgZXrQsF3myTHiad5KZCQ/lMyIiHyipNVkEMzYMiCr8qbNTdGm8P4DKmWPlgUQ0XiYzITirqslpoWL7IpMVwCeXlobwKJVr9NK/ju1t4hIFhSf8hneF6v7b6GWjU2WN7lwHDzHnXrlvtvgevLt9nE8y2ki5hNBlwMlObKj1DIjIvJZTJsLA4gCugvlJhssH/r86gcM3sf/MogCrpo1TbOWvZPxdga18YFoIjtD8SmfIOxxVOvtSPmQdq9De9HifocDJTmSU2qZERERkVxTMiMiIiK5dsDPn6/broSIiIjIqtQyIyIiIrk2N5mplOu8lu2s6iKyFMWnrEPxI1/ZvsV/9tsZmDY3Z6d41vuCHoOgz6+HHm0tOCm7wCxyd+lQikN0EAX8uu0oPmUBJpXiGT8ca7jKLkAU0Hh84HqRdWTsMq/xnkuz1zMyqZQv+WEZ8e+IGATBnHvosuVF8ifjbiabu6o7lsgAHFoOrWqZSraVEZlml3mtvicyAIeGRavqcWNur1qSD5VyldZoIgNgWHhulbuPHoLNIn9d64NCNnf1Kq23xATA4NBy+GGnBeiy5UXyKfuWmcmnFNPm5tLFMyxaZZu2VpiUrUmWc4dBv8v3ns8zJpXiJS3HwLss0tXqvzKLWeSHBRBw1Uxa8sxhgmPBkWkCs5pCTG4unfEkKK2M5w5X6Y0CrkZaCwt2kel1fpctL5JfGbfM+Jw3OuPNraHP9W2fAYBhjuwjIpKtZM8bgi5HvWTfm5B2r8FVABgOtf3pYpbPZhrvGzi+3eJC2g/x/W2OQvESz4hoNLvczypknw2324j6nDTGuz2f/d50N9ay5UVybLdmM0Whnnpla46NYd/S/ct062D7JQCSp2uRFP7LMBGxXO5GunAKtsXhvL2U4p2qU/dLGlE5HrYa3j8u1jq4bHmRPMu+mylFsiV92peISDZMhkO5Iv6kfaGEEQPg0JjXVSBfm89595hX16LkVvl73OVXdErLmbGxI5B0bQ76zQ/2SxqPz0KxzO9kbE7qAONly4vk29ZbZgp2mZYFg6Crzc9ki0y+Te2YnUJdoTKP3+EqGO7seGi5tByDQf9x5r2tUnYpRX2+9z7eAftbnJxgezyNDjJOHWC8bHmRfNtqMlMoejzFTyVHGvgrIrlmcuPVaVnQ6Da5CuLWPMfl1StOJ8F2mZYVcLXUoHILz4q4atY4qNU4qDW56g+Tp5KbNiN02fIi+bS1ZKZQ9OJ+4iZHHz6ViGxayJ9ogWIa1yUzDAfxxl1Kfki70+Co2eU+AgyHp9EFyt6mYVu06nVe3/7Fs48Mh6d6PTUJun/sjA8w7t3SiAAs/klpbVm2vEgebSWZGU1kztVvKzshZNg7YPAtbYxvPFNlECleJY1NzTGAgH9HG5lDn/NGPEPJOl1jraIk2U4b05XE7jrlRfIt+wHA8ch9gq4SGdkpL1EEGJSObfDHuz2TmSF/Q8WsLGuYWIwuxEjY46jWSylrc1cfjqMZXwE4TkCMONlODcPRxGXZ8iL5lv0KwK4FBFxpjIzsmOfe49vU2r/F5BHapFL0aFlA1KeusJVUSUuIRcsrUnlrgTEpFJP1XgK6ayQPyXo1Jdfjxk6Lz/HjL1teJM+ybZmxj4f9wXE/cWvy9aDLgZIc2Zr3qbWHTpVXZ/S1iMat1uuQWUKub/tcVB0ODYdW1Zm4v0Xrr/cS9vjet3hyDDy3ije2hG9KfC5bXiTHtj41W2Sn+B0Omv3hoM3YIAq4as5f0EyEsBcP+B0fkDII+lw1G5+y9MRzr8FJN2CwYHwuW14kr7JtmfE7HKjhRXZd2OO8kTaeQeQDoc95Y52bnM95bf77n/0OR0v8imXLi+SRWmZEREQk15TMiIiISK4d8PPn67YrISIiIrIqtcyIiIhIrs1NZirlOq9lrXctu0nxKetQ/MhXtm/xn/0KwKbNzdkpnvW+HOYg6PProTeyf4jIlpk2N/YxFw78qnVob7s+kk92mVfXgqkVfUeZVMqX/LCMeGfriEEQzLgnppV95HvHn3HseEXhtJe0rpfskYyTGZu76vSFdWg5tCwD9KUhW1QwbdyzUy7evigAgi3WSHLtbTPJedKSDYNDy+FH5NMe24TX5MarDlcTHivr8uSZc5Ilkf2XfctMFNB4fOA62ZfJtLm5dPEMi1bZpq0nBdkKE/fylAsi/us/0vWhlpJ4iyzG5ObSGUmKZ5Tx4hiLAq5u33e3LthF3InSya7cRH2ubuNWG9Pm7tKlZDj8Lvoc9WY0b6sVRvZcxslMyoJSoc/1rRkvA25SAD1dyBaEXDcaXL/9f3/6kiV7w8QjotF85NuspNg+e0tOJltVnv3JVhYT1zJItiF4634Kfc5vTf5WHQ4tm0JPrTPyNe3WbKYo1IUoIvlml3lyDO6787cMSHZiX2zPJpNvBkBEMHnM0Oe/CDAsXHP6nSJfQfbdTCkqZ8Pm2PsXNYOKSJ7Z3LkWg37zg72YTKw4OfkTQqFY5rdjDbulJrvixxhYJhCOH+ubkVJU5AvZestMwS7TsmAQdD9lIzYRkW2plF1KUZ/vs8auvHlvacH2eEoSGQDDwnOr3I31dPr8GwAYeJdFKkkLjGlz453G3VgG32a1zFgur/U6r57HXdGmsMqHE9lhW01mCkWPp/gp5kiD00Qkz+wyLSvgaqlZRRaeFXHVrHFQq3FQa3LVH25xXXLLVEZKtjtd7gEMh1a1PkxOqi5e9MjVopPuDIOS4/LkjR9bJO+21s1UKHpxv3KT89TmVBGRnBiZht2q12lNvm44PNWd1MG+94+dkfVkQtq9WyyrimdY/GND++05z+e8ydg6XYOgy/dOiOtB0mU1bnQXbpOCaVK7dClp9qjsma0kM0pkRORrC/kTQclIS0BCgghIGwcT+lx3/JFZd4BZ5PeswcETx30OQ84bDNe2sY6p4GttL9kL2Scz8Uh/gq4SGRHZD2GPo1ov5YV4UbypFpkkYYnHuaTeCtMSnWnJBAqCFyUm8mVlPGZmONIfAq7UvCkiX1j7oc8AKLkeN/bbiF4qRY+WBUQB3bEFgG1uxgbvmlTKcVkiGg8p91TT5sY2399j2iML9UW8fPqnEtmObFtm7ON41L2V3q+sVSpla9KWioepWJ27x47IEsIe3/sWT46B51bxxpb8HS6ON7lw3oXj4DmTawMze00b8xjPdSeOPev4Ivm19anZIiJf1XOvwUk3YBC9/2wQBVw1U5KT0OdXP61sbfayFuELjWDkDUQMgn768UVyLNuWGb/DgRpeZCeFXDdq4wMrRdY2Opso3bPf4Wih+2JIu9ehnTY0Z+ZbUgYMi+whtcyIiIhIrimZERERkVw74OfP121XQkRERGRVapkRERGRXFMyIyIiIrmmZEZERERyTcmMiIiI5JqSGREREcm1OcmMzV29zt+iObuIyNYoPmUdih/5ynYt/tevj1pmREREJNeUzIiIiEiuKZkRERGRXHtbAbhQ9HhyjI/fEfU5aSRbx9vc1V1KMwsHXNU6tN/+r/Iqv1p5xafKK35UXuX3I/5Xq898apkRERGRXJuzN9MwyzrqNznqhdnWSuRDik9Zh+JHvrJdi//166OWGREREck1JTMiIiKSa0pmREREJNeUzIiIiEiuzRkALCIiIrL71DIjIiIiuaZkRkRERHJNyYyIiIjkmpIZERERybX/bbsCsga7zKtrTf886HLQ8bOvzzbFf4vBRla0NKkUz/hhWRxGX/BvK9n7hHiulOu0jIj74JF6z19ofxuRvPo4mUm+MJfY8Elkb5hF/lYdDpP/R7PK2dzYx1w48Gts87WUcmeneNb7JmuDoM+vhx7tz8jBVjq+SaV8yQ/LiD9nxCAIZrwnTuwca+RvEtB4fODa34Vl0WWMYVByXErOKY1mg2udItlT/w9bhgSSnboL8gAAAABJRU5ErkJggg=="},1964:function(t,s,a){t.exports=a.p+"assets/img/clip_image002-1589989837287.b942818b.png"},2024:function(t,s,a){"use strict";a.r(s);var n=a(17),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("blockquote",[n("p",[t._v("hadoop\nhdfs namenode  HA   journalnode\nnamenode + secondarynamenode  \nsnnfsimageedits\t\nyarn   CPU  \nmapreduce  \n")]),t._v(" "),n("p",[t._v("zookeeper\n\n")]),t._v(" "),n("p",[t._v("hive\n\n\n\n\n\n + \nhive")]),t._v(" "),n("p",[t._v("HBasenosql  \nrowkeynamespace\nrowkey")]),t._v(" "),n("p",[t._v("ETL\nsqoop\nflume\nsourcesink\n\nflume\nazkaban\nimpala + hue + oozie")]),t._v(" "),n("p",[t._v("kafka\n\n\nbroker\noffset\n\nkeyhashCode\nISR,LEO,HW\n")]),t._v(" "),n("p",[t._v("spark\nsparkCore\nsparkSQL sparkSQL  on  hive hivemr\nsparkStreaming\nsparkStreamingkafka  direct +  receiver\noffsetexactly_once")])]),t._v(" "),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("W.H.Inmon Building the Data Warehouse ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("=..")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("ol",[n("li",[t._v("")]),t._v(" "),n("li",[t._v(" ")]),t._v(" "),n("li",[t._v("")])]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("()"),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("-10")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1880),alt:"image-20200425030104111"}})]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1881),alt:"img"}})]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h6",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1882),alt:"img"}})]),t._v(" "),n("h6",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1883),alt:"1-11101519444S20.jpg"}})]),t._v(" "),n("h6",{attrs:{id:"_3-bi"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-bi"}},[t._v("#")]),t._v(" 3BI")]),t._v(" "),n("p",[t._v("BI"),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v(",ETL")]),t._v(" "),n("p",[t._v("OLAP")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1884),alt:"u=663018156,2699099922&fm=23&gp=0.jpg"}})]),t._v(" "),n("h6",{attrs:{id:"_4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("p",[t._v("Knowledge Discovery in Databases, KDD")]),t._v(" "),n("p",[t._v("Jiawei HanWeb")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1885),alt:"img"}})]),t._v(" "),n("h6",{attrs:{id:"_5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5"}},[t._v("#")]),t._v(" 5")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1886),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1887),alt:"img"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("ol",[n("li",[t._v(""),n("strong",[t._v("ETLHDFS")])]),t._v(" "),n("li",[t._v("HDFS"),n("strong",[t._v("Hive")])]),t._v(" "),n("li",[t._v("3/44\n"),n("ol",[n("li",[t._v("ODS\nDWDods"),n("strong",[t._v("")]),t._v("   "),n("strong",[t._v("\nDWSods")]),t._v("**   ** \nADS")])])]),t._v(" "),n("li",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1888),alt:"image-20200425031735191"}})]),t._v(" "),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("3D")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1889),alt:"IMG_256"}})]),t._v(" "),n("p",[t._v("NEXONQQ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("AppStore")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\n**   =\n    **  **  **\n   **> \n")])])]),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1890),alt:""}})]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\n\n\n  1  2   3  4\n\n\n\n\n\n\nods_user_login_2020-03-26\nods_user_login_2020-03-27\n\nidhash\nods_user_login_1\nods_user_login_2\nods_user_login_3\nods_user_login_4\n\n\n\n1. java\n2. linux\n3.   ** hdfs  ** load hiveods\n4. dw\n5. res\n")])])]),n("p",[t._v(""),n("strong",[t._v("3")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1891),alt:"3"}})]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("strong",[t._v(" flume + kafka + ")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v(""),n("strong",[t._v("mysql")]),t._v("sqoop")]),t._v("flume"),n("strong",[t._v("binlog")]),t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("Subject OrientedIntegratedNon-VolatileTime Variant(Decision Making Support)")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1892),alt:""}})]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("mysql")])]),t._v(" "),n("p",[t._v("30"),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("---database")]),t._v(" "),n("p",[t._v("---database")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("Ip")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.101")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201901")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.101")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201902")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.101")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201903")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.101")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201904")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.101")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201905")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.102")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201901")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.102")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201902")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.102")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201903")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.102")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201904")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.102")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201905")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.103")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201901")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.103")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201902")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.103")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201903")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.103")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201904")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.103")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201905")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.104")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201901")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.104")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201902")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.104")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201903")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.104")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201904")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.104")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201905")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.105")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201901")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.105")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201902")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.105")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201903")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.105")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201904")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.105")]),t._v(" "),n("td",[t._v("3306")]),t._v(" "),n("td",[t._v("root")]),t._v(" "),n("td",[t._v("123456")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("rxjjw")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user_login_201905")])])])]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v(" "),n("strong",[t._v(".xlsx")]),t._v(" "),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("idid")]),t._v("123")]),t._v(" "),n("p",[t._v("user_login "),n("code",[t._v("name_2015_1 n_yyyym, name_201501 n_yyyymm, name n")]),t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("p",[n("strong",[t._v("Java")])]),t._v(" "),n("h5",{attrs:{id:"-java-maven"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-java-maven"}},[t._v("#")]),t._v(" Java Maven")]),t._v(" "),n("p",[n("strong",[t._v("Gamedata.zip")]),t._v("")]),t._v(" "),n("p",[t._v("pom.xml")]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xmlns")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://maven.apache.org/POM/4.0.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("xsi")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.w3.org/2001/XMLSchema-instance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xsi:")]),t._v("schemaLocation")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("modelVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.0.0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("modelVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("gamedata"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Gamedata"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("0.0.1-SNAPSHOT"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("packaging")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("jar"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("packaging")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Gamedata"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("http://maven.apache.org"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("properties")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project.build.sourceEncoding")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("UTF-8"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project.build.sourceEncoding")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("properties")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("repositories")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("repository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("aliyun"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("http://maven.aliyun.com/nexus/content/groups/public/"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("repository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("repository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("central"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- This should be at top, it makes maven try the central repo first \n\t\t\t\tand then others and hence faster dep resolution --\x3e")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Maven Repository"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("https://repo1.maven.org/maven2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("releases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("releases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("snapshots")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("false"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("snapshots")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("repository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("repositories")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("pluginRepositories")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("pluginRepository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("aliyun"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("http://maven.aliyun.com/nexus/content/groups/public/"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("pluginRepository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("pluginRepository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("central"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("https://repo1.maven.org/maven2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("releases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("releases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("snapshots")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("false"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("snapshots")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("pluginRepository")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("pluginRepositories")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("junit"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("3.8.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("test"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.jvnet.hudson"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("ganymed-ssh-2"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("build260"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mysql"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mysql-connector-java"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("5.1.32"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- https://mvnrepository.com/artifact/log4j/log4j --\x3e")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("log4j"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("log4j"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.2.17"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("sourceDirectory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("src/main/java"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("sourceDirectory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("testSourceDirectory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("src/main/test"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("testSourceDirectory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("maven-assembly-plugin"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("descriptorRefs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("descriptorRef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("jar-with-dependencies"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("descriptorRef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("descriptorRefs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("archive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("manifest")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("mainClass")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("mainClass")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("manifest")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("archive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("executions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("execution")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("make-assembly"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("phase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("package"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("phase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("goals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("goal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("single"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("goal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("goals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("execution")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("executions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.codehaus.mojo"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("exec-maven-plugin"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.2.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("executions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("execution")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("goals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("goal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("exec"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("goal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("goals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("execution")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("executions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("executable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("java"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("executable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("includeProjectDependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("includeProjectDependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("includePluginDependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("false"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("includePluginDependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("classpathScope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("compile"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("classpathScope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("mainClass")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.gamedata.App"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("mainClass")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.maven.plugins"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("maven-compiler-plugin"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),n("h5",{attrs:{id:"---"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#---"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("strong",[t._v("com.gamedata.data.TaskDataThread")]),t._v("")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gamedata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Connection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DriverManager")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResultSet")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SQLException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Statement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentLinkedQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gamedata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecShell")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * \n * @author hutao\n *\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskDataThread")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n\t *  mysql \n\t */")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentLinkedQueue")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" taskCountQueue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n\t * CountDownLatch\n\t */")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),t._v(" latch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" successUrl "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" failUrl "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" mysqlTable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" fields "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" where "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" shellPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" tmpDataPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" fixTables "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentLinkedQueue")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTaskCountQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" taskCountQueue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTaskCountQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentLinkedQueue")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" taskCountQueue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),t._v(" latch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" fields"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" shellPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" tmpDataPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" fixTables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskCountQueue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taskCountQueue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("latch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" latch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mysqlTable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fields "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fields"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("where "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shellPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shellPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tmpDataPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tmpDataPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fixTables "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fixTables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\tsynchronized (TaskDataThread.class) {")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" poll "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" taskCountQueue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("poll")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("poll "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" split "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" poll"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\t"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" plat "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" area_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" port "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" username "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" password "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" database "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Connection")]),t._v(" conn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Statement")]),t._v(" stmt "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" myDriver "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com.mysql.jdbc.Driver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jdbc:mysql://"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" port "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" database\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"?connectTimeout=20000&socketTimeout=20000&autoReconnect=true&failOverReadOnly=false&maxReconnects=6"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("myDriver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\tconn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DriverManager")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getConnection")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//\t\t\t\t\tSystem.out.println(Thread.currentThread().getName() + ":   " + poll);')]),t._v("\n\t\t\t\t\t\n\t\t\t\t\tsuccessUrl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("poll"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\tstmt "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStatement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResultSet")]),t._v(" rs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" stmt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("executeQuery")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show tables like \'%"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" mysqlTable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%\'"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//\t\t\t\t\tSystem.out.println(Thread.currentThread().getName() + ":" + poll + ": " + "show tables like \'%" + mysqlTable + "%\'");')]),t._v("\n\t\t\t\t\t\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" table "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fixTables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("contains")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" sql "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select "')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" fields "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" , "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" area_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" , "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" plat "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" from "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" table "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" where "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\t\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//\t\t\t\t\t\t\tSystem.out.println(Thread.currentThread().getName() + ":   " + poll);')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//\t\t\t\t\t\t\tSystem.out.println(Thread.currentThread().getName() + "sql " + sql);')]),t._v("\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sh"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sh   bash")]),t._v("\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shellPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" database"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sql")]),t._v("\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sql tmp_plat_area_id_ip_database_table")]),t._v("\n\t\t\t\t\t\t\tcmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tmpDataPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tmp"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" plat "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" area_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" database "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" table "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".successed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecShell")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callShell")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t\t\n\t\t\t\t\trs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\tstmt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\tconn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\te.printStackTrace();")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":  "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" poll"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\tfailUrl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("poll"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("conn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t\tconn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SQLException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t\te"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t}")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\tlatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("countDown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSuccessUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" successUrl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFailUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" failUrl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(" com.gamedata.data.TaskDownloadData")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gamedata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HashSet")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentLinkedQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecutorService")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("concurrent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Executors")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("regex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Matcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("regex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Pattern")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gamedata"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskDownloadData")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" threadCount "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" filePath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" mysqlTable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" rule "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// name_2015_1 n_yyyym, name_201501 n_yyyymm, name n")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" fields "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" where "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" shellPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" tmpDataPath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n\t\t\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filePath: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" filePath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqlTable: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rule: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fields: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" fields"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"where: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"shellPath: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" shellPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tmpDataPath: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" tmpDataPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" fixTables "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fixTables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":  "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" fixTables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" downloadStart "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"..............."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),t._v(" latch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CountDownLatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("threadCount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentLinkedQueue")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" taskCounts "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskGetUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTaskCount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filePath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" taskCounts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExecutorService")]),t._v(" esDown "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Executors")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("newFixedThreadPool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("threadCount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskDataThread")]),t._v(" taskDataThread "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskDataThread")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\ttaskDataThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTaskCountQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("taskCounts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" latch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fields"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" shellPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tmpDataPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fixTables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" threadCount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tesDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("taskDataThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tlatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (main)latch.countDown()")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\te"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"  "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" downloadStart"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\tesDown"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"  "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" taskDataThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSuccessUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"  "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" taskDataThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFailUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("taskDataThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFailUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentTime")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"   "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" string "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" taskDataThread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFailUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fixTables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" tables "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HashSet")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1=1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\ttables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" tables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Pattern")]),t._v(" pattern "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Pattern")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\" .*(.*)>='(.*)' and (.*)<='(.*)'.* \"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Matcher")]),t._v(" matcher "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pattern"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("matcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("where"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" startDate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" endDate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tstartDate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tendDate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" monthBetween "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMonthBetween")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("monthLess1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("monthAdd1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("endDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\ttables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mysqlTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n_yyyymm"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" string "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" monthBetween"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" table "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysqlTable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\ttables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n_yyyym"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" string "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" monthBetween"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" split "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" month "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" table "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysqlTable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" month"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\ttables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" tables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("com.gamedata.down run.sh")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/sh")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("startDate")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("endDate")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("today")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),t._v(" -d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" +%Y-%m-%d"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("threadCount")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## MySQL ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("timeOut")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("game")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hqg"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##  \\t  id\tid\tIp\t\t\t\t")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("filePath")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/home/bigdata/hadoop-project/hqg/tmp/hqg_url_new.txt\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## mysql ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("mysqlTable")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"log_recharge"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## name_2015_1 n_yyyym, name_201501 n_yyyymm, name n")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("rule")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ,  * area_id,plathive")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("fields")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v('*"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ,  '2017-01-01'>='${startDate}' and '2001-01-01'<='${endDate}' ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("where")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\" date(time)>='"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${startDate}")]),t._v("' and date(time)<='"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${endDate}")]),t._v("' \"")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##  / , ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("tmpDataPath")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data1/tmp_down"')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## hive")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hiveTable")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ods_log_recharge"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## hive")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("tmphiveTable")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tmp_ods_log_recharge"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## hive")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hiveDatabase")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hqg_ods"')]),t._v("\n\n\njava -cp /home/bigdata/hadoop-project/download/mysql-connector-java-5.1.10.jar:/home/bigdata/hadoop-project/download/Skymoons-0.0.1-SNAPSHOT-jar-with-dependencies.jar com.skymoons.down.DownloadData "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${threadCount}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${timeOut}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${filePath}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${mysqlTable}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${rule}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${fields}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${where}")]),t._v('"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$?")]),t._v(" -eq "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":  cat '),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${mysqlTable}")]),t._v("/data/*.data > "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v('.txt "')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${mysqlTable}")]),t._v("/data/*.data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v(".txt\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$?")]),t._v(" -eq "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\":   hive -e load data local inpath '"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v(".txt' overwrite into table "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveDatabase}")]),t._v("."),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmphiveTable}")]),t._v(';"')]),t._v("\nhive -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"load data local inpath '"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v(".txt' overwrite into table "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveDatabase}")]),t._v("."),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmphiveTable}")]),t._v(';"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$?")]),t._v(" -eq "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":   insert overwrite table '),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveDatabase}")]),t._v("."),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v(" partition(date)\nselect area_id,plat,time,device_id,platform_id,platform_account,server_id,player_id,account,role_id,role_name,recharge_from,money,diamond,item_id,item_num,order_no,cp_order_no,vip_level_pre,role_level_pre,ip,vPaymentGateway,vPayingTypeID,iGrossRevenue_User,iGrossRevenue,iTopupCoin,iCashCoin,iBonusCoin,iTopupCoinAfter,iCashCoinAfter,iBonusCoinAfter,vDescription,iResult,iLevel,iIsFirstPaying,times,online_long_total,tmp1,tmp2,tmp3,tmp4,  to_date(time) as date from "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveDatabase}")]),t._v("."),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmphiveTable}")]),t._v(';"')]),t._v("\n\nhive -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"insert overwrite table '),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveDatabase}")]),t._v("."),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v(" partition(date)\nselect area_id,plat,time,device_id,platform_id,platform_account,server_id,player_id,account,role_id,role_name,recharge_from,money,diamond,item_id,item_num,order_no,cp_order_no,vip_level_pre,role_level_pre,ip,vPaymentGateway,vPayingTypeID,iGrossRevenue_User,iGrossRevenue,iTopupCoin,iCashCoin,iBonusCoin,iTopupCoinAfter,iCashCoinAfter,iBonusCoinAfter,vDescription,iResult,iLevel,iIsFirstPaying,times,online_long_total,tmp1,tmp2,tmp3,tmp4,  to_date(time) as date from "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveDatabase}")]),t._v("."),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmphiveTable}")]),t._v(';"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$?")]),t._v(" -eq "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":  rm -rf '),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${mysqlTable}")]),t._v(' "')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${mysqlTable}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('":  rm '),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v('.txt "')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${tmpDataPath}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${game}")]),t._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${hiveTable}")]),t._v(".txt\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n")])])]),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("h3",{attrs:{id:"_4-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-"}},[t._v("#")]),t._v(" 4.1 ")]),t._v(" "),n("p",[t._v("1 ")]),t._v(" "),n("p",[t._v("2 ")]),t._v(" "),n("p",[t._v("3 ")]),t._v(" "),n("p",[t._v("4 vip")]),t._v(" "),n("p",[t._v("5 ")]),t._v(" "),n("p",[t._v("6 ")]),t._v(" "),n("p",[t._v("7 ")]),t._v(" "),n("p",[t._v("8 ")]),t._v(" "),n("p",[t._v("9 ")]),t._v(" "),n("p",[t._v("10")]),t._v(" "),n("p",[t._v("11")]),t._v(" "),n("p",[t._v("12")]),t._v(" "),n("p",[t._v("13")]),t._v(" "),n("p",[t._v("14")]),t._v(" "),n("p",[t._v("15")]),t._v(" "),n("p",[t._v("16")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:"_4-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-"}},[t._v("#")]),t._v(" 4.2 ")]),t._v(" "),n("p",[t._v("1 ")]),t._v(" "),n("p",[t._v("2 ")]),t._v(" "),n("p",[t._v("3 ")]),t._v(" "),n("p",[t._v("4 ")]),t._v(" "),n("p",[t._v("5 ")]),t._v(" "),n("p",[t._v("6 ")]),t._v(" "),n("p",[t._v("7 ")]),t._v(" "),n("p",[t._v("8 ")]),t._v(" "),n("p",[t._v("9 Boss")]),t._v(" "),n("p",[t._v("10Boss")]),t._v(" "),n("p",[t._v("11")]),t._v(" "),n("p",[t._v("12")]),t._v(" "),n("p",[t._v("13")]),t._v(" "),n("p",[t._v("14")]),t._v(" "),n("p",[t._v("15")]),t._v(" "),n("p",[t._v("16")]),t._v(" "),n("p",[t._v("17")]),t._v(" "),n("p",[t._v("18")]),t._v(" "),n("p",[t._v("19")]),t._v(" "),n("p",[t._v("20")]),t._v(" "),n("p",[t._v("21")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:"_4-3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-"}},[t._v("#")]),t._v(" 4.3 ")]),t._v(" "),n("p",[t._v("1 ")]),t._v(" "),n("p",[t._v("2 ")]),t._v(" "),n("p",[t._v("3 ")]),t._v(" "),n("p",[t._v("4 ")]),t._v(" "),n("p",[t._v("5 ")]),t._v(" "),n("p",[t._v("6 ")]),t._v(" "),n("p",[t._v("7 ")]),t._v(" "),n("p",[t._v("8 ")]),t._v(" "),n("p",[t._v("9 ")]),t._v(" "),n("p",[t._v("10")]),t._v(" "),n("p",[t._v("11")]),t._v(" "),n("p",[t._v("12")]),t._v(" "),n("p",[t._v("13")]),t._v(" "),n("p",[t._v("14")]),t._v(" "),n("p",[t._v("15")]),t._v(" "),n("p",[t._v("16")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("  --")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("  --5   --")])]),t._v(" "),n("h3",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("op_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("(1:-1)")])]),t._v(" "),n("tr",[n("td",[t._v("online_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("(s)")])]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("operating_version")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("()ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("job_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("role_sex")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("(0:1:)")])])])]),t._v(" "),n("h3",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("operating_version")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("change_count")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("combat_power")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5"}},[t._v("#")]),t._v(" 5")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("level_befor")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("level_after")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_6"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6"}},[t._v("#")]),t._v(" 6")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("order_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("acer_count")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("recharge_amount")]),t._v(" "),n("td",[t._v("double")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("order_status")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("recharge_purpose")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("0:   1:   2:")])])])]),t._v(" "),n("h3",{attrs:{id:"_7"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7"}},[t._v("#")]),t._v(" 7")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("task_type")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("task_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("cost_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("op_type")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("level_limit")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("award_exp")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("award_monetary")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("award_item")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("death_count")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("award_attribute")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8"}},[t._v("#")]),t._v(" 8")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("log_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("button_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])])])]),t._v(" "),n("h3",{attrs:{id:"_9"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9"}},[t._v("#")]),t._v(" 9")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("button_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("button_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("system_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_10"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10"}},[t._v("#")]),t._v(" 10")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("log_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("monetary_type")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("(1:2:3: )")])]),t._v(" "),n("tr",[n("td",[t._v("output_type")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("output_count")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("monetary_stock")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_11"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11"}},[t._v("#")]),t._v(" 11")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("log_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("monetary_type")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("(1:2:3: )")])]),t._v(" "),n("tr",[n("td",[t._v("consume_type")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("consume_count")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("monetary_stock")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_12-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12-"}},[t._v("#")]),t._v(" 12 ")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("log_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("map_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("attacker_uid")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID/id")])]),t._v(" "),n("tr",[n("td",[t._v("attacker_rid")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID/id")])]),t._v(" "),n("tr",[n("td",[t._v("attacker_rname")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("/")])]),t._v(" "),n("tr",[n("td",[t._v("attacker_level")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("/")])]),t._v(" "),n("tr",[n("td",[t._v("death_level")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("hero_power")]),t._v(" "),n("td",[t._v("bigint")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("death_detail")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h3",{attrs:{id:"_13"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13"}},[t._v("#")]),t._v(" 13")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("game_channel_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("advertisement_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("material_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("material_number")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("template_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("package_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("package_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("timestamp")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("share_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("share_content")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("log_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("share_result")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v(":0:1:")])])])]),t._v(" "),n("h3",{attrs:{id:"_14"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_14"}},[t._v("#")]),t._v(" 14")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("log_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("level_before")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("level_after")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h3",{attrs:{id:"ppt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ppt"}},[t._v("#")]),t._v(" PPT")]),t._v(" "),n("blockquote",[n("p",[t._v("P1:")]),t._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:".assets/image-20200425042454213.png",alt:"image-20200425042454213"}}),t._v(" "),n("p",[t._v("P2:")]),t._v(" "),n("img",{staticStyle:{zoom:"40%"},attrs:{src:".assets/image-20200425042419516.png",alt:"image-20200425042419516"}}),t._v(" "),n("p",[t._v("P3:")]),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425042532579.png",alt:"image-20200425042532579"}}),t._v(" "),n("p",[t._v("P4:")]),t._v(" "),n("img",{staticStyle:{zoom:"38%"},attrs:{src:".assets/image-20200425042723806.png",alt:"image-20200425042723806"}}),t._v(" "),n("p",[t._v("P5:")]),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425042838030.png",alt:"image-20200425042838030"}}),t._v(" "),n("p",[t._v("P6:")]),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425043014746.png",alt:"image-20200425043014746"}}),t._v(" "),n("p",[t._v("P7:")]),t._v(" "),n("p",[n("strong",[t._v(" -- ")]),t._v("")]),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425043122513.png",alt:"image-20200425043122513"}}),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425043154384.png",alt:"image-20200425043154384"}}),t._v(" "),n("p",[t._v("P8:")]),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425043254648.png",alt:"image-20200425043254648"}}),t._v(" "),n("img",{staticStyle:{zoom:"42%"},attrs:{src:".assets/image-20200425043319320.png",alt:"image-20200425043319320"}}),t._v(" "),n("p",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1893),alt:"image-20200425043540704"}})]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("ol",[n("li",[t._v("ODS")]),t._v(" "),n("li",[t._v("DWODS")]),t._v(" "),n("li",[t._v("RES")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\n\t  \n\t\tods\n\t\tdwods\n\t\tres    \n\t\n\t\tods  \n\t\tdwdods\n\t\tdws  dwd\n\t\tres      \n\t\n\t\tods  \n\t\tdwdods\n\t\tdws  dwd\n\t\tdwm\n\t\tres      \n")])])]),n("p",[n("img",{attrs:{src:a(1894),alt:"image-20200425043623721"}})]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("1")]),t._v(" "),n("p",[t._v("2keyiduser_idplayer_ididkeyidapp_nameappNameAppNamevaluechannelappstoreapp store")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1895),alt:""}})]),t._v(" "),n("p",[t._v("odsdwres")]),t._v(" "),n("p",[n("strong",[t._v("odsOperation Data Store")])]),t._v(" "),n("p",[t._v("mysql")]),t._v(" "),n("p",[n("strong",[t._v("dwData Warehouse")])]),t._v(" "),n("p",[t._v("ETLhive")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("p",[n("strong",[t._v("res: Result")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("PHPJava webPHPweb")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("databasetable")]),t._v(" "),n("ol",[n("li",[t._v("create database ods; create database dw; create database res; database")]),t._v(" "),n("li",[t._v("ods_ dw_ res_ ")])]),t._v(" "),n("p",[n("strong",[n("strong",[t._v("database")])])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(" ods_role_create ods_fight_power  ods_role_recharge")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("1"),n("strong",[t._v("")]),t._v("comment")]),t._v(" "),n("p",[t._v("2"),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("3"),n("strong",[t._v("")]),t._v(" yyyy-MM-dddatepart_date")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_game_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_brand       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_type        string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_system   string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_version  string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\u0001'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"ods"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ods"}},[t._v("#")]),t._v(" ODS")]),t._v(" "),n("h3",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v("node03")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /kkb/datas/gamecenter/\n")])])]),n("p",[t._v("javanode03/kkb/datas/gamecenter")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/datas/gamecenter/\nrz\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop@node03 gamecenter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ ll\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4085524")]),t._v("\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7686315")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":34 ods_death_log.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop     "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("137268")]),t._v(" Feb  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09 ods_dim_game_button.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2205476848")]),t._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":05 ods_fight_power.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10482616")]),t._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":17 ods_game_create.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4759133")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":34 ods_game_levelup.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5797282")]),t._v(" Feb  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":35 ods_monetary_consume.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5829941")]),t._v(" Feb  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":35 ods_monetary_output.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5138799")]),t._v(" Feb  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":35 ods_panel_op.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14047817")]),t._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":18 ods_role_create.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("926068852")]),t._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":40 ods_role_level_up.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22429171")]),t._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":40 ods_role_recharge.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("731548283")]),t._v(" Feb  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":16 ods_task_log.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("243245810")]),t._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":48 ods_user_login.txt\n-rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" hadoop hadoop     "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("900062")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":34 ods_user_share.txt\n")])])]),n("p",[t._v("Javahivehiveods_ ")]),t._v(" "),n("p",[t._v(" user_login_201901")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("id")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("IP")])]),t._v(" "),n("tr",[n("td",[t._v("event_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("op_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("(1:,-1)")])]),t._v(" "),n("tr",[n("td",[t._v("online_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("(s)")])]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("operating_version")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("ididMySQL")]),t._v("")]),t._v(" "),n("p",[t._v("ods_user_login "),n("strong",[t._v("")])]),t._v(" "),n("p",[n("strong",[n("strong",[t._v("")])])]),t._v(" "),n("h3",{attrs:{id:"_2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("hiveserver2")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hive-1.1.0-cdh5.14.2/\nbin/hive --service hiveserver2\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hive-1.1.0-cdh5.14.2/\n\nbin/beeline\n")])])]),n("p",[t._v("database game_center")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exists")]),t._v("  game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_user_login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nop_type            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(1:,-1)'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nonline_time        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(s)'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_system   string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_version  string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_brand       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_type        string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#from_unixtime(event_time,'yyyy-MM-dd') as part_date")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_user_login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nop_type            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(1:,-1)'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nonline_time        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(s)'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_system   string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_version  string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_brand       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_type        string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_user_login'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_user_login.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_user_login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("selectods_user_login")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#1000")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_user_login "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("op_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("online_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("operating_system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("operating_version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_user_login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("node03shell")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /home/hadoop/bin/\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/hadoop/bin/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ods_user_login.sh\n")])])]),n("p",[t._v('sql="xxx" ----\x3e /kkb/install/hive-1.1.0-cdh5.14.2/bin/hive -e "$sql"')]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists  "')]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DBNAME")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".ods_user_login(\nplat_id            string     comment 'id',\nserver_id          int        comment 'id',\nchannel_id         string     comment '',\nuser_id            string     comment 'ID',\nrole_id            string     comment 'ID',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nop_type            string     comment '(1:,-1)',\nonline_time        int        comment '(s)',\noperating_system   string     comment '',\noperating_version  string     comment '',\ndevice_brand       string     comment '',\ndevice_type        string     comment ''\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists tmp_ods_user_login(\nplat_id            string     comment 'id',\nserver_id          int        comment 'id',\nchannel_id         string     comment '',\nuser_id            string     comment 'ID',\nrole_id            string     comment 'ID',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nop_type            string     comment '(1:,-1)',\nonline_time        int        comment '(s)',\noperating_system   string     comment '',\noperating_version  string     comment '',\ndevice_brand       string     comment '',\ndevice_type        string     comment ''\n)\ncomment '-ods_user_login'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_user_login.txt' overwrite into table tmp_ods_user_login;\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\ninsert overwrite table ods_user_login partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,op_type,online_time,operating_system,operating_version,device_brand,device_type,from_unixtime(event_time,'yyyy-MM-dd') as part_date \nfrom tmp_ods_user_login;\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("h5",{attrs:{id:"-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-2"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_role_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'          '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id        string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'()ID        '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id           string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID              '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id           string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID              '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name         string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip         string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\njob_name          string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_sex          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(0:,1:) '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_role_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'          '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id        string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'()ID        '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id           string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID              '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id           string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID              '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name         string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip         string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\njob_name          string      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'            '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_sex          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(0:,1:) '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_role_create'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_role_create.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_role_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.exec.dynamic.partition"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.exec.dynamic.partition.mode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.exec.max.dynamic.partitions.pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ninsert overwrite table ods_role_create partition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,job_name,role_sex,from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time,"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" as part_date from tmp_ods_role_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h5",{attrs:{id:"-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-2"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("node03:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_role_create.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists  ods_role_create(\nplat_id            string     comment 'id',\nserver_id         int         comment '          ',\nchannel_id        string      comment '()ID        ',\nuser_id           string      comment 'ID              ',\nrole_id           string      comment 'ID              ',\nrole_name         string      comment '            ',\nclient_ip         string      comment 'IP            ',\nevent_time        int         comment '            ',\njob_name          string      comment '            ',\nrole_sex          int         comment '(0:,1:) '\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists  tmp_ods_role_create(\nplat_id            string     comment 'id',\nserver_id         int         comment '          ',\nchannel_id        string      comment '()ID        ',\nuser_id           string      comment 'ID              ',\nrole_id           string      comment 'ID              ',\nrole_name         string      comment '            ',\nclient_ip         string      comment 'IP            ',\nevent_time        int         comment '            ',\njob_name          string      comment '            ',\nrole_sex          int         comment '(0:,1:) '\n)\ncomment '-ods_role_create'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_role_create.txt' overwrite into table tmp_ods_role_create;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_role_create partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,job_name,role_sex,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_role_create;\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n")])])]),n("h3",{attrs:{id:"_4-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("h5",{attrs:{id:"-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-3"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_game_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_brand       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_type        string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_system   string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_version  string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_game_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_brand       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_type        string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_system   string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_version  string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_game_create'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_game_create.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_game_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_game_create "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("operating_system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("operating_version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_game_create"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-3"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_game_create.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists  ods_game_create(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID',\nchannel_id         string     comment 'id',\nuser_id            string     comment 'ID',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\ndevice_brand       string     comment ' ',\ndevice_type        string     comment ' ',\noperating_system   string     comment '',\noperating_version  string     comment ''\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE  if not exists  tmp_ods_game_create(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID',\nchannel_id         string     comment 'id',\nuser_id            string     comment 'ID',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\ndevice_brand       string     comment ' ',\ndevice_type        string     comment ' ',\noperating_system   string     comment '',\noperating_version  string     comment ''\n)\ncomment '-ods_game_create'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_game_create.txt' overwrite into table tmp_ods_game_create;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_game_create partition(part_date)\nselect plat_id,server_id,channel_id,user_id,client_ip,event_time,device_brand,device_type,operating_system,operating_version,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_game_create;\n\"")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_5-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-"}},[t._v("#")]),t._v(" 5")]),t._v(" "),n("h5",{attrs:{id:"-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-4"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_fight_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id      string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nclient_ip       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nchange_count    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  \ncombat_power    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_fight_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id      string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nclient_ip       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nchange_count    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  \ncombat_power    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_fight_power'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_fight_power.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_fight_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_fight_power "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("change_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("combat_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_fight_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-4"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_fight_power.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\nCREATE TABLE if not exists  ods_fight_power(\nplat_id         string     comment 'id',\nserver_id       int        comment 'ID  ',\nchannel_id      string     comment 'ID    ',\nuser_id         string     comment 'ID    ',\nrole_id         string     comment 'ID    ',\nrole_name       string     comment '  ', \nclient_ip       string     comment 'IP  ',\nevent_time      int        comment '  ', \nchange_count    bigint     comment '',  \ncombat_power    bigint     comment ''\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists tmp_ods_fight_power(\nplat_id         string     comment 'id',\nserver_id       int        comment 'ID  ',\nchannel_id      string     comment 'ID    ',\nuser_id         string     comment 'ID    ',\nrole_id         string     comment 'ID    ',\nrole_name       string     comment '  ', \nclient_ip       string     comment 'IP  ',\nevent_time      int        comment '  ', \nchange_count    bigint     comment '',  \ncombat_power    bigint     comment ''\n)\ncomment '-ods_fight_power'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_fight_power.txt' overwrite into table tmp_ods_fight_power;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_fight_power partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,change_count,combat_power,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_fight_power;\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n")])])]),n("h3",{attrs:{id:"_6-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-"}},[t._v("#")]),t._v(" 6")]),t._v(" "),n("h5",{attrs:{id:"-5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-5"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_role_level_up"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'()ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_befor        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'   '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_after        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'   '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_role_level_up"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'()ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'     '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_befor        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'   '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_after        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'   '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_role_level_up'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_role_level_up.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_role_level_up"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_role_level_up "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_befor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_role_level_up"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-5"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_role_level_up.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\nCREATE TABLE ods_role_level_up(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID     ',\nchannel_id         string     comment '()ID ',\nuser_id            string     comment 'ID       ',\nrole_id            string     comment 'ID       ',\nrole_name          string     comment '     ',\nclient_ip          string     comment 'IP     ',\nevent_time         int        comment '     ',\nlevel_befor        int        comment '   ',\nlevel_after        int        comment '   '\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE tmp_ods_role_level_up(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID     ',\nchannel_id         string     comment '()ID ',\nuser_id            string     comment 'ID       ',\nrole_id            string     comment 'ID       ',\nrole_name          string     comment '     ',\nclient_ip          string     comment 'IP     ',\nevent_time         int        comment '     ',\nlevel_befor        int        comment '   ',\nlevel_after        int        comment '   '\n)\ncomment '-ods_role_level_up'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_role_level_up.txt' overwrite into table tmp_ods_role_level_up;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_role_level_up partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,level_befor,level_after,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_role_level_up;\n\n\"")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_7-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-"}},[t._v("#")]),t._v(" 7")]),t._v(" "),n("h5",{attrs:{id:"-6"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-6"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_role_recharge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\norder_id           string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nacer_count         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrecharge_amount    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\norder_status       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrecharge_purpose   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0:,1:2:'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_role_recharge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\norder_id           string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nacer_count         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrecharge_amount    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\norder_status       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrecharge_purpose   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0:,1:2:'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_role_recharge'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_role_recharge.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_role_recharge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_role_recharge "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("order_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("order_status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_role_recharge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h5",{attrs:{id:"-6"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-6"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_role_recharge.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists  ods_role_recharge(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID       ',\nchannel_id         string     comment 'ID         ',\nuser_id            string     comment 'ID         ',\nrole_id            string     comment 'ID         ',\nrole_name          string     comment '       ',\nevent_time         int        comment '       ',\norder_id           string     comment 'ID         ',\nacer_count         int        comment ' ',\nrecharge_amount    double     comment '       ',\norder_status       int        comment '       ',\nrecharge_purpose   int        comment '0:,1:2:'\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists  tmp_ods_role_recharge(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID       ',\nchannel_id         string     comment 'ID         ',\nuser_id            string     comment 'ID         ',\nrole_id            string     comment 'ID         ',\nrole_name          string     comment '       ',\nevent_time         int        comment '       ',\norder_id           string     comment 'ID         ',\nacer_count         int        comment ' ',\nrecharge_amount    double     comment '       ',\norder_status       int        comment '       ',\nrecharge_purpose   int        comment '0:,1:2:'\n)\ncomment '-ods_role_recharge'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\n\nload data local inpath '/kkb/datas/gamecenter/ods_role_recharge.txt' overwrite into table tmp_ods_role_recharge;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_role_recharge partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,event_time,order_id,acer_count,recharge_amount,order_status,recharge_purpose,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_role_recharge;\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n")])])]),n("h3",{attrs:{id:"_8-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-"}},[t._v("#")]),t._v(" 8")]),t._v(" "),n("h5",{attrs:{id:"-7"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-7"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_task_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ntask_type          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ntask_id            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncost_time          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nop_type            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_limit        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_exp          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_monetary     string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_item         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndeath_count        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_attribute    string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_task_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID         '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'       '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ntask_type          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ntask_id            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID    '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncost_time          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nop_type            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_limit        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_exp          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_monetary     string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_item         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndeath_count        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\naward_attribute    string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'  '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_task_log'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_task_log.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_task_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_task_log "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("task_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("task_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cost_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("op_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_limit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("award_exp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("award_monetary"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("award_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("death_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("award_attribute"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nfrom_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_task_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n")])])]),n("h5",{attrs:{id:"-7"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-7"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /home/hadoop/bin/\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/hadoop/bin/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ods_task_log.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists ods_task_log(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID       ',\nchannel_id         string     comment 'ID         ',\nuser_id            string     comment 'ID         ',\nrole_id            string     comment 'ID         ',\nrole_name          string     comment '       ',\nevent_time         int        comment '       ',\ntask_type          int        comment '  ',\ntask_id            int        comment 'ID    ',\ncost_time          int        comment '  ',\nop_type            int        comment '  ',\nlevel_limit        int        comment '  ',\naward_exp          bigint     comment '  ',\naward_monetary     string     comment '  ',\naward_item         string     comment '  ',\ndeath_count        int        comment '  ',\naward_attribute    string     comment '  '\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\n\nCREATE TABLE if not exists tmp_ods_task_log(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID       ',\nchannel_id         string     comment 'ID         ',\nuser_id            string     comment 'ID         ',\nrole_id            string     comment 'ID         ',\nrole_name          string     comment '       ',\nevent_time         int        comment '       ',\ntask_type          int        comment '  ',\ntask_id            int        comment 'ID    ',\ncost_time          int        comment '  ',\nop_type            int        comment '  ',\nlevel_limit        int        comment '  ',\naward_exp          bigint     comment '  ',\naward_monetary     string     comment '  ',\naward_item         string     comment '  ',\ndeath_count        int        comment '  ',\naward_attribute    string     comment '  '\n)\ncomment '-ods_task_log'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_task_log.txt' overwrite into table tmp_ods_task_log;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_task_log partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,event_time,task_type,task_id,cost_time,op_type,level_limit,award_exp,award_monetary,award_item,death_count,award_attribute,\nfrom_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_task_log;\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n")])])]),n("h3",{attrs:{id:"_9-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-"}},[t._v("#")]),t._v(" 9")]),t._v(" "),n("h5",{attrs:{id:"-8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-8"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_panel_op"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nbutton_id          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_panel_op"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nbutton_id          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_panel_op'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_panel_op.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_panel_op"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_panel_op "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("button_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_panel_op"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-8"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_panel_op.sh\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("#!/bin/bash\nDBNAME=game_center\nhive_home=/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\nsql=\"\ncreate database if not exists  game_center;\nuse game_center;\nCREATE TABLE if not exists ods_panel_op(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'ID',\nbutton_id          string     comment 'ID'\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists tmp_ods_panel_op(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'ID',\nbutton_id          string     comment 'ID'\n)\ncomment '-ods_panel_op'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_panel_op.txt' overwrite into table tmp_ods_panel_op;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_panel_op partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,log_id,button_id,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_panel_op;\n\n\n\n\"\n\n$hive_home -e \"$sql\"\n\n")])])]),n("h3",{attrs:{id:"_10---load"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10---load"}},[t._v("#")]),t._v(" 10load")]),t._v(" "),n("h5",{attrs:{id:"-9"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-9"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_dim_game_button"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id              string       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nbutton_id            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nbutton_name          string       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nsystem_type          string       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" format delimited "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fields")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\ncollection items "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),t._v("\nmap "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("keys")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("':'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lines")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nstored "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" textfile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_dim_game_button.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_dim_game_button"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-9"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-9"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_dim_game_button.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\ncreate table if not exists ods_dim_game_button(\nplat_id              string       comment '',\nbutton_id            int          comment 'ID',\nbutton_name          string       comment '',\nsystem_type          string       comment ''\n) comment ''\nrow format delimited fields terminated by '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\ncollection items terminated by ','\nmap keys terminated by ':'\nlines terminated by '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nstored as textfile;\n\nload data local inpath '/kkb/datas/gamecenter/ods_dim_game_button.txt' overwrite into table ods_dim_game_button;\n\n\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_11-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11-"}},[t._v("#")]),t._v(" 11")]),t._v(" "),n("h5",{attrs:{id:"-10"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-10"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_monetary_output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_type      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(1:,2:,3: )'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noutput_type        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noutput_count       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_stock     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_monetary_output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_type      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(1:,2:,3: )'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noutput_type        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noutput_count       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_stock     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_monetary_output'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_monetary_output.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_monetary_output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_monetary_output "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("output_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("output_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_monetary_output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-10"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-10"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_monetary_output.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE  if not exists ods_monetary_output(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID ',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'id ',\nmonetary_type      int        comment '(1:,2:,3: )',\noutput_type        int        comment 'ID ',\noutput_count       bigint     comment ' ',\nmonetary_stock     bigint     comment ' '\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists tmp_ods_monetary_output(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID ',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'id ',\nmonetary_type      int        comment '(1:,2:,3: )',\noutput_type        int        comment 'ID ',\noutput_count       bigint     comment ' ',\nmonetary_stock     bigint     comment ' '\n)\ncomment '-ods_monetary_output'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_monetary_output.txt' overwrite into table tmp_ods_monetary_output;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_monetary_output partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,log_id,monetary_type,output_type,output_count,monetary_stock,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_monetary_output;\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_12-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12-"}},[t._v("#")]),t._v(" 12")]),t._v(" "),n("h5",{attrs:{id:"-11"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-11"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_monetary_consume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_type      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(1:,2:,3: )'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nconsume_type        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nconsume_count       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_stock     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_monetary_consume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_type      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(1:,2:,3: )'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nconsume_type        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nconsume_count       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmonetary_stock     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_monetary_consume'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_monetary_consume.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_monetary_consume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_monetary_consume "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("consume_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("consume_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_monetary_consume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-11"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-11"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_monetary_consume.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists ods_monetary_consume(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID ',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'id ',\nmonetary_type      int        comment '(1:,2:,3: )',\nconsume_type        int        comment 'ID ',\nconsume_count       bigint     comment ' ',\nmonetary_stock     bigint     comment ' '\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists  tmp_ods_monetary_consume(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID ',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'id ',\nmonetary_type      int        comment '(1:,2:,3: )',\nconsume_type        int        comment 'ID ',\nconsume_count       bigint     comment ' ',\nmonetary_stock     bigint     comment ' '\n)\ncomment '-ods_monetary_consume'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_monetary_consume.txt' overwrite into table tmp_ods_monetary_consume;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_monetary_consume partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,log_id,monetary_type,consume_type,consume_count,monetary_stock,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_monetary_consume;\n\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_13-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13-"}},[t._v("#")]),t._v(" 13")]),t._v(" "),n("h5",{attrs:{id:"-12"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-12"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_death_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmap_id             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_uid       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID/id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_rid       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID/id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_rname     string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_level     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndeath_level        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nhero_power         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndeath_detail       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_death_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmap_id             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_uid       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID/id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_rid       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID/id '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_rname     string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nattacker_level     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndeath_level        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nhero_power         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndeath_detail       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_death_log'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_death_log.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_death_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_death_log "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("map_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("attacker_uid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("attacker_rid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("attacker_rname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("attacker_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("death_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("hero_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("death_detail"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_death_log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-12"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-12"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_death_log.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\nCREATE TABLE if not exists ods_death_log(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID ',\nrole_name          string     comment ' ',\nclient_ip          string     comment 'IP ',\nevent_time         int        comment ' ',\nlog_id             string     comment 'ID',\nmap_id             int        comment 'ID',\nattacker_uid       string     comment 'ID/id ',\nattacker_rid       string     comment 'ID/id ',\nattacker_rname     string     comment '/',\nattacker_level     int        comment '/',\ndeath_level        int        comment '',\nhero_power         bigint     comment '',\ndeath_detail       string     comment ''\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE  if not exists tmp_ods_death_log(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID ',\nrole_id            string     comment 'ID ',\nrole_name          string     comment ' ',\nclient_ip          string     comment 'IP ',\nevent_time         int        comment ' ',\nlog_id             string     comment 'ID',\nmap_id             int        comment 'ID',\nattacker_uid       string     comment 'ID/id ',\nattacker_rid       string     comment 'ID/id ',\nattacker_rname     string     comment '/',\nattacker_level     int        comment '/',\ndeath_level        int        comment '',\nhero_power         bigint     comment '',\ndeath_detail       string     comment ''\n)\ncomment '-ods_death_log'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_death_log.txt' overwrite into table tmp_ods_death_log;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_death_log partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,log_id,map_id,attacker_uid,attacker_rid,attacker_rname,attacker_level,death_level,hero_power,death_detail,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_death_log;\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n")])])]),n("h3",{attrs:{id:"_14-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_14-"}},[t._v("#")]),t._v(" 14")]),t._v(" "),n("h5",{attrs:{id:"-13"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-13"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_user_share"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ngame_channel_id    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nadvertisement_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmaterial_id        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmaterial_number    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ntemplate_id        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npackage_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npackage_name       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_id           string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_content      string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_result       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("':0:,1:'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_user_share"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ngame_channel_id    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nadvertisement_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmaterial_id        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmaterial_number    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ntemplate_id        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npackage_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npackage_name       string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_id           string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_content      string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_result       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("':0:,1:'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_user_share'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_user_share.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_user_share"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_user_share "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("game_channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("advertisement_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("material_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("material_number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("template_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("package_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("package_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("share_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("share_content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("share_result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_user_share"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h5",{attrs:{id:"-13"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-13"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_user_share.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\n\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists ods_user_share(\nplat_id            string     comment 'id',\nchannel_id         int        comment 'ID',\ngame_channel_id    int        comment 'id',\nadvertisement_id   int        comment 'ID',\nmaterial_id        int        comment 'ID',\nmaterial_number    int        comment '',\ntemplate_id        int        comment 'ID',\npackage_id         int        comment 'ID',\npackage_name       string     comment '',\nuser_id            string     comment 'ID',\nevent_time          int        comment '',\nshare_id           string     comment 'ID',\nshare_content      string     comment '',\nlog_id             string     comment 'id',\nshare_result       int        comment ':0:,1:'\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists tmp_ods_user_share(\nplat_id            string     comment 'id',\nchannel_id         int        comment 'ID',\ngame_channel_id    int        comment 'id',\nadvertisement_id   int        comment 'ID',\nmaterial_id        int        comment 'ID',\nmaterial_number    int        comment '',\ntemplate_id        int        comment 'ID',\npackage_id         int        comment 'ID',\npackage_name       string     comment '',\nuser_id            string     comment 'ID',\nevent_time          int        comment '',\nshare_id           string     comment 'ID',\nshare_content      string     comment '',\nlog_id             string     comment 'id',\nshare_result       int        comment ':0:,1:'\n)\ncomment '-ods_user_share'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_user_share.txt' overwrite into table tmp_ods_user_share;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_user_share partition(part_date)\nselect plat_id,channel_id,game_channel_id,advertisement_id,material_id,material_number,template_id,package_id,package_name,user_id,event_time,share_id,share_content,log_id,share_result,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_user_share;\n\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_15-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_15-"}},[t._v("#")]),t._v(" 15")]),t._v(" "),n("h5",{attrs:{id:"-14"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-14"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_game_levelup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_before       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_after        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" tmp_ods_game_levelup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id         string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id            string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip          string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IP'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nevent_time         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlog_id             string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_before       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlevel_after        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-ods_game_levelup'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/datas/gamecenter/ods_game_levelup.txt'")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_ods_game_levelup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nostrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("partitions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pernode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" ods_game_levelup "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_before"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_ods_game_levelup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n")])])]),n("h5",{attrs:{id:"-14"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-14"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("mkdir -p /home/hadoop/bin/\ncd /home/hadoop/bin/\nvim ods_game_levelup.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DBNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("hive_home")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/hive-1.1.0-cdh5.14.2/bin/hive\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"\ncreate database if not exists  game_center;\nuse game_center;\n\nCREATE TABLE if not exists ods_game_levelup(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID',\nrole_id            string     comment 'ID',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'ID',\nlevel_before       int        comment '',\nlevel_after        int        comment ''\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nCREATE TABLE if not exists tmp_ods_game_levelup(\nplat_id            string     comment 'id',\nserver_id          int        comment 'ID ',\nchannel_id         string     comment 'ID ',\nuser_id            string     comment 'ID',\nrole_id            string     comment 'ID',\nrole_name          string     comment '',\nclient_ip          string     comment 'IP',\nevent_time         int        comment '',\nlog_id             string     comment 'ID',\nlevel_before       int        comment '',\nlevel_after        int        comment ''\n)\ncomment '-ods_game_levelup'\nROW FORMAT DELIMITED FIELDS TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'\nLINES TERMINATED BY '"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'\nSTORED AS TEXTFILE;\n\nload data local inpath '/kkb/datas/gamecenter/ods_game_levelup.txt' overwrite into table tmp_ods_game_levelup;\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nostrict;\nset hive.exec.max.dynamic.partitions.pernode=1000;\n\ninsert overwrite table ods_game_levelup partition(part_date)\nselect plat_id,server_id,channel_id,user_id,role_id,role_name,client_ip,event_time,log_id,level_before,level_after,from_unixtime(event_time,'yyyy-MM-dd') as part_date from tmp_ods_game_levelup;\n\n\n\n\"")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hive_home")]),t._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v('"')]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_16ods"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16ods"}},[t._v("#")]),t._v(" 16ods")]),t._v(" "),n("p",[t._v("shellods")]),t._v(" "),n("p",[t._v("node03shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin\nvim execute_ods.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("odsshell")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" ods*"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#echo "$odsshell"')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("m")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$odsshell")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$m")]),t._v("\n /usr/bin/sh "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$m")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin\t\nsh execute_ods.sh\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("show tables"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n+---------------------------+--+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("         tab_name          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+---------------------------+--+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_death_log             "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_dim_game_button       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_fight_power           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_game_create           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_game_levelup          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_monetary_consume      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_monetary_output       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_panel_op              "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_role_create           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_role_level_up         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_role_recharge         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_task_log              "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_user_login            "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ods_user_share            "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_death_log         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_fight_power       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_game_create       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_game_levelup      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_monetary_consume  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_monetary_output   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_panel_op          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_role_create       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_role_level_up     "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_role_recharge     "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_task_log          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_user_login        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" tmp_ods_user_share        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+---------------------------+--+\n")])])]),n("h2",{attrs:{id:"dw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dw"}},[t._v("#")]),t._v(" DW")]),t._v(" "),n("h2",{attrs:{id:"_1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-"}},[t._v("#")]),t._v(" 1.")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("TalkingData  Game Analytics KontagentLocalytics")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1896),alt:"image-20200426005050694"}})]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1897),alt:"image-20200426005118989"}})]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1898),alt:"image-20200426005130096"}})]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("ETL")]),t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("MacIP")]),t._v("")]),t._v(" "),n("h4",{attrs:{id:"hadoop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hadoop"}},[t._v("#")]),t._v(" hadoop")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1899),alt:"image-20200426005140397"}})]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("Javamysql"),n("strong",[t._v("ETLextratransferload ")]),t._v(" MysqlOracleHTTP/FTPExcel")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("HDFS/"),n("strong",[t._v("Hive")]),t._v(" hivespark sql impalapresto sql ")]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("HiveMRSparkSparkSQLHDFS"),n("strong",[t._v("HDFS")]),t._v(" "),n("strong",[t._v("mysqlNOSQLmysql")])]),t._v(" "),n("h5",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("SQL")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h5",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("InmonKimball")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("Inmon")]),t._v("CIF"),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("OLTP")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1900),alt:"image-20200426005208823"}})]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("KimballInmonKimball")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("KimballKimball"),n("strong",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1901),alt:"image-20200426005216316"}})]),t._v(" "),n("p",[t._v("Inmon")]),t._v(" "),n("p",[t._v("Kimball ")]),t._v(" "),n("h5",{attrs:{id:"_2--"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2--"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("p",[n("strong",[t._v("1")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("200")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("strong",[t._v("2")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[n("strong",[t._v("3")]),t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("Kimball"),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("id")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("event_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("id")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("reg_users")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("pay_money")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("login_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" table1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nevent_date       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nreg_users        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npay_money        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlogin_times      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\u0001'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("h6",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1902),alt:"image-20200426031953090"}})]),t._v(" "),n("h6",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1903),alt:"image-20200426032123292"}})]),t._v(" "),n("h6",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1904),alt:"image-20200426032416699"}})]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h6",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("hadoopjoinshuffle,")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("Inmon ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("1NF")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("ID")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("1")]),t._v(" "),n("td",[t._v("10")]),t._v(" "),n("td",[t._v("10089")]),t._v(" "),n("td",[t._v("57655202")])])])]),t._v(" "),n("p",[t._v("10")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1905),alt:"image-20200426005452899"}})]),t._v(" "),n("p",[t._v("2NF1NF")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("2")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("2")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("p",[t._v("IDIDID2NF")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1906),alt:"image-20200426005531276"}})]),t._v(" "),n("p",[t._v("3NF2NF")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("ID")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("order78512")]),t._v(" "),n("td",[t._v("8956")]),t._v(" "),n("td",[t._v("100")]),t._v(" "),n("td",[t._v("6")]),t._v(" "),n("td",[t._v("57655202")])])])]),t._v(" "),n("p",[t._v("IDID3NF")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1907),alt:"image-20200426005607470"}})]),t._v(" "),n("p",[n("strong",[t._v("hive")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("strong",[t._v("111")])]),t._v(" "),n("p",[n("strong",[t._v("11")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("id")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th"),t._v(" "),n("th",[t._v("id")]),t._v(" "),n("th",[t._v("ID")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-01")]),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("1")])])])]),t._v(" "),n("p",[t._v("id11")]),t._v(" "),n("p",[n("strong",[t._v("1")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("id")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th"),t._v(" "),n("th",[t._v("id")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-01")]),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-01 12:00")])]),t._v(" "),n("tr",[n("td"),t._v(" "),n("td"),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-02 10:00")])]),t._v(" "),n("tr",[n("td"),t._v(" "),n("td"),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-03 16:00")])])])]),t._v(" "),n("p",[t._v("2019-10-011")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("id")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th"),t._v(" "),n("th",[t._v("id")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-01 12:00")]),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("50")])]),t._v(" "),n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-01 13:00")]),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("60")])]),t._v(" "),n("tr",[n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("2019-10-01 14:00")]),t._v(" "),n("td"),t._v(" "),n("td",[t._v("57655202")]),t._v(" "),n("td",[t._v("70")])])])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("****"),n("strong",[t._v("hivespark sql")])]),t._v(" "),n("h4",{attrs:{id:"etl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#etl"}},[t._v("#")]),t._v(" ETL")]),t._v(" "),n("p",[t._v("ETLExtraction-Transformation-Loading")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1908),alt:"image-20200426005649884"}})]),t._v(" "),n("p",[n("strong",[t._v("ETL")]),t._v(" ETL (Extract,Transform,Load)")]),t._v(" "),n("p",[t._v(":")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1909),alt:"image-20200426005656263"}})]),t._v(" "),n("p",[t._v("****"),n("strong",[t._v("Java")])]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("****ETL")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("ETLSEDWAkettleOracleGoldengateinformaticatalendkettle")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("ETLETL")])]),t._v(" "),n("p",[t._v("exceljsonhivehive ODS")]),t._v(" "),n("p",[t._v("hive ODSETL")]),t._v(" "),n("h2",{attrs:{id:"_2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-"}},[t._v("#")]),t._v(" 2 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1910),alt:"image-20200426005707333"}})]),t._v(" "),n("p",[t._v("1")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1911),alt:"image-20200426005715680"}})]),t._v(" "),n("ol",[n("li",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("2")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1912),alt:"image-20200426005743034"}})]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1913),alt:"image-20200426005802071"}})]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1914),alt:"image-20200426005808500"}})]),t._v(" "),n("p",[t._v("4")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1915),alt:"image-20200426005815737"}})]),t._v(" "),n("ol",[n("li",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1916),alt:"image-20200426005822545"}})]),t._v(" "),n("p",[t._v("5")]),t._v(" "),n("p",[t._v("2      ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1917),alt:"image-20200426005828396"}})]),t._v(" "),n("p",[t._v("6")]),t._v(" "),n("h2",{attrs:{id:"_3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-"}},[t._v("#")]),t._v(" 3.   ")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("InmonKimball")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1918),alt:"image-20200426005835873"}})]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1919),alt:"image-20200426005842986"}})]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("****ETL")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1920),alt:"image-20200426005850439"}})]),t._v(" "),n("h2",{attrs:{id:"_4-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-"}},[t._v("#")]),t._v(" 4.")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("dw_user_basic_infoods_game_create  ods_role_create ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("h6",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1921),alt:"image-20200426005906856"}})]),t._v(" "),n("h6",{attrs:{id:"_2hive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2hive"}},[t._v("#")]),t._v(" 2hive")]),t._v(" "),n("p",[t._v(".xlsx")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("user_id")])]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")])]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("job_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("role_create_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")])]),t._v(" "),n("tr",[n("td",[t._v("role_create_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")])])])]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_role_login_merge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id                 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id               "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id                 string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user_id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id                 string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name               string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\njob_name                string     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_create_date        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_create_time        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("p",[t._v("")]),t._v(" "),n("p",[t._v("odsdw")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nonstrict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("auto"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("auto"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inputbytes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("524288")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#maptask5")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("auto"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("files"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_role_login_merge "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("job_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("job_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-01-01'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_time "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1546300800")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_time  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_login \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("full")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" ods_role_create t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("p",[t._v(""),n("strong",[t._v(" ods_user_login ods_role_create")]),t._v(" ods_user_login  ods_role_create ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(" plat_id "),n("strong",[t._v("plat_id + user_id + role_id")]),t._v("")]),t._v(" "),n("p",[t._v(" 2019-01-01 ")]),t._v(" "),n("p",[t._v(" where role_create_date in ('2019-10-01','2019-01-01') dw_role_login_merge")]),t._v(" "),n("h6",{attrs:{id:"_3shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shelldw"}},[t._v("#")]),t._v(" 3shelldw")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/hadoop/bin/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" dw_role_login_merge.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \n\necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\ncreate database if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\nset hive.exec.dynamic.partition=true; \nset hive.exec.dynamic.partition.mode=nonstrict; \nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=524288;\nset hive.exec.mode.local.auto.input.files.max=5;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".dw_role_login_merge;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".dw_role_login_merge(\nplat_id                 int        comment '',\nserver_id               int        comment '',\nchannel_id              int        comment '',\nuser_id                 string     comment 'user_id',\nrole_id                 string     comment 'ID',\nrole_name               string     comment '',\njob_name                string     comment '',\nrole_create_date        date       comment 'yyyy-MM-dd',\nrole_create_time        int        comment ''\n) \ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS orc tblproperties ('orc.compress'='SNAPPY');\n\ninsert overwrite table dw_role_login_merge partition(part_date) \nselect plat_id,server_id,channel_id,user_id,role_id,role_name,job_name,role_create_date,\nmin(role_create_time) as role_create_time,part_date\nfrom  \n(\n  select \n  case when t1.channel_id is null then t.channel_id else t1.channel_id end as channel_id,\n  case when t1.plat_id is null then t.plat_id else t1.plat_id end as plat_id,\n  case when t1.server_id is null then t.server_id else t1.server_id end as server_id,\n  case when t1.user_id is null then t.user_id else t1.user_id end as user_id,\n  case when t1.role_id is null then t.role_id else t1.role_id end as role_id,\n  case when t1.role_name is null then t.role_name else t1.role_name end as role_name,\n  case when t1.job_name is null then '' else t1.job_name end as job_name,\n  case when from_unixtime(t1.event_time,'yyyy-MM-dd') is null then '2019-01-01' else from_unixtime(t1.event_time,'yyyy-MM-dd') end as role_create_date,\n  case when t1.event_time is null then 1546300800 else t1.event_time  end as role_create_time,\n  t.part_date\n  from\n  (\n    select channel_id,plat_id,server_id,user_id,role_id,role_name,part_date\n    from ods_user_login \n    group by channel_id,plat_id,server_id,user_id,role_id,role_name,part_date\n  ) t \n  full outer join ods_role_create t1 on (t1.plat_id=t.plat_id and t1.user_id=t.user_id and t1.role_id=t.role_id and t.part_date = t1.part_date)\n) t\ngroup by channel_id,plat_id,server_id,user_id,role_id,role_name,job_name,role_create_date,part_date;\n\"")]),t._v("\n\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sh dw_role_login_merge.sh\n")])])]),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h6",{attrs:{id:"_1-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1922),alt:"image-20200426005952009"}})]),t._v(" "),n("p",[t._v(" dw_user_basic_info dw_ .xlsx")]),t._v(" "),n("h6",{attrs:{id:"_2hive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2hive"}},[t._v("#")]),t._v(" 2hive")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dw_user_basic_info")]),t._v(" "),n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ip")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("job_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("()")]),t._v(" "),n("td")])])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("create table dw_user_basic_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id             int       comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nserver_id           int       comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nchannel_id          int       comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nuser_id             string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),t._v(",\ndevice_brand        string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\ndevice_type         string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nclient_ip          string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ip'")]),t._v(",\nrole_id             string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),t._v(",\nrole_name           string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\njob_name            string    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nrole_create_date    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),t._v("      comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),t._v(",\nrole_create_time    int       comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nreg_date            "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),t._v("      comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\nreg_time            int       comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(",\noperating_version   String    comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'()'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" comment "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nROW FORMAT DELIMITED FIELDS TERMINATED BY "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LINES")]),t._v(" TERMINATED BY "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[t._v("\\n")]),t._v("'")]),t._v("  \nSTORED AS orc tblproperties "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_user_basic_info\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nrole_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" operating_system\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" \n         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" channel_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" operating_system\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("operating_system\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client_ip "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client_ip "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-01-01'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_time "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1546300800")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("operating_system "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("operating_system "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" operating_system\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("operating_system\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("operating_system\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("operating_system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n           ROW_NUMBER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" event_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("asc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn \n           "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_game_create\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" rn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t  \n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("full")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_create_time\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          ROW_NUMBER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" role_create_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("asc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_role_login_merge \n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" rn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nrole_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" operating_system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("p",[t._v(" ods_game_create  dw_role_login_merge  ods_game_create  channel_id + plat_id + user_id ")]),t._v(" "),n("p",[t._v(" dw_role_login_merge  plat_id + server_id + user_id + role_id")]),t._v(" "),n("p",[t._v(" dw_user_basic_info ")]),t._v(" "),n("p",[t._v(" case when channel_id=0 then 1 when plat_id=0 and channel_id=0 then 1 else channel_id end as channel_id ")]),t._v(" "),n("h6",{attrs:{id:"_3shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shelldw"}},[t._v("#")]),t._v(" 3shelldw")]),t._v(" "),n("p",[t._v("node03")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim dw_user_basic_info.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \n\necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\ncreate database if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\nset hive.exec.dynamic.partition=true; \nset hive.exec.dynamic.partition.mode=nonstrict; \nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=524288;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".dw_user_basic_info;\n\ncreate table  if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".dw_user_basic_info(\nplat_id             int       comment '',\nserver_id           int       comment '',\nchannel_id          int       comment '',\nuser_id             string    comment 'ID',\ndevice_brand        string    comment '',\ndevice_type         string    comment '',\nclient_ip          string    comment 'ip',\nrole_id             string    comment 'id',\nrole_name           string    comment '',\njob_name            string    comment '',\nrole_create_date    date      comment 'yyyy-MM-dd',\nrole_create_time    int       comment '',\nreg_date            date      comment '',\nreg_time            int       comment '',\noperating_version   String    comment '()'\n) comment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'  \nSTORED AS orc tblproperties ('orc.compress'='SNAPPY');\n\ninsert overwrite table dw_user_basic_info\nselect plat_id, server_id, channel_id, user_id, device_brand, device_type, client_ip, \nrole_id, role_name, job_name, role_create_date, role_create_time, reg_date,reg_time, operating_system\nfrom \n(\n  select case when channel_id=0 then 1 \n         when plat_id=0 and channel_id=0 then 1\n         else channel_id end as channel_id,\n  plat_id, server_id, user_id, device_brand, device_type, client_ip,\n  role_id, role_name, job_name, role_create_date, role_create_time, reg_date,reg_time, operating_system\n  from \n  (\n    select t.channel_id,t.plat_id, t.server_id, t.user_id, t.device_brand, t.device_type, t.client_ip,\n    t.role_id, t.role_name, t.job_name, t.role_create_date, t.role_create_time, t.reg_date, t.reg_time, t.operating_system\n    from \n    (\n      select \n      case when t.channel_id is null then t1.channel_id else t.channel_id end as channel_id,\n      case when t.plat_id is null then t1.plat_id else t.plat_id end as plat_id,\n      case when t1.server_id is null then t.server_id else t1.server_id end as server_id,\n      case when t.user_id is null then t1.user_id else t.user_id end as user_id,\n      case when t.device_brand is null then '' else t.device_brand end as device_brand,\n      case when t.device_type is null then '' else t.device_type end as device_type,\n      case when t.client_ip is null then '' else t.client_ip end as client_ip,\n      t1.role_id,t1.role_name,t1.job_name,t1.role_create_date,t1.role_create_time,\n      case when t.reg_date is null then '2019-01-01' else t.reg_date end as reg_date, \n      case when t.reg_time is null then 1546300800 else t.reg_time end as reg_time,\n      case when t.operating_system is null then '' else t.operating_system end as operating_system\n      from\n      (\n        select t.channel_id, server_id,t.plat_id,t.user_id,t.device_brand,t.device_type,t.client_ip,\n        from_unixtime(t.event_time,'yyyy-MM-dd') as reg_date,t.event_time as reg_time,t.operating_system\n        from \n        (\n          select channel_id, plat_id, user_id, server_id, device_brand, device_type, client_ip, event_time,operating_system\n          from \n          (\n           select channel_id, plat_id, user_id, server_id, device_brand, device_type, client_ip, event_time,operating_system,\n           ROW_NUMBER() OVER(PARTITION BY channel_id, plat_id, user_id ORDER BY event_time asc) AS rn \n           from ods_game_create\n          ) t where rn=1\n        ) t  \n      ) t\n      full outer join \n      (\n        select channel_id,plat_id,server_id,user_id,role_id,role_name,job_name,role_create_date,role_create_time\n        from\n        (\n          select channel_id,plat_id,server_id,user_id,role_id,role_name,job_name,role_create_date,role_create_time,\n          ROW_NUMBER() OVER(PARTITION BY plat_id,server_id,user_id,role_id ORDER BY role_create_time asc) AS rn\n          from dw_role_login_merge \n        ) t where rn=1\n      ) t1 on (t.plat_id=t1.plat_id and t.user_id=t1.user_id)\n    ) t \n  ) t \n) t \ngroup by plat_id, server_id, channel_id, server_id, user_id, device_brand, device_type, client_ip, \nrole_id, role_name, job_name, role_create_date, role_create_time, reg_date, reg_time, operating_system;\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" dw_user_basic_info.sh \n")])])]),n("h2",{attrs:{id:"_5-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-"}},[t._v("#")]),t._v(" 5 ")]),t._v(" "),n("h4",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h5",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1923),alt:"image-20200426010013779"}})]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("h5",{attrs:{id:"_2hive-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2hive-2"}},[t._v("#")]),t._v(" 2hive")]),t._v(" "),n("p",[t._v(".xlsx")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dw_user_behavior_login")]),t._v(" "),n("td",[t._v("login_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")])]),t._v(" "),n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("user_id")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("online_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("login_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("source")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("1,234")]),t._v(" "),n("td")])])]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_user_behavior_login "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nlogin_date      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nplat_id         string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id         string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user_id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id         string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name       string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nonline_times    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlogin_times     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nsource          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1,234'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("  \nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n\ndw_user_behavior_login\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_user_behavior_login "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nROW_NUMBER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" source "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("asc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" online_time"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("86400")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" online_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" op_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" online_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("op_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_login  \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" online_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("op_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("86400")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_recharge \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("86400")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_fight_power \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("86400")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_level_up \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" rn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("p",[t._v(" online_times 86400")]),t._v(" "),n("p",[t._v(" ROW_NUMBER union  source ")]),t._v(" "),n("h5",{attrs:{id:"_3shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shelldw"}},[t._v("#")]),t._v(" 3shellDW")]),t._v(" "),n("p",[t._v("node03")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim dw_user_behavior_login.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\ncreate database if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\nset hive.exec.dynamic.partition=true; \nset hive.exec.dynamic.partition.mode=nonstrict; \nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=524288;\nset hive.exec.mode.local.auto.input.files.max=5;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".dw_user_behavior_login;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".dw_user_behavior_login (\nlogin_date      date    comment  'yyyy-MM-dd',\nplat_id         string  comment  '',\nserver_id       int     comment  '',\nuser_id         string  comment  'user_id',\nrole_id         string  comment  'ID',\nrole_name       string  comment  '',\nonline_times    int     comment  '',\nlogin_times     int     comment  '' ,\nsource          int     comment  '1,234'\n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'  \nSTORED AS orc tblproperties ('orc.compress'='SNAPPY'); \n\ninsert overwrite table dw_user_behavior_login partition(part_date) \nselect part_date as login_date, plat_id, server_id, user_id, role_id, role_name, online_times, login_times, source,part_date\nfrom (\nselect plat_id, server_id, user_id, role_id, role_name, online_times, source, login_times,\nROW_NUMBER() OVER(PARTITION BY plat_id, server_id, user_id, role_id, role_name ORDER BY source asc) AS rn ,part_date\nfrom \n(\n  select plat_id, server_id, user_id, role_id, role_name, \n  sum(case when online_time>86400 then 0 else online_time end) as online_times, 1 as source, sum(case when op_type=1 then 1 else 0 end) as login_times,part_date\n  from \n  (\n    select event_time, plat_id, server_id, user_id, role_id, role_name, online_time,op_type,part_date\n    from ods_user_login  \n    group by event_time, plat_id, server_id, user_id, role_id, role_name, online_time,op_type,part_date\n  ) t \n  group by plat_id, server_id, user_id, role_id, role_name,part_date\n  union all \n  select plat_id, server_id, user_id, role_id, role_name, 86400 as online_times, 2 as source, 1 as login_times,part_date\n  from ods_role_recharge \n  union all \n  select plat_id, server_id,  user_id, role_id, role_name, 86400 as online_times, 3 as source, 1 as login_times,part_date\n  from ods_fight_power \n  union all \n  select plat_id, server_id, user_id, role_id, role_name, 86400 as online_times, 4 as source, 1 as login_times,part_date\n  from ods_role_level_up \n) t \n) t where rn=1;\n\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_6-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-"}},[t._v("#")]),t._v(" 6 ")]),t._v(" "),n("h3",{attrs:{id:"_6-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-"}},[t._v("#")]),t._v(" 6.1 ")]),t._v(" "),n("h4",{attrs:{id:"_1-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1924),alt:"image-20200426010030011"}})]),t._v(" "),n("p",[t._v("G")]),t._v(" "),n("p",[t._v("11")]),t._v(" "),n("h4",{attrs:{id:"_2hive-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2hive-3"}},[t._v("#")]),t._v(" 2hive")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dw_fight_power")]),t._v(" "),n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")])]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("combat_power")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")])])]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_fight_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id       string "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id       string "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name     string "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncombat_power  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\n STORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_fight_power "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("combat_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" combat_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_fight_power \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:"_3shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shelldw"}},[t._v("#")]),t._v(" 3shelldw")]),t._v(" "),n("p",[t._v("node03")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim dw_fight_power.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.dynamic.partition=true; \nset hive.exec.dynamic.partition.mode=nonstrict; \nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=524288;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".dw_fight_power;\ncreate table if not exists dw_fight_power(\nplat_id       int comment '',\nserver_id     int    comment '',\nuser_id       string comment 'ID',\nrole_id       string comment 'id',\nrole_name     string comment '',\ncombat_power  int    comment ''\n) \ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\n STORED AS orc tblproperties ('orc.compress'='SNAPPY');\n\ninsert overwrite table dw_fight_power partition(part_date) \nselect plat_id, server_id, user_id, role_id, role_name, max(combat_power) as combat_power,part_date\nfrom ods_fight_power \ngroup by plat_id, server_id, user_id, role_id, role_name,part_date;\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sh dw_fight_power.sh  \n")])])]),n("h3",{attrs:{id:"_6-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-"}},[t._v("#")]),t._v(" 6.2 ")]),t._v(" "),n("h4",{attrs:{id:"_1-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1925),alt:"image-20200426010041088"}})]),t._v(" "),n("p",[t._v("levelG")]),t._v(" "),n("h4",{attrs:{id:"_2hive-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2hive-4"}},[t._v("#")]),t._v(" 2hive")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("dw_level_up")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("plat_id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("server_id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("int")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("user_id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("ID")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("role_id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("role_name")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("role_level_after")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("int")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_level_up"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplat_id           string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id           string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id           string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name         string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_level_after  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'level'")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\n STORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_level_up "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_level_up \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:"_3shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shelldw"}},[t._v("#")]),t._v(" 3shelldw")]),t._v(" "),n("p",[t._v("node03")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim dw_level_up.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \n\necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\ncreate database if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\nset hive.exec.dynamic.partition=true; \nset hive.exec.dynamic.partition.mode=nonstrict; \nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=524288;\nset hive.exec.mode.local.auto.input.files.max=5;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".dw_level_up;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".dw_level_up(\nplat_id           string  comment '',\nserver_id         int     comment '',\nuser_id           string  comment 'ID',\nrole_id           string  comment 'id',\nrole_name         string  comment '',\nrole_level_after  int     comment ''\n) \ncomment 'level'\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\n STORED AS orc tblproperties ('orc.compress'='SNAPPY');\n\ninsert overwrite table dw_level_up partition(part_date) \nselect plat_id, server_id, user_id, role_id, role_name, max(level_after) as role_level_after,part_date\nfrom ods_role_level_up \ngroup by plat_id, server_id, user_id, role_id, role_name,part_date;\n\"")]),t._v("\n\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sh dw_level_up.sh \n")])])]),n("h3",{attrs:{id:"_6-3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-"}},[t._v("#")]),t._v(" 6.3    ")]),t._v(" "),n("h4",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1926),alt:"image-20200426010052043"}})]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:"_2hive-5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2hive-5"}},[t._v("#")]),t._v(" 2hive")]),t._v(" "),n("p",[t._v(".xlsx")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dw_user_behavior_info")]),t._v(" "),n("td",[t._v("source")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("1,234")])]),t._v(" "),n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("login_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("user_id")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("online_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("job_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ip")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("recharge_amount")]),t._v(" "),n("td",[t._v("double")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("acer_count")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("combat_power")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_level_after")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("pay_vip_level")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("vip_level")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("acer_stock")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("pay_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("login_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")])])]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_user_behavior_info "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nsource                  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1,234'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nplat_id                 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nchannel_id              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nserver_id               "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlogin_date              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuser_id                 string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user_id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_id                 string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_name               string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nonline_times            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_create_date        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_create_time        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\njob_name                string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nreg_date                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nreg_time                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nclient_ip               string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ip'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_brand            string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndevice_type             string          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrecharge_amount         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nacer_count              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncombat_power            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nrole_level_after        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npay_vip_level           "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vip_level'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nacer_stock              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \npay_times               "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlogin_times            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\noperating_system      string             "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\nPARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("  \nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" dw_user_behavior_info "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\na"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("job_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ne"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("combat_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_vip_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("acer_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" operating_system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_login \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" a\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" dw_user_basic_info b "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" acer_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_recharge \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" e "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" e "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("combat_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" combat_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_fight_power\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" f "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_level_up \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" g "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v(" dw_user_behavior_login BOSS")]),t._v(" "),n("p",[t._v(" dw_user_basic_info  dw_user_basic_info ")]),t._v(" "),n("p",[t._v(" ods_role_recharge ")]),t._v(" "),n("p",[t._v(" dw_fight_power  dw_level_up ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:"_3shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shelldw"}},[t._v("#")]),t._v(" 3shelldw")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim dw_user_behavior_info.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\n\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \n\necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\ncreate database if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\nset hive.exec.dynamic.partition=true;\nset hive.exec.dynamic.partition.mode=nonstrict;\nset hive.exec.mode.local.auto=true;\nset hive.exec.mode.local.auto.inputbytes.max=524288;\nset hive.exec.mode.local.auto.input.files.max=5;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".dw_user_behavior_info;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".dw_user_behavior_info (\nsource                  int             comment      '1,234',\nplat_id                 int             comment      '',\nchannel_id              int             comment      '',\nserver_id               int             comment      '',\nlogin_date              date            comment      'yyyy-MM-dd',\nuser_id                 string          comment      'user_id',\nrole_id                 string          comment      'ID',\nrole_name               string          comment      '',\nonline_times            int             comment      '',\nrole_create_date        date            comment      'yyyy-MM-dd',\nrole_create_time        int             comment      '',\njob_name                string          comment      '',\nreg_date                date            comment      '',\nreg_time                int             comment      '',\nclient_ip               string          comment 'ip',\ndevice_brand            string          comment      '',\ndevice_type             string          comment      '',\nrecharge_amount         double          comment      '',\nacer_count              int             comment      '',\ncombat_power            int             comment      '',\nrole_level_after        int             comment      '',\npay_vip_level           int             comment      'vip_level',\nacer_stock              int             comment      '', \npay_times               int             comment      '' ,\nlogin_times            int             comment      '' ,\noperating_system      string             comment      '' \n)\ncomment ''\nPARTITIONED BY(part_date date)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'  \nSTORED AS orc tblproperties ('orc.compress'='SNAPPY'); \n\ninsert overwrite table dw_user_behavior_info partition(part_date)\nselect a.source,\na.plat_id,b.channel_id,a.server_id,a.login_date,a.user_id,a.role_id,b.role_name,a.online_times,\nb.role_create_date,b.role_create_time,b.job_name,b.reg_date,b.reg_time,b.client_ip,b.device_brand,b.device_type,\ne.recharge_amount,e.acer_count,f.combat_power,g.role_level_after,\n0 as pay_vip_level, e.acer_stock, pay_times, a.login_times, 0 as operating_system,a.part_date\nfrom \n(\n  select login_date, plat_id, server_id, user_id, role_id, sum(online_times) as online_times, source, sum(login_times) as login_times,part_date\n  from dw_user_behavior_login \n  group by login_date, plat_id, server_id, user_id, role_id,source,part_date\n) a\nleft outer join dw_user_basic_info b on (b.plat_id=a.plat_id and b.user_id=a.user_id and b.role_id=a.role_id)\nleft outer join \n(\n  select plat_id, user_id, role_id, sum(recharge_amount) as recharge_amount, sum(acer_count) as acer_count,\n  max(acer_count) as acer_stock, count(1) as pay_times,part_date\n  from \n  (\n    select event_time, plat_id, user_id, role_id, role_name, recharge_amount, acer_count,part_date\n    from ods_role_recharge \n    group by event_time, plat_id, user_id, role_id, role_name, recharge_amount, acer_count,part_date\n  ) e group by plat_id, user_id, role_id,part_date\n) e on (e.plat_id=a.plat_id and e.user_id=a.user_id and e.role_id=a.role_id and e.part_date = a.part_date)\nleft outer join \n(\n  select plat_id, user_id, role_id, max(combat_power) as combat_power,part_date\n  from dw_fight_power\n  group by plat_id, user_id, role_id,part_date\n) f on (f.plat_id=a.plat_id and f.user_id=a.user_id and f.role_id=a.role_id and f.part_date = a.part_date)\nleft outer join \n(\n  select plat_id, user_id, role_id, max(role_level_after) as role_level_after,part_date\n  from dw_level_up \n  group by plat_id, user_id, role_id,part_date\n) g on (g.plat_id=a.plat_id and g.user_id=a.user_id and g.role_id=a.role_id and g.part_date = a.part_date)\n;\n\n\"")]),t._v("\n\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sh dw_user_behavior_info.sh 2019-10-01\n")])])]),n("h2",{attrs:{id:"_7-shelldw"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-shelldw"}},[t._v("#")]),t._v(" 7 shelldw")]),t._v(" "),n("p",[t._v("node03dwshell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin\n\nvim execute_dw.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" m "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" dw_role_login_merge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh dw_user_basic_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh dw_user_behavior_login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh dw_fight_power"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh dw_level_up"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh dw_user_behavior_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n echo $m\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sh $m \ndone\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sh execute_dw.sh\n")])])]),n("h2",{attrs:{id:"res"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#res"}},[t._v("#")]),t._v(" res")]),t._v(" "),n("h2",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("h3",{attrs:{id:"_1-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-"}},[t._v("#")]),t._v(" 1.1 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("       "),n("img",{attrs:{src:a(1927),alt:"image-20200520163606933"}})]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("353")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("**** ")]),t._v(" "),n("p",[t._v("****")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1928),alt:"image-20200520163622841"}})]),t._v(" "),n("h3",{attrs:{id:"_1-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-"}},[t._v("#")]),t._v(" 1.2 ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1929),alt:"image-20200520163703746"}})]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("......")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("......")]),t._v(" "),n("p",[t._v("()(//)()")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("?\n\n \nnosql\nmysqloracle\n\n")])])]),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("4w "),n("strong",[t._v("WHO();WHEN();WHERE();WHAT()")])]),t._v(" "),n("p",[t._v("WHO()ID")]),t._v(" "),n("p",[t._v("WHEN();")]),t._v(" "),n("p",[t._v("WHERE()+;1,0.80.7")]),t._v(" "),n("p",[t._v("WHAT()10.850.7")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("=")])]),t._v(" "),n("h3",{attrs:{id:"_1-3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-"}},[t._v("#")]),t._v(" 1.3 ")]),t._v(" "),n("p",[t._v("ods")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(" dw_user_basic_info  dw_user_behavior_info ")]),t._v(" "),n("p",[t._v("dw_user_basic_info")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("dw_user_basic_info")]),t._v(" "),n("th",[t._v("plat_id")]),t._v(" "),n("th",[t._v("string")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ip")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("id")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("job_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("()")]),t._v(" "),n("td")])])]),t._v(" "),n("p",[t._v("dw_user_behavior_info")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")]),t._v(" "),n("th",[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("dw_user_behavior_info")]),t._v(" "),n("td",[t._v("source")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("1,234")])]),t._v(" "),n("tr",[n("td",[t._v("plat_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("channel_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("server_id")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("login_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("user_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("user_id")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_id")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ID")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("online_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("yyyy-MM-dd")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_create_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("job_name")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_date")]),t._v(" "),n("td",[t._v("date")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("reg_time")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("client_ip")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("ip")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_brand")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("device_type")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("recharge_amount")]),t._v(" "),n("td",[t._v("double")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("acer_count")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("combat_power")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("role_level_after")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("pay_vip_level")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("vip_level")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("acer_stock")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("pay_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("login_times")]),t._v(" "),n("td",[t._v("int")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")]),t._v(" "),n("tr",[n("td",[t._v("operating_system")]),t._v(" "),n("td",[t._v("string")]),t._v(" "),n("td",[t._v("")]),t._v(" "),n("td")])])]),t._v(" "),n("p",[t._v("dw_user_basic_infodw_user_behavior_info "),n("strong",[t._v("")])]),t._v(" "),n("h3",{attrs:{id:"_1-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4"}},[t._v("#")]),t._v(" 1.4")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(1930),alt:"image-20200520164434735"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1931),alt:"image-20200520164504586"}})]),t._v(" "),n("h4",{attrs:{id:"sql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql"}},[t._v("#")]),t._v(" sql")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" login_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" login_times\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_basic_info "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" reg_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-04'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-04'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_1-5-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-"}},[t._v("#")]),t._v(" 1.5")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:"sql-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql-2"}},[t._v("#")]),t._v(" sql")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" login_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" login_times\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_basic_info "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" reg_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-04'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-04'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_1-6shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6shell"}},[t._v("#")]),t._v(" 1.6shell")]),t._v(" "),n("p",[t._v("node03shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin\n\nvim res_user_basic_count.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_basic_count;\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_basic_count as \nselect t.reg_date,t.server_id, reg_users, login_users, recharge_amount, login_times\nfrom \n(\n  select reg_date,server_id,count(distinct user_id) as reg_users\n  from dw_user_basic_info  where reg_date = '$part_date'\n  group by reg_date,server_id\n) t \nleft outer join \n(\n  select login_date,server_id,count(distinct user_id) as login_users,sum(recharge_amount) as recharge_amount,sum(login_times) as login_times\n  from dw_user_behavior_info  where part_date = '$part_date'\n  group by login_date,server_id\n) t1 on (t1.login_date=t.reg_date and t1.server_id=t.server_id);\n\n\ndrop table if exists \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_date_brand_type;\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_date_brand_type as \nselect t.reg_date,t.device_brand,t.device_type, reg_users, login_users, recharge_amount, login_times\nfrom \n(\n  select reg_date,device_brand,device_type,count(distinct user_id) as reg_users\n  from dw_user_basic_info where reg_date = '$part_date'\n  group by reg_date,device_brand,device_type\n) t \nleft outer join \n(\n  select login_date,device_brand,device_type,count(distinct user_id) as login_users,sum(recharge_amount) as recharge_amount,sum(login_times) as login_times\n  from dw_user_behavior_info where part_date = '$part_date'\n  group by login_date,device_brand,device_type\n) t1 on (t1.login_date =t.reg_date and t1.device_brand=t.device_brand and t1.device_type=t.device_type);\n\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sh res_user_basic_count.sh 2019-10-04\n")])])]),n("h2",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("h3",{attrs:{id:"_2-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-"}},[t._v("#")]),t._v(" 2.1 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("/")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("ip")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("500")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("ip")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}}),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),n("h3",{attrs:{id:"_2-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-"}},[t._v("#")]),t._v(" 2.2 ")]),t._v(" "),n("p",[n("strong",[t._v("DAU")]),t._v("(Daily Active User) DAUUV")]),t._v(" "),n("p",[n("strong",[t._v("DNU")]),t._v("Daily New Users ")]),t._v(" "),n("p",[n("strong",[t._v("AU")]),t._v("Active Users\nDAU()WAU(),MAU()")]),t._v(" "),n("p",[n("strong",[t._v("PU")]),t._v(" ( Paying User")]),t._v(" "),n("p",[n("strong",[t._v("APA")]),t._v("Active Payment Account")]),t._v(" "),n("p",[n("strong",[t._v("ARPU")]),t._v("(Average Revenue Per User)  /AU ")]),t._v(" "),n("p",[n("strong",[t._v("ARPPU")]),t._v(" (Average Revenue Per Paying User)  /APA ")]),t._v(" "),n("p",[n("strong",[t._v("PUR")]),t._v("(Pay User Rate) APA/AU ")]),t._v(" "),n("h3",{attrs:{id:"_2-3-ltv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-ltv"}},[t._v("#")]),t._v(" 2.3 LTV")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("LTV")]),t._v("")]),t._v(" "),n("p",[t._v("LTV"),n("strong",[t._v("")]),t._v("LTVLTV")]),t._v(" "),n("p",[t._v("LTV")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1932),alt:"image-20200520165057110"}})]),t._v(" "),n("p",[t._v("LTV")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("1LTV=111")]),t._v("2LTV=222....")]),t._v(" "),n("p",[t._v(", LTV ")]),t._v(" "),n("h4",{attrs:{id:"ltv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ltv"}},[t._v("#")]),t._v(" LTV")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_user_ltv "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nt1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pay_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recharge_amount "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" operating_system\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_basic_info t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_recharge  \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("LVTltv365")]),t._v(" "),n("p",[t._v("1LTV2LTV3LTV4LTV5LTV6LTV7LTV10LTV14LTV30LTV2LTV3LTV6LTV9LTV1LTV")]),t._v(" "),n("p",[t._v(" tmp_user_ltv ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("LTV")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("LTV")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h4",{attrs:{id:"ltv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ltv"}},[t._v("#")]),t._v(" LTV")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nltv_1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ltv_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_14"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_30"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_2m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_3m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_6m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_9m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_1year"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nltv_1_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ltv_2_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_3_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_4_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_5_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_6_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_7_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_10_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_14_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_30_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_2m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nltv_3m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_6m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_9m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ltv_1year_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_ltv \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("pay_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_14"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_30"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("59")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_2m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_3m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("179")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_6m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("269")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_9m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("355")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_1year\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_ltv \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("pay_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_1_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_2_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_3_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_4_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_5_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_6_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_7_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_10_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_14_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_30_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("59")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_2m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_3m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("179")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_6m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("269")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_9m_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("date_add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("355")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ltv_1year_users\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pay_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_ltv \n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pay_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-4-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-"}},[t._v("#")]),t._v(" 2.4 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v(" dw_user_behavior_info  acer_countacer_stock  "),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("LAG")]),t._v(" "),n("p",[t._v("LAG(col,n,DEFAULT) n")]),t._v(" "),n("p",[t._v("n1nNULLNULL")]),t._v(" "),n("h4",{attrs:{id:"sql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql"}},[t._v("#")]),t._v(" sql")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \nacer_count "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" buy_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" consumer"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" consumer "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" consumer_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" consumer"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" abs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("consumer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("acer_count "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" give_num\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  last_acer_stock"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("acer_stock "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" consumer\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    LAG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" plat_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" last_acer_stock\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" acer_stock\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_2-5-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-"}},[t._v("#")]),t._v(" 2.5 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("recharge_purpose ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" buy_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_recharge \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-6-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-"}},[t._v("#")]),t._v(" 2.6 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1933),alt:"image-20200520165553364"}})]),t._v(" "),n("p",[t._v("LAG")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("buy_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nlast_acer_stock"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("acer_count "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" consumer_num\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("buy_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  LAG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" last_acer_stock\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buy_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" buy_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" acer_count\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" buy_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acer_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" acer_count\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_recharge \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("recharge_purpose\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" level_after\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_role_level_up \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recharge_purpose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("level_after\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"_2-7shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-7shell"}},[t._v("#")]),t._v(" 2.7shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_pay.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".tmp_user_ltv;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".tmp_user_ltv as \nselect t.channel_id,t.plat_id,t.server_id, \nt.user_id,t.device_brand,t.device_type,t.reg_date,t.reg_time,t.role_id,t.role_name,t.role_create_date,t.role_create_time,\nt1.pay_date,case when t1.recharge_amount is null then 0 else t1.recharge_amount end as recharge_amount, 0 as operating_system\nfrom dw_user_basic_info t \nleft outer join \n(\n  select channel_id,plat_id,user_id,server_id,from_unixtime(event_time,'yyyy-MM-dd') as pay_date,role_id,sum(recharge_amount) as recharge_amount\n  from ods_role_recharge  \n  group by channel_id,plat_id,user_id,server_id,from_unixtime(event_time,'yyyy-MM-dd'),role_id\n) t1 on (t1.channel_id=t.channel_id and t1.plat_id=t.plat_id and t1.server_id=t.server_id and t1.user_id=t.user_id and t1.role_id=t.role_id);\n\n\ndrop table if exists \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_ltv_count;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_ltv_count as \nselect t.plat_id,t.channel_id,t.event_date, t.reg_users,\nltv_1, ltv_2,ltv_3,ltv_4,ltv_5,ltv_6,ltv_7,ltv_10,ltv_14,ltv_30,ltv_2m,ltv_3m,ltv_6m,ltv_9m,ltv_1year,\nltv_1_users, ltv_2_users,ltv_3_users,ltv_4_users,ltv_5_users,ltv_6_users,ltv_7_users,ltv_10_users,ltv_14_users,ltv_30_users,ltv_2m_users,\nltv_3m_users,ltv_6m_users,ltv_9m_users,ltv_1year_users\nfrom \n(\n  select plat_id,channel_id,reg_date as event_date, count(distinct user_id) as reg_users\n  from tmp_user_ltv \n  group by plat_id,channel_id,reg_date\n) t \nleft outer join \n(\n  select plat_id,channel_id,reg_date as event_date, \n  sum(case when reg_date=pay_date then recharge_amount else 0 end) as ltv_1, \n  sum(case when pay_date<=date_add(reg_date,1) then recharge_amount else 0 end) as ltv_2,\n  sum(case when pay_date<=date_add(reg_date,2) then recharge_amount else 0 end) as ltv_3,\n  sum(case when pay_date<=date_add(reg_date,3) then recharge_amount else 0 end) as ltv_4,\n  sum(case when pay_date<=date_add(reg_date,4) then recharge_amount else 0 end) as ltv_5,\n  sum(case when pay_date<=date_add(reg_date,5) then recharge_amount else 0 end) as ltv_6,\n  sum(case when pay_date<=date_add(reg_date,6) then recharge_amount else 0 end) as ltv_7,\n  sum(case when pay_date<=date_add(reg_date,9) then recharge_amount else 0 end) as ltv_10,\n  sum(case when pay_date<=date_add(reg_date,13) then recharge_amount else 0 end) as ltv_14,\n  sum(case when pay_date<=date_add(reg_date,29) then recharge_amount else 0 end) as ltv_30,\n  sum(case when pay_date<=date_add(reg_date,59) then recharge_amount else 0 end) as ltv_2m,\n  sum(case when pay_date<=date_add(reg_date,89) then recharge_amount else 0 end) as ltv_3m,\n  sum(case when pay_date<=date_add(reg_date,179) then recharge_amount else 0 end) as ltv_6m,\n  sum(case when pay_date<=date_add(reg_date,269) then recharge_amount else 0 end) as ltv_9m,\n  sum(case when pay_date<=date_add(reg_date,355) then recharge_amount else 0 end) as ltv_1year\n  from tmp_user_ltv \n  where recharge_amount>0\n  group by plat_id,channel_id,reg_date\n) t1 on (t1.plat_id=t.plat_id and t1.channel_id=t.channel_id and t1.event_date=t.event_date)\nleft outer join \n(\n  select plat_id,channel_id,reg_date as event_date,\n  count(case when reg_date=pay_date then user_id end) as ltv_1_users, \n  count(case when pay_date=date_add(reg_date,1)   then user_id end) as ltv_2_users,\n  count(case when pay_date=date_add(reg_date,2)   then user_id end) as ltv_3_users,\n  count(case when pay_date=date_add(reg_date,3)   then user_id end) as ltv_4_users,\n  count(case when pay_date=date_add(reg_date,4)   then user_id end) as ltv_5_users,\n  count(case when pay_date=date_add(reg_date,5)   then user_id end) as ltv_6_users,\n  count(case when pay_date=date_add(reg_date,6)   then user_id end) as ltv_7_users,\n  count(case when pay_date=date_add(reg_date,9)   then user_id end) as ltv_10_users,\n  count(case when pay_date=date_add(reg_date,13)  then user_id end) as ltv_14_users,\n  count(case when pay_date=date_add(reg_date,29)  then user_id end) as ltv_30_users,\n  count(case when pay_date=date_add(reg_date,59)  then user_id end) as ltv_2m_users,\n  count(case when pay_date=date_add(reg_date,89)  then user_id end) as ltv_3m_users,\n  count(case when pay_date=date_add(reg_date,179) then user_id end) as ltv_6m_users,\n  count(case when pay_date=date_add(reg_date,269) then user_id end) as ltv_9m_users,\n  count(case when pay_date=date_add(reg_date,355) then user_id end) as ltv_1year_users\n  from \n  (\n   select plat_id,channel_id,reg_date,pay_date,user_id\n   from tmp_user_ltv \n   where recharge_amount>0\n   group by plat_id,channel_id,reg_date,pay_date,user_id\n  ) t \n  group by plat_id,channel_id,reg_date\n) t2 on (t2.plat_id=t.plat_id and t2.channel_id=t.channel_id and t2.event_date=t.event_date);\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_stock_consumer;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_stock_consumer as \nselect login_date as event_date, plat_id, \nacer_count as buy_num,\ncase when consumer>0 then consumer else 0 end as consumer_num,\ncase when consumer<0 then abs(consumer)-acer_count else 0 end as give_num\nfrom \n(\n  select login_date,plat_id,acer_count,acer_stock,\n  last_acer_stock-acer_stock as consumer\n  from \n  (\n    select login_date,plat_id,acer_count,acer_stock,\n    LAG(acer_stock,1,0) OVER(PARTITION BY plat_id ORDER BY login_date) AS last_acer_stock\n    from \n    (\n      select login_date,plat_id,sum(acer_count) as acer_count,sum(acer_stock) as acer_stock\n      from dw_user_behavior_info \n      group by login_date,plat_id\n    ) t \n  ) t \n) t ;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_consumer_hobby;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_consumer_hobby as\nselect part_date,plat_id,recharge_purpose,\ncount(order_id) as buy_times,\nsum(recharge_amount) as sum_amount\nfrom ods_role_recharge \ngroup by part_date,plat_id,recharge_purpose;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_consumer_point;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_consumer_point as \nselect part_date,plat_id,recharge_purpose,level_after,buy_times,recharge_amount,acer_count,\nlast_acer_stock-acer_count as consumer_num\nfrom \n(\n  select part_date,plat_id,recharge_purpose,level_after,buy_times,recharge_amount,acer_count,\n  LAG(acer_count,1,0) OVER(PARTITION BY plat_id,recharge_purpose ORDER BY part_date) AS last_acer_stock\n  from \n  (\n    select t.part_date,t.plat_id,t.recharge_purpose,t1.level_after,\n    sum(buy_times) as buy_times,\n    sum(recharge_amount) as recharge_amount,\n    sum(acer_count) as acer_count\n    from  \n    (\n      select part_date,plat_id,user_id,role_id,recharge_purpose,\n      count(order_id) as buy_times,\n      sum(recharge_amount) as recharge_amount,\n      sum(acer_count) as acer_count\n      from ods_role_recharge \n      group by part_date,plat_id,user_id,role_id,recharge_purpose\n    ) t \n    left outer join \n    (\n      select part_date,plat_id,user_id,role_id,max(level_after) as level_after\n      from ods_role_level_up \n      group by part_date,plat_id,user_id,role_id\n    ) t1 on (t1.part_date=t.part_date and t1.plat_id=t.plat_id and t1.user_id=t.user_id and t1.role_id=t.role_id)\n    group by t.part_date,t.plat_id,t.recharge_purpose,t1.level_after\n  ) t \n) t ;\n"')]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("sh res_user_pay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh\n")])])]),n("h2",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("1")]),t._v(" "),n("p",[t._v("303030")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_user_stay "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reg_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_create_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_basic_info t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_date "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_login \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("3456715")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_3_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_4_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_5_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_6_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_7_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_15_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_30_s\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_stay \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_stay_long.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".tmp_user_stay;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".tmp_user_stay as \nselect t.channel_id,t.plat_id,t.server_id,t.user_id,t.device_brand,t.device_type,\nt.reg_date,t.reg_time,t.role_id,t.role_name,t.role_create_date,t.role_create_time,t1.login_date \nfrom dw_user_basic_info t \nleft outer join \n(\n  select channel_id,plat_id,user_id,server_id, from_unixtime(event_time,'yyyy-MM-dd') as login_date ,role_id\n  from ods_user_login \n  group by channel_id,plat_id,user_id,server_id, from_unixtime(event_time,'yyyy-MM-dd'),role_id\n) t1 on (t1.plat_id=t.plat_id and t1.server_id=t.server_id and t1.user_id=t.user_id and t1.role_id=t.role_id);\n\ndrop table if exists \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_stay;\n\ncreate table "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_stay as \nselect plat_id,channel_id, reg_date as event_date,\ncount(distinct user_id) as reg_users,\ncount(distinct case when datediff(login_date,reg_date)=1 then user_id end) as stay_s,\ncount(distinct case when datediff(login_date,reg_date)=2 then user_id end) as stay_3_s,\ncount(distinct case when datediff(login_date,reg_date)=3 then user_id end) as stay_4_s,\ncount(distinct case when datediff(login_date,reg_date)=4 then user_id end) as stay_5_s,\ncount(distinct case when datediff(login_date,reg_date)=5 then user_id end) as stay_6_s,\ncount(distinct case when datediff(login_date,reg_date)=6 then user_id end) as stay_7_s,\ncount(distinct case when datediff(login_date,reg_date)=14 then user_id end) as stay_15_s,\ncount(distinct case when datediff(login_date,reg_date)=29 then user_id end) as stay_30_s\nfrom tmp_user_stay \ngroup by plat_id,channel_id,reg_date;\n"')]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" tmp_user_lost "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nROW_NUMBER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" login_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_login\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("137153060x=")]),t._v(" "),n("p",[t._v("137153060")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("login_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" num"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" num"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" num"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" num"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" num"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login30"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" num"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login60\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" num\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("unix_timestamp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_date_2\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_lost t \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" tmp_user_lost t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_lost.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".tmp_user_lost;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".tmp_user_lost as \nselect t.plat_id,t.channel_id,t.user_id,login_date,\nROW_NUMBER() OVER(PARTITION BY t.channel_id,t.plat_id,t.user_id ORDER BY login_date desc) AS rn\nfrom \n(\n  select plat_id,channel_id,user_id,from_unixtime(event_time,'yyyy-MM-dd') as login_date\n  from ods_user_login\n  group by plat_id,channel_id,user_id,from_unixtime(event_time,'yyyy-MM-dd')\n) t ;\n\ndrop table if exists \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_lost;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_user_lost as \nselect plat_id,channel_id,login_date as event_date, \ncount(distinct user_id) as users,\ncount(distinct case when num>=1 then user_id end) as login1,\ncount(distinct case when num>=3 then user_id end) as login3,\ncount(distinct case when num>=7 then user_id end) as login7,\ncount(distinct case when num>=15 then user_id end) as login15,\ncount(distinct case when num>=30 then user_id end) as login30,\ncount(distinct case when num>=60 then user_id end) as login60\nfrom \n(\n  select plat_id,channel_id,user_id,login_date,datediff(login_date_2,login_date)-1 as num\n  from \n  (\n    select t.plat_id,t.channel_id,t.user_id,t.login_date,\n    case when t1.login_date is null then from_unixtime(unix_timestamp(),'yyyy-MM-dd') else t1.login_date end as login_date_2\n    from tmp_user_lost t \n    left outer join tmp_user_lost t1 on (t1.plat_id=t.plat_id and t1.channel_id=t.channel_id and t1.user_id=t.user_id and t1.rn+1=t.rn)\n  ) t \n) t \ngroup by plat_id,channel_id,login_date;\n\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5"}},[t._v("#")]),t._v(" 5")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("op_type 123")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("task_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("task_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" enter_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cost_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cost_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" op_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" task_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" fail_times\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_task_log\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("task_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("task_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_mission.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".tmp_mission;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_mission as \nselect part_date,plat_id,task_type,task_id,\ncount(1) as enter_times,\nsum(cost_time) as cost_time,\ncount(case when op_type=3 then task_id end) as fail_times\nfrom ods_task_log\ngroup by part_date,plat_id,task_type,task_id;\n"')]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_6"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6"}},[t._v("#")]),t._v(" 6")]),t._v(" "),n("h3",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v(" dw_user_basic_info ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" device_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_user\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(" dw_user_behavior_info ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" active_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" login_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" play_once_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(" dw_user_behavior_info ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_3_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_4_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_5_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_6_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_7_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_15_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_30_s\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_stay \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_5-shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-shell"}},[t._v("#")]),t._v(" 5 shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin\n\nvim res_channel_count.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_channel_num;\n\ncreate table if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_channel_num as \nselect login_date,channel_id,\ncount(distinct client_ip,device_brand,device_type) as device_num,\ncount(distinct user_id) as reg_user,\ncount(distinct user_id) as active_users,\ncount(distinct case when login_times=1 then user_id end) as play_once_users,\ncount(distinct case when recharge_amount>0 then user_id end) as pay_users,\ncount(distinct user_id) as pay_user,\nsum(recharge_amount) as pay_money \nfrom dw_user_behavior_info \nwhere recharge_amount>0\ngroup by login_date,channel_id ;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_channel_stay;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_channel_stay as \nselect plat_id,channel_id, reg_date as event_date,\ncount(distinct user_id) as reg_users,\ncount(distinct case when datediff(login_date,reg_date)=1 then user_id end) as stay_s,\ncount(distinct case when datediff(login_date,reg_date)=2 then user_id end) as stay_3_s,\ncount(distinct case when datediff(login_date,reg_date)=3 then user_id end) as stay_4_s,\ncount(distinct case when datediff(login_date,reg_date)=4 then user_id end) as stay_5_s,\ncount(distinct case when datediff(login_date,reg_date)=5 then user_id end) as stay_6_s,\ncount(distinct case when datediff(login_date,reg_date)=6 then user_id end) as stay_7_s,\ncount(distinct case when datediff(login_date,reg_date)=14 then user_id end) as stay_15_s,\ncount(distinct case when datediff(login_date,reg_date)=29 then user_id end) as stay_30_s\nfrom tmp_user_stay \ngroup by plat_id,channel_id,reg_date;\n"')]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_73"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_73"}},[t._v("#")]),t._v(" 73")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:"-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-2"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("33")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("opt_one"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("opt_two"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("opt_three\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_login "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-21'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" op_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" opt_one"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" opt_two"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" opt_three\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("concat_ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("collect_list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("button_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" tt\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" button_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      ROW_NUMBER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" event_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" rn \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_panel_op t \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" ods_dim_game_button t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-03'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" rn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_name\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"shell3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell3"}},[t._v("#")]),t._v(" shell3")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_last_operate.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_last_operate;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_user_last_operate as \nselect t.plat_id,t.user_id,role_name,opt_one,opt_two,opt_three\nfrom \n(\n  select plat_id,user_id from ods_user_login where part_date='2019-10-21' and op_type=1 group by plat_id,user_id\n) t \njoin \n(\n  select plat_id,user_id, role_name,split(tt,',')[2] as opt_one, split(tt,',')[1] as opt_two, split(tt,',')[0] as opt_three\n  from \n  (\n    select plat_id,user_id,role_name,concat_ws(',',collect_list(button_id)) as tt\n    from \n    (\n      select t.plat_id,channel_id,user_id,role_id,role_name,case when t1.button_name is null then t.button_id else t1.button_name end as button_id,\n      ROW_NUMBER() OVER(PARTITION BY user_id,role_name ORDER BY event_time desc) as rn \n      from ods_panel_op t \n      left outer join ods_dim_game_button t1 on (t1.button_id=t.button_id)\n      where part_date='2019-10-03'\n    ) t \n    where rn<=3 \n    group by plat_id,user_id,role_name\n  ) t \n) t1 on (t1.plat_id=t.plat_id and t1.user_id=t.user_id);\n\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8"}},[t._v("#")]),t._v(" 8")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("monetary_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" monetary_stock\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_stock\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ROW_NUMBER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" event_time "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" rn\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_monetary_consume \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-03'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-04'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" monetary_stock"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("monetary_stock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_time\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_monetary_output\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-04'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-05'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" monetary_stock"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" rn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_virtual_coin.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_virtual_coin;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_virtual_coin as \nselect plat_id,channel_id,user_id,sum(monetary_stock) as monetary_stock\nfrom \n(\n  select plat_id,channel_id,user_id,role_id,monetary_stock\n  from \n  (\n    select plat_id,channel_id,user_id,role_id,monetary_stock,event_time,\n    ROW_NUMBER() OVER(PARTITION BY plat_id,user_id,role_id ORDER BY event_time desc) rn\n    from \n    (\n      select plat_id,channel_id,user_id,role_id,monetary_stock,event_time\n      from ods_monetary_consume \n      where part_date>='2019-10-03' and part_date<='2019-10-04' and monetary_stock>0\n      union all  \n      select plat_id,channel_id,user_id,role_id,monetary_stock,event_time\n      from ods_monetary_output\n      where part_date>='2019-10-04' and part_date<='2019-10-05' and monetary_stock>0\n    ) t \n  ) t \n  where rn=1\n) t \ngroup by plat_id,channel_id,user_id;\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_9"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9"}},[t._v("#")]),t._v(" 9")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" death_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("death_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" death_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" death_new_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("map_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" death_times\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_death_log\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-03'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("map_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_game_create\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-01'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_die_channel.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_die_channel;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_user_die_channel as \nselect t.event_date, t.plat_id,t.channel_id,t.map_id,\ncount(distinct t.user_id) as death_users, sum(death_times) as death_times,\ncount(distinct t1.user_id) as death_new_users\nfrom \n(\n  select from_unixtime(event_time,'yyyy-MM-dd') as event_date,plat_id,channel_id,user_id,map_id,\n  count(distinct log_id) as death_times\n  from ods_death_log\n  where part_date='2019-10-03'\n  group by from_unixtime(event_time,'yyyy-MM-dd'),plat_id,channel_id,user_id,map_id\n) t \nleft outer join \n(\n  select plat_id,user_id,from_unixtime(event_time,'yyyy-MM-dd') as reg_date\n  from ods_game_create\n  where part_date='2019-10-01'\n) t1 on (t1.plat_id=t.plat_id and t1.user_id=t.user_id)\ngroup by t.event_date, t.plat_id,t.channel_id,t.map_id;\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_10"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10"}},[t._v("#")]),t._v(" 10")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("30")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nshare_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" share_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" share_newusers  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" share_newusers  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" share_newusers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_2  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_2  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_3  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_3  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_4  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_4  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_5  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_5  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_6  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_6  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_7  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_7  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_10 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_10 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_15 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_15 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" stay_30 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" stay_30 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_30\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" share_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("log_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" share_times\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_share "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-11-01'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-11-05'")]),t._v("  \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" share_newusers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_30\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ddate\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_game_create\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-01'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-05'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ddate\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_share "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-01'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-05'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" share_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" \n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" ddate\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_user_login "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-01'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-05'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ddate "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_share.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_share;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_user_share as \nselect t.ddate,t.plat_id,t.channel_id,\nshare_users, share_times,\ncase when share_newusers  is null then 0 else share_newusers  end as share_newusers,\ncase when stay_2  is null then 0 else stay_2  end as stay_2,\ncase when stay_3  is null then 0 else stay_3  end as stay_3,\ncase when stay_4  is null then 0 else stay_4  end as stay_4,\ncase when stay_5  is null then 0 else stay_5  end as stay_5,\ncase when stay_6  is null then 0 else stay_6  end as stay_6,\ncase when stay_7  is null then 0 else stay_7  end as stay_7,\ncase when stay_10 is null then 0 else stay_10 end as stay_10,\ncase when stay_15 is null then 0 else stay_15 end as stay_15,\ncase when stay_30 is null then 0 else stay_30 end as stay_30\nfrom \n(\n  select from_unixtime(event_time,'yyyy-MM-dd') as ddate,plat_id,channel_id,\n  count(distinct user_id) as share_users, count(distinct event_time,log_id) as share_times\n  from ods_user_share where part_date>='2019-11-01' and part_date<='2019-11-05'  \n  group by from_unixtime(event_time,'yyyy-MM-dd'),plat_id,channel_id\n) t \nleft outer join \n(\n  select t.ddate,t.plat_id,t.channel_id,\n  count(distinct t.user_id) as share_newusers,\n  count(distinct case when datediff(t1.ddate,t.ddate)=1  then t.user_id end) as stay_2,\n  count(distinct case when datediff(t1.ddate,t.ddate)=2  then t.user_id end) as stay_3,\n  count(distinct case when datediff(t1.ddate,t.ddate)=3  then t.user_id end) as stay_4,\n  count(distinct case when datediff(t1.ddate,t.ddate)=4  then t.user_id end) as stay_5,\n  count(distinct case when datediff(t1.ddate,t.ddate)=5  then t.user_id end) as stay_6,\n  count(distinct case when datediff(t1.ddate,t.ddate)=6  then t.user_id end) as stay_7,\n  count(distinct case when datediff(t1.ddate,t.ddate)=9  then t.user_id end) as stay_10,\n  count(distinct case when datediff(t1.ddate,t.ddate)=14 then t.user_id end) as stay_15,\n  count(distinct case when datediff(t1.ddate,t.ddate)=29 then t.user_id end) as stay_30\n  from \n  (\n    select t.plat_id,channel_id,t.user_id,t.ddate\n    from \n    (\n      select plat_id,channel_id,user_id,from_unixtime(event_time,'yyyy-MM-dd') as ddate\n      from ods_game_create\n      where part_date>='2019-10-01' and part_date<='2019-10-05'\n    ) t \n    join \n    (\n      select plat_id, user_id,from_unixtime(event_time,'yyyy-MM-dd') as ddate\n      from ods_user_share where part_date>='2019-10-01' and part_date<='2019-10-05' and share_id is not null \n      group by plat_id, user_id,from_unixtime(event_time,'yyyy-MM-dd')\n    ) t1 on (t1.plat_id=t.plat_id and t1.ddate=t.ddate and t1.user_id=t.user_id)\n  ) t \n  left outer join \n  (\n    select user_id,from_unixtime(event_time,'yyyy-MM-dd') as ddate\n    from ods_user_login where part_date>='2019-10-01' and part_date<='2019-10-05'\n    group by user_id,from_unixtime(event_time,'yyyy-MM-dd')\n  ) t1 on (t1.user_id=t.user_id)\n  group by t.ddate,t.plat_id,t.channel_id\n) t1 on (t.ddate=t1.ddate and t.plat_id=t1.plat_id and t.channel_id=t1.channel_id);\n\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n\n")])])]),n("h2",{attrs:{id:"_11"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11"}},[t._v("#")]),t._v(" 11")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" levelup_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" levelup_new_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" level_after\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_game_levelup\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-03'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("from_unixtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event_time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yyyy-MM-dd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_date\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_game_create\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-10-03'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[t._v("#")]),t._v(" shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_pass.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_pass;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_user_pass as \nselect t.plat_id,t.channel_id,event_date,level_after,\ncount(distinct t.user_id) as levelup_users,\ncount(distinct t1.user_id) as levelup_new_users\nfrom \n(\n  select from_unixtime(event_time,'yyyy-MM-dd') as event_date,plat_id,channel_id,user_id,max(level_after) as level_after\n  from ods_game_levelup\n  where part_date='2019-10-03'\n  group by from_unixtime(event_time,'yyyy-MM-dd'),plat_id,channel_id,user_id\n) t \nleft outer join \n(\n  select plat_id,user_id,from_unixtime(event_time,'yyyy-MM-dd') as reg_date\n  from ods_game_create\n  where part_date='2019-10-03'\n) t1 on (t1.plat_id=t.plat_id and t1.user_id=t.user_id)\ngroup by t.plat_id,t.channel_id,event_date,level_after;\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n\n")])])]),n("h2",{attrs:{id:"_12shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12shell"}},[t._v("#")]),t._v(" 12shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin\n\nvim execute_res.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" m "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v("  res_user_basic_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_pay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_stay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_lost"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_mission"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_channel_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_last_operate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_virtual_coin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_die_channel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_share"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_pass"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sh $m\ndone\n")])])]),n("h2",{attrs:{id:"_13"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13"}},[t._v("#")]),t._v(" 13")]),t._v(" "),n("h3",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v("slowly changing dimension, SCD")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("Kimballchange trackingThe Data Warehouse Toolkit, 3rd Edition5Kimballhybrid techniques")]),t._v(" "),n("h3",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("7")]),t._v(" "),n("p",[t._v("1")]),t._v(" "),n("p",[t._v("2")]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("p",[t._v("4")]),t._v(" "),n("p",[t._v("5 ")]),t._v(" "),n("p",[t._v("6")]),t._v(" "),n("p",[t._v("7")]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("    ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1934),alt:"image-20200520180103088"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("  ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1935),alt:"image-20200520180111291"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("   ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1936),alt:"image-20200520180120650"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("     ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1937),alt:"image-20200520180128773"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("  55 ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1938),alt:"image-20200520180205807"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v(" 0 0  ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1939),alt:"image-20200520180213999"}})]),t._v(" "),n("h4",{attrs:{id:"-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#-"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("p",[t._v("23 1  23    1 ")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1940),alt:"image-20200520180219573"}})]),t._v(" "),n("h2",{attrs:{id:"_14"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_14"}},[t._v("#")]),t._v(" 14")]),t._v(" "),n("p",[t._v("Meta Data"),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v(" "),n("strong",[t._v("ETL ")]),t._v("Metadata Repository"),n("strong",[t._v("")])]),t._v(" "),n("h3",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("\n1  IT ")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v("2 ")]),t._v(" "),n("p",[t._v(" SQL")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v(" ")]),t._v(" "),n("p",[t._v("3 ")]),t._v(" "),n("h3",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("p",[t._v("1''''()")]),t._v(" "),n("p",[t._v("2SE-DWA")]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("p",[t._v("4")]),t._v(" "),n("p",[t._v("5")]),t._v(" "),n("h3",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("p",[t._v("1ETLETL")]),t._v(" "),n("p",[t._v("2")]),t._v(" "),n("p",[t._v("3")]),t._v(" "),n("p",[t._v("4")]),t._v(" "),n("p",[t._v("5")]),t._v(" "),n("p",[t._v("6pdf")]),t._v(" "),n("p",[t._v("7")]),t._v(" "),n("h3",{attrs:{id:"_4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("p",[t._v("BIjavaWebBIAtlas")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\n\n\n  \n\n\n\n  **\n    ** \n\nT+1\n  **\n  **   ** \n    **    **   **\n\n\n\n\n\n\n\n\n\nhadoop\nhive\n\n\n + \n\n\t\n\t\n\t\n\t\n\n\t\n\t\n\t  sql\n\n\t\n  **\n100W50W\n\n\t\n\napacheAtlas\n")])])]),n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" ")]),t._v(" "),n("h2",{attrs:{id:"_1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-"}},[t._v("#")]),t._v(" 1 ")]),t._v(" "),n("p",[n("strong",[t._v("dw")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\n\n\ndw   ** \nres    \n  \n\n\n\nsqlgroup by\n")])])]),n("h3",{attrs:{id:"_1-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-"}},[t._v("#")]),t._v(" 1.1 ")]),t._v(" "),n("p",[t._v("(Data Market) ")]),t._v(" "),n("p",[n("strong",[t._v("")]),t._v(""),n("strong",[t._v("sqoop")]),t._v("**mysql**PHPweb")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1941),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_1-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-"}},[t._v("#")]),t._v(" 1.2 ")]),t._v(" "),n("p",[t._v("PHP"),n("strong",[t._v("mysql")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("730mysql7304")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("PHP")]),t._v(" "),n("h3",{attrs:{id:"_1-3sql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3sql"}},[t._v("#")]),t._v(" 1.3sql")]),t._v(" "),n("p",[t._v("3456715")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_user_stay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  reg_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_s       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_3_s     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_4_s     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'4'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_5_s     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_6_s     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'6'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_7_s     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'7'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_15_s    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'15'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  stay_30_s    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'30'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_user_stay\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_3_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_4_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_5_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_6_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_7_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_15_s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" stay_30_s\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" tmp_user_stay \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_1-4shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4shell"}},[t._v("#")]),t._v(" 1.4shell")]),t._v(" "),n("p",[t._v("node03shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_stay.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_user_stay;\n\nCREATE TABLE if not exists  "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_user_stay(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  reg_users    int  COMMENT '',\n  stay_s       int  COMMENT '',\n  stay_3_s     int  COMMENT '3',\n  stay_4_s     int  COMMENT '4',\n  stay_5_s     int  COMMENT '5',\n  stay_6_s     int  COMMENT '6',\n  stay_7_s     int  COMMENT '7',\n  stay_15_s    int  COMMENT '15',\n  stay_30_s    int  COMMENT '30'\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table res_user_stay\nselect plat_id,channel_id, reg_date as event_date,\ncount(distinct user_id) as reg_users,\ncount(distinct case when datediff(login_date,reg_date)=1 then user_id end) as stay_s,\ncount(distinct case when datediff(login_date,reg_date)=2 then user_id end) as stay_3_s,\ncount(distinct case when datediff(login_date,reg_date)=3 then user_id end) as stay_4_s,\ncount(distinct case when datediff(login_date,reg_date)=4 then user_id end) as stay_5_s,\ncount(distinct case when datediff(login_date,reg_date)=5 then user_id end) as stay_6_s,\ncount(distinct case when datediff(login_date,reg_date)=6 then user_id end) as stay_7_s,\ncount(distinct case when datediff(login_date,reg_date)=14 then user_id end) as stay_15_s,\ncount(distinct case when datediff(login_date,reg_date)=29 then user_id end) as stay_30_s\nfrom tmp_user_stay \ngroup by plat_id,channel_id,reg_date;\n\"")]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("h3",{attrs:{id:"_2-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-"}},[t._v("#")]),t._v(" 2.1 ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1942),alt:"3"}})]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_new_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  reg_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  reg_ips      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ip'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nhive\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_new_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" client_ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" reg_ips\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_basic_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-"}},[t._v("#")]),t._v(" 2.2 ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("DAU")]),t._v("")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_active_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  new_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  old_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  all_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_active_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("login_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" new_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("login_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" old_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" all_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-"}},[t._v("#")]),t._v(" 2.3 ")]),t._v(" "),n("p",[t._v("//")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1943),alt:"img"}})]),t._v(" "),n("p",[t._v("7")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1944),alt:"img"}})]),t._v(" "),n("p",[t._v("8")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_play_habit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  online_times    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  login_times    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_play_habit\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("login_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" login_times\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-4-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-"}},[t._v("#")]),t._v(" 2.4 ")]),t._v(" "),n("h4",{attrs:{id:"_2-4-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1-"}},[t._v("#")]),t._v(" 2.4.1 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1945),alt:"9"}})]),t._v(" "),n("p",[t._v("9")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_level_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  role_level_after    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  online_times    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_times   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  recharge_amount   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_level_info\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" online_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pay_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" recharge_amount\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"_2-4-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-2-"}},[t._v("#")]),t._v(" 2.4.2 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1946),alt:"10"}})]),t._v(" "),n("p",[t._v("10")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1947),alt:"11"}})]),t._v(" "),n("p",[t._v("11")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_level_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  role_level_after    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_level_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"_2-4-3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-3-"}},[t._v("#")]),t._v(" 2.4.3 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1948),alt:"12"}})]),t._v(" "),n("p",[t._v("12")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1949),alt:"13"}})]),t._v(" "),n("p",[t._v("13")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_newuser_level"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  role_level_after    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_newuser_level\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" reg_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("login_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_level_after"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-5-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-"}},[t._v("#")]),t._v(" 2.5 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1950),alt:"24"}})]),t._v(" "),n("p",[t._v("24")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1951),alt:"25"}})]),t._v(" "),n("p",[t._v("25")]),t._v(" "),n("p",[t._v("dw_user_basic_info")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_device_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  device_brand   string "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  device_type    string "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_device_info\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_basic_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_brand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("device_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-6shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-6shell"}},[t._v("#")]),t._v(" 2.6shell")]),t._v(" "),n("p",[t._v("node03shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_business.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_new_users;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_new_users(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  reg_users    int  COMMENT '',\n  reg_ips      int  COMMENT 'ip'\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_new_users\nselect plat_id,channel_id, reg_date as event_date,\ncount(distinct user_id) as reg_users,count(distinct client_ip) as reg_ips\nfrom dw_user_basic_info \ngroup by plat_id,channel_id,reg_date;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_active_users;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_active_users(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  new_users    int  COMMENT '',\n  old_users    int  COMMENT '',\n  all_users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_active_users\nselect plat_id,channel_id,part_date as event_date,\ncount(distinct case when reg_date=login_date then user_id end) as new_users,\ncount(distinct case when reg_date<login_date then user_id end) as old_users,\ncount(distinct user_id) as all_users\nfrom dw_user_behavior_info \ngroup by plat_id,channel_id,part_date;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_play_habit;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_play_habit(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  online_times    int  COMMENT '',\n  login_times    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_play_habit\nselect plat_id,channel_id,part_date as event_date,\nsum(online_times) as online_times,\nsum(login_times) as login_times\nfrom dw_user_behavior_info \ngroup by plat_id,channel_id,part_date;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_level_info;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_level_info(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  role_level_after    int COMMENT '',\n  online_times    int  COMMENT '',\n  pay_times   int  COMMENT '',\n  recharge_amount   double   COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_level_info\nselect plat_id,channel_id,part_date as event_date,role_level_after,\nsum(online_times) as online_times,\nsum(pay_times) as pay_times,\nsum(recharge_amount) as recharge_amount\nfrom dw_user_behavior_info \ngroup by plat_id,channel_id,part_date,role_level_after;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_level_users;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_level_users(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  role_level_after    int COMMENT '',\n  users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_level_users\nselect plat_id,channel_id,part_date as event_date,role_level_after,\ncount(distinct user_id) as users\nfrom dw_user_behavior_info \ngroup by plat_id,channel_id,part_date,role_level_after;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_newuser_level;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_newuser_level(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  role_level_after    int COMMENT '',\n  users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_newuser_level\nselect plat_id,channel_id,part_date as event_date,role_level_after,\ncount(distinct user_id) as users\nfrom dw_user_behavior_info \nwhere reg_date=login_date\ngroup by plat_id,channel_id,part_date,role_level_after;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_device_info;\n\ncreate table if not exists   "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_device_info(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  device_brand   string COMMENT '',\n  device_type    string COMMENT '',\n  users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_device_info\nselect plat_id,channel_id,reg_date as event_date,device_brand,device_type,\ncount(distinct user_id) as users\nfrom dw_user_basic_info \ngroup by plat_id,channel_id,reg_date,device_brand,device_type;\n\n\n\n"')]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("h3",{attrs:{id:"_3-1-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-"}},[t._v("#")]),t._v(" 3.1 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1952),alt:"img"}})]),t._v(" "),n("p",[t._v("14")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1953),alt:"15"}})]),t._v(" "),n("p",[t._v("15")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_pay_trans"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  new_pay_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  all_pay_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_pay_trans\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("new_pay_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("SUM")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("new_pay_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" all_pay_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" new_pay_users\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("sum over")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sum  over \n\nSUM(new_pay_users) OVER(PARTITION BY plat_id,channel_id ORDER BY event_date)\nplat_id,channel_id \nevent_dateORDER BY event_date \n\n\n\n\nrank  over\ndense_rank  over\nrow_number  over\n")])])]),n("p",[t._v("SUM(new_pay_users) OVER(PARTITION BY plat_id,channel_id ORDER BY event_date)")]),t._v(" "),n("p",[t._v(" plat_id,channel_id event_datenew_pay_usersevent_dat")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("plat_id")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("channel_id")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("event_date")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("new_pay_users")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("all_pay_users")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-10")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-11")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("6")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-12")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("7")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("13")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-13")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("16")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-14")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("18")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-15")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("22")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2019-10-16")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("26")])])])]),t._v(" "),n("h3",{attrs:{id:"_3-2-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-"}},[t._v("#")]),t._v(" 3.2 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1954),alt:"16"}})]),t._v(" "),n("p",[t._v("16")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1955),alt:"17"}})]),t._v(" "),n("p",[t._v("17")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_pay_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_money    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_times    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_pay_info\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("recharge_amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pay_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_times\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3-3-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-"}},[t._v("#")]),t._v(" 3.3 ")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")]),t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1956),alt:"18"}})]),t._v(" "),n("p",[t._v("18")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1957),alt:"19"}})]),t._v(" "),n("p",[t._v("19")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_pay_habit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_times_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id,'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_times_area    string  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_pay_habit\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pay_times_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pay_times_area"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_users\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" pay_times "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_times_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" pay_times "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'4'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'6~10'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'11~20'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'21~30'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" pay_times"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'31~40'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'40'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_times_area\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pay_times"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_times\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user_id\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" t \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pay_times_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pay_times_area"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3-4-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-"}},[t._v("#")]),t._v(" 3.4 ")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1958),alt:"20"}})]),t._v(" "),n("p",[t._v("20")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1959),alt:"21"}})]),t._v(" "),n("p",[t._v("21")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_pay_seep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  active_user  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_users    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_pay_seep\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" user_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" active_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" active_user\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3-5-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-"}},[t._v("#")]),t._v(" 3.5 ")]),t._v(" "),n("p",[t._v("714306090")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1960),alt:"22"}})]),t._v(" "),n("p",[t._v("22")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1961),alt:"23"}})]),t._v(" "),n("p",[t._v("23")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" res_newuser_value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  plat_id      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ID'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  channel_id   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  event_date   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_money7   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'7'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_money14  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'14'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_money30  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'30'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_money60  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'60'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  pay_money90  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'90'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("comment")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LINES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),t._v("\nSTORED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" res_newuser_value\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money14"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money30"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money60"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" recharge_amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" datediff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" recharge_amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pay_money90\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_user_behavior_info \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("reg_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3-6shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6shell"}},[t._v("#")]),t._v(" 3.6shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim res_user_pay_hobby.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\nDBNAME"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("game_center\nhive_home"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("kkb"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cdh5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$1"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n   part_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-1 day"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("F"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("\nfi \necho "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**= $part_date**="')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\nset hive.exec.mode.local.auto=true;  \nset hive.exec.mode.local.auto.inputbytes.max=262144;\nset hive.exec.mode.local.auto.input.files.max=5;\n\ncreate database if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\nuse "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('";\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_trans;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_pay_trans(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  new_pay_users    int COMMENT '',\n  all_pay_users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_trans\nselect plat_id,channel_id,event_date,new_pay_users,\nSUM(new_pay_users) OVER(PARTITION BY plat_id,channel_id ORDER BY event_date) AS all_pay_users\nfrom \n(\n  select plat_id,channel_id,part_date as event_date,count(distinct user_id) as new_pay_users\n  from dw_user_behavior_info \n  where recharge_amount>0\n  group by plat_id,channel_id,part_date\n) t ;\n\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_info;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_pay_info(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  pay_money    double COMMENT '',\n  pay_users    int  COMMENT '',\n  pay_times    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_info\nselect plat_id,channel_id,part_date as event_date,\nsum(recharge_amount) as pay_money,\ncount(distinct user_id) as pay_users,\nsum(pay_times) as pay_times\nfrom dw_user_behavior_info \nwhere recharge_amount>0\ngroup by plat_id,channel_id,part_date;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_habit;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_pay_habit(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  pay_times_id int COMMENT 'id,',\n  pay_times_area    string  COMMENT '',\n  pay_users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_pay_habit\nselect plat_id,channel_id, event_date,pay_times_id,pay_times_area,\ncount(1) as pay_users\nfrom \n(\n  select plat_id,channel_id, event_date,user_id,\n  case \n  when pay_times=0 or pay_times is null then 0\n  when pay_times=1 then  1\n  when pay_times=2 then  2\n  when pay_times=3 then  3\n  when pay_times=4 then  4\n  when pay_times=5 then  5\n  when pay_times>=6 and pay_times<=10 then 6\n  when pay_times>=11 and pay_times<=20 then 7\n  when pay_times>=21 and pay_times<=30 then 8\n  when pay_times>=31 and pay_times<=40 then 9\n  else 10 end as pay_times_id,\n  case \n  when pay_times=0 or pay_times is null then ''\n  when pay_times=1 then  '1'\n  when pay_times=2 then  '2'\n  when pay_times=3 then  '3'\n  when pay_times=4 then  '4'\n  when pay_times=5 then  '5'\n  when pay_times>=6 and pay_times<=10 then '6~10'\n  when pay_times>=11 and pay_times<=20 then '11~20'\n  when pay_times>=21 and pay_times<=30 then '21~30'\n  when pay_times>=31 and pay_times<=40 then '31~40'\n  else '40' end as pay_times_area\n  from \n  (\n    select plat_id,channel_id,part_date as event_date,user_id,\n    sum(pay_times) as pay_times\n    from dw_user_behavior_info \n    where recharge_amount>0\n    group by plat_id,channel_id,part_date,user_id\n  ) t \n) t \ngroup by plat_id,channel_id, event_date,pay_times_id,pay_times_area;\n\ndrop table if exists \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_seep;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_pay_seep(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  active_user  int  COMMENT '',\n  pay_users    int  COMMENT ''\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_pay_seep\nselect plat_id,channel_id,part_date as event_date,\ncount(distinct user_id) as active_user,\ncount(distinct case when recharge_amount>0 then user_id end) as active_user\nfrom dw_user_behavior_info \ngroup by plat_id,channel_id,part_date;\n\ndrop table if exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_newuser_value;\n\ncreate table if not exists "')]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\".res_newuser_value(\n  plat_id      int  COMMENT 'ID',\n  channel_id   int  COMMENT 'id',\n  event_date   date COMMENT '',\n  pay_money7   double   COMMENT '7',\n  pay_money14  double   COMMENT '14',\n  pay_money30  double   COMMENT '30',\n  pay_money60  double   COMMENT '60',\n  pay_money90  double   COMMENT '90'\n)\ncomment ''\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\nLINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE;\n\ninsert overwrite table \"")]),t._v("$DBNAME"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".res_newuser_value\nselect plat_id,channel_id,reg_date as event_date,\nsum(case when recharge_amount>0 and datediff(part_date,reg_date)<=7 then recharge_amount else 0 end) as pay_money7,\nsum(case when recharge_amount>0 and datediff(part_date,reg_date)<=14 then recharge_amount else 0 end) as pay_money14,\nsum(case when recharge_amount>0 and datediff(part_date,reg_date)<=30 then recharge_amount else 0 end) as pay_money30,\nsum(case when recharge_amount>0 and datediff(part_date,reg_date)<=60 then recharge_amount else 0 end) as pay_money60,\nsum(case when recharge_amount>0 and datediff(part_date,reg_date)<=90 then recharge_amount else 0 end) as pay_money90\nfrom dw_user_behavior_info \ngroup by plat_id,channel_id,reg_date;\n\n"')]),t._v("\n$hive_home "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$sql"')]),t._v("\n")])])]),n("h2",{attrs:{id:"_4shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4shell"}},[t._v("#")]),t._v(" 4shell")]),t._v(" "),n("p",[t._v("shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim execute_res2.sh\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" m "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v("  res_user_business"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh res_user_pay_hobby"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh                                                                                           \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sh $m\ndone\n")])])]),n("h2",{attrs:{id:"_5sqoop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5sqoop"}},[t._v("#")]),t._v(" 5sqoop")]),t._v(" "),n("p",[t._v("odsmysql")]),t._v(" "),n("h3",{attrs:{id:"_1-mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-mysql"}},[t._v("#")]),t._v(" 1 mysql")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nSQLyog Ultimate v12.09 (64 bit)\nMySQL - 5.7.27 : Database - game_center\n*********************************************************************\n*/")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40101 SET NAMES utf8 */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40101 SET SQL_MODE=''*/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATABASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!32312 IF NOT EXISTS*/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40100 DEFAULT CHARACTER SET utf8 */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*Table structure for table `res_active_users` */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("res_active_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("res_active_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("plat_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("event_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("new_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("old_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("all_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*Table structure for table `res_channel_num` */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("res_channel_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("res_channel_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("device_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("reg_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("active_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("play_once_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("pay_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("pay_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("pay_money"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*Table structure for table `res_channel_num_temp` */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("res_channel_num_temp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("res_channel_num_temp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("login_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("device_num"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("reg_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("active_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("play_once_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("pay_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("pay_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("pay_money"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40101 SET SQL_MODE=@OLD_SQL_MODE */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2sqoop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2sqoop"}},[t._v("#")]),t._v(" 2sqoop")]),t._v(" "),n("p",[t._v("sqoopmysql,"),n("code",[t._v("res_active_users")]),t._v(" "),n("code",[t._v("res_basic_count")]),t._v(" "),n("code",[t._v("res_channel_num")]),t._v(" "),n("code",[t._v("res_channel_stay")]),t._v(" "),n("code",[t._v("res_consumer_hobby")]),t._v(" "),n("code",[t._v("res_consumer_point")]),t._v(" ")]),t._v(" "),n("h4",{attrs:{id:"_1-res-active-users"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-res-active-users"}},[t._v("#")]),t._v(" 1 res_active_users")]),t._v(" "),n("p",[n("strong",[t._v("mysqlid?")])]),t._v(" "),n("p",[t._v("--update-keymysql--columnshivemysql")]),t._v(" "),n("p",[t._v("mysqlmysqlididsqoop")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/sqoop-1.4.6-cdh5.14.2\n\nbin/sqoop "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" --connect jdbc:mysql://node03:3306/game_center "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --username root --password "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --table res_active_users --export-dir /user/hive/warehouse/game_center.db/res_active_users  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --update-key "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(" --columns "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plat_id,channel_id,event_date,new_users,old_users,all_users"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --update-mode allowinsert -m "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" --input-null-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --input-null-non-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" --fields-terminated-by "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'")]),t._v("  \n")])])]),n("h4",{attrs:{id:"_2res-channel-num"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2res-channel-num"}},[t._v("#")]),t._v(" 2res_channel_num")]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("1SqoopMysql4Map2MySQLMapMySQL")]),t._v(" "),n("p",[n("strong",[t._v("Sqoop")]),t._v("  ****staging-table****"),n("strong",[t._v("")]),t._v(" ")]),t._v(" "),n("p",[t._v("BABBBAB")]),t._v(" "),n("img",{staticStyle:{zoom:"67%"},attrs:{src:".assets/image-20200520230313666.png",alt:"image-20200520230313666"}}),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/sqoop-1.4.6-cdh5.14.2\n\nbin/sqoop "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" --connect jdbc:mysql://node03:3306/game_center "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--username root --password "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--table res_channel_num --export-dir /user/hive/warehouse/game_center.db/res_channel_num  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--columns "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login_date,channel_id,device_num,reg_user,active_users,play_once_users,pay_users,pay_user,pay_money"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--update-mode allowinsert -m "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--staging-table res_channel_num_temp --clear-staging-table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--input-null-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--input-null-non-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" --fields-terminated-by "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\001"}},[t._v("\\001")]),t._v("'")]),t._v("  \n")])])]),n("h4",{attrs:{id:"_3shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3shell"}},[t._v("#")]),t._v(" 3shell")]),t._v(" "),n("p",[t._v("node03shell")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cd /home/hadoop/bin/\n\nvim export_res.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n/kkb/install/sqoop-1.4.6-cdh5.14.2/bin/sqoop "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" --connect jdbc:mysql://node03:3306/game_center "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --username root --password "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --table res_active_users --export-dir /user/hive/warehouse/game_center.db/res_active_users  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --update-key "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(" --columns "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plat_id,channel_id,event_date,new_users,old_users,all_users"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --update-mode allowinsert -m "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" --input-null-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n --input-null-non-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" --fields-terminated-by "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[t._v("\\t")]),t._v("'")]),t._v(" \n \n\n/kkb/install/sqoop-1.4.6-cdh5.14.2/bin/sqoop "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" --connect jdbc:mysql://node03:3306/game_center "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--username root --password "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--table res_channel_num --export-dir /user/hive/warehouse/game_center.db/res_channel_num  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--columns "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login_date,channel_id,device_num,reg_user,active_users,play_once_users,pay_users,pay_user,pay_money"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--update-mode allowinsert -m "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--staging-table res_channel_num_temp --clear-staging-table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--input-null-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--input-null-non-string "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v("N'")]),t._v(" --fields-terminated-by "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\001"}},[t._v("\\001")]),t._v("'")]),t._v("  \n")])])]),n("h2",{attrs:{id:"_6azkaban"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6azkaban"}},[t._v("#")]),t._v(" 6azkaban")]),t._v(" "),n("p",[t._v("ODSdwresmysqlmysqljavaWebPHP"),n("strong",[t._v("azkaban")])]),t._v(" "),n("h3",{attrs:{id:"_1ods-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1ods-job"}},[t._v("#")]),t._v(" 1ods.job")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("type=command\n\ncommand=/usr/bin/sh execute_ods.sh\n")])])]),n("h3",{attrs:{id:"_2dw-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2dw-job"}},[t._v("#")]),t._v(" 2dw.job")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("type=command\n\ncommand=/usr/bin/sh execute_dw.sh\n\ndependencies=ods\n")])])]),n("h3",{attrs:{id:"_3res1-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3res1-job"}},[t._v("#")]),t._v(" 3res1.job")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("type=command\n\ncommand=/usr/bin/sh execute_res.sh\n\ndependencies=dw \n")])])]),n("h3",{attrs:{id:"_4res2-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4res2-job"}},[t._v("#")]),t._v(" 4res2.job")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("type=command\n\ncommand=/usr/bin/sh execute_res2.sh\n\ndependencies=dw\n")])])]),n("h3",{attrs:{id:"_5export-job"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5export-job"}},[t._v("#")]),t._v(" 5export.job")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("type=command\n\ncommand=/usr/bin/sh export_res.sh\n\ndependencies=res1,res2\n")])])]),n("h3",{attrs:{id:"_6"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6"}},[t._v("#")]),t._v(" 6")]),t._v(" "),n("p",[n("strong",[t._v("zip")]),t._v("azkaban")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1962),alt:"img"}})]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("hive\nimpala +oozie +hue  **= \n  ** azkaban + hive + sqoop\n  impala +oozie  +hue  +datax/sqoop\n\n\nimpala  ** \nhive  =   ** \n")])])]),n("h2",{attrs:{id:"_7hive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7hive"}},[t._v("#")]),t._v(" 7hive")]),t._v(" "),n("h3",{attrs:{id:"_1hive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1hive"}},[t._v("#")]),t._v(" 1hive")]),t._v(" "),n("h4",{attrs:{id:"_1-grouping-sets"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-grouping-sets"}},[t._v("#")]),t._v(" 1 grouping sets")]),t._v(" "),n("p",[t._v("hive**group  bysqlgroup  by")]),t._v(" "),n("p",[t._v("grouping sets")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("Grouping sets  e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("g:\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b grouping sets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" b\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  ods_role_create "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex grouping sets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" channel_id  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" role_sex  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("102692")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("82487")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("172018")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("94226")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("77792")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13161")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8466")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4695")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  ods_role_create "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1963),alt:"image-20200520234054649"}})]),t._v(" "),n("h4",{attrs:{id:"_2cube"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2cube"}},[t._v("#")]),t._v(" 2cube")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("g:\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" cube\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b grouping sets "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" b  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),n("p",[t._v("id")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  ods_role_create \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" cube "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" channel_id  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" role_sex  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("185179")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("102692")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("82487")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("172018")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("94226")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("77792")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13161")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8466")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4695")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n")])])]),n("h4",{attrs:{id:"_1-rollup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-rollup"}},[t._v("#")]),t._v(" 1 rollup")]),t._v(" "),n("p",[t._v("rollup")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("g:\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("c "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with rollup")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("grouping sets"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("c  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" a  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("all")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("id")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("  ods_role_create "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" channel_id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("role_sex "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with rollup")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" channel_id  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" role_sex  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" total_person  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("185179")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("172018")]),t._v("        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("94226")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("77792")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13161")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8466")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4695")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------------+-----------+---------------+--+")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("h4",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v("hivehiveunion alljoin")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parallel"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parallel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("thread"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("number"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"_2maptask"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2maptask"}},[t._v("#")]),t._v(" 2MapTask")]),t._v(" "),n("p",[t._v("mapTaskmapTask")]),t._v(" "),n("p",[t._v("Map")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" mapred"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("268435456")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \nsplit  \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" mapred"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("min"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("per"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("node"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n split \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" mapred"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("min"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("per"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rack"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \nMap\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("format"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hadoop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CombineHiveInputFormat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"_3reducetask"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3reducetask"}},[t._v("#")]),t._v(" 3reduceTask")]),t._v(" "),n("p",[t._v("reduceTaskreduceTaksreduceTask")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("reduce\nset hive.exec.reducers.bytes.per.reducer=500000000;\n\nreduce\nset mapred.reduce.tasks = 20;\n")])])]),n("h4",{attrs:{id:"_4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[t._v("#")]),t._v(" 4")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("\nReduce\n\nmapmap\nReduce\nnamenode  Map-only\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.merge.mapfiles "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\nMap-Reduce  \n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.merge.mapredfiles "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  \n  \n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.merge.size.per.task "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),t._v("*1000*1000\nmap-reduce\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" hive.merge.smallfiles.avgsize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16000000")]),t._v("\n")])])]),n("h4",{attrs:{id:"_5"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5"}},[t._v("#")]),t._v(" 5")]),t._v(" "),n("p",[t._v("order byorder bylimit")]),t._v(" "),n("p",[t._v("  order bysort by")]),t._v(" "),n("p",[t._v("  limit")]),t._v(" "),n("h4",{attrs:{id:"_6maptask"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6maptask"}},[t._v("#")]),t._v(" 6mapTask")]),t._v(" "),n("p",[t._v("MapTaskMapTaskshufflereduceTask")]),t._v(" "),n("p",[t._v("mapreduce")]),t._v(" "),n("p",[t._v(" Map join")]),t._v(" "),n("p",[t._v(" Map aggr")]),t._v(" "),n("h4",{attrs:{id:"_7-"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-"}},[t._v("#")]),t._v(" 7")]),t._v(" "),n("p",[t._v("select")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("  \n\np \n\np map\n\n  \n\np \n\np  \n")])])]),n("h4",{attrs:{id:"_8io"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8io"}},[t._v("#")]),t._v(" 8IO")]),t._v(" "),n("p",[t._v("sqlIO")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("IO\n\n   \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" a  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" b\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" col1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("col2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b  insert overwrite table c  select col1,col3 where type='")]),t._v("c  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n   \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" tab1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n")])])]),n("h2",{attrs:{id:"_8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8"}},[t._v("#")]),t._v(" 8")]),t._v(" "),n("h3",{attrs:{id:"_1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1"}},[t._v("#")]),t._v(" 1")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")]),t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:"_2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2"}},[t._v("#")]),t._v(" 2")]),t._v(" "),n("p",[t._v(""),n("strong",[t._v("")])]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("h3",{attrs:{id:"_3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3"}},[t._v("#")]),t._v(" 3")]),t._v(" "),n("p",[n("strong",[t._v("start_dateend_date")])]),t._v(" "),n("p",[t._v("IDend_datestart_date-1end_date99991231")]),t._v(" "),n("p",[t._v("Mysqluser2017-01-01")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("001")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("111111")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("002")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("222222")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("003")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("333333")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("004")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("444444")])])])]),t._v(" "),n("p",[t._v("2017-01-02 002004005")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("001")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("111111")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("002")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("233333")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2222222333333")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("003")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("333333")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("004")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("43434343")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("44444443434343")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-02")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("005")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("555555")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-02")])])])]),t._v(" "),n("p",[t._v("2017-01-03 004005006")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[n("strong",[t._v("")])])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("001")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("111111")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("002")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("233333")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2222222333333")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("003")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("333333")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-01")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("004")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("654321")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("43434343654321")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-02")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("005")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("511111")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("555555511111")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-03")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("006")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("666666")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("2017-01-03")])])])]),t._v(" "),n("p",[t._v("2017-01-03")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1964),alt:"img"}})]),t._v(" "),n("p",[n("strong",[t._v("")])]),t._v(" "),n("ul",[n("li",[t._v("t_start_datet_end_date")]),t._v(" "),n("li",[n("strong",[t._v("t_end_date = '9999-12-31'")])]),t._v(" "),n("li",[t._v("select * from user where t_end_date = '9999-12-31'")]),t._v(" "),n("li",[t._v("2017-01-02select * from user where t_start_date <= '2017-01-02' and     t_end_date >= '2017-01-02'")])]),t._v(" "),n("h3",{attrs:{id:"_4hive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4hive"}},[t._v("#")]),t._v(" 4Hive")]),t._v(" "),n("p",[t._v("")]),t._v(" "),n("p",[t._v("-- "),n("strong",[t._v(" day")]),t._v('Kimball""'),n("strong",[t._v("")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("orderid createtime modifiedtime status\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-21  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-21  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-21  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-21  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-22  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-20  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-22  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-21  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-22  \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-22  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),t._v("-08-22  \n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n")])])]),n("p",[t._v(" 1234")]),t._v(" "),n("p",[t._v("hive")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exists")]),t._v(" chain_action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" chain_action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- sqoopmysqlhive")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" orders "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\norderid "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncreatetime STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmodifiedtime STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),t._v(" STRING\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" format delimited "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fields")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_orders_inc "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\norderid "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncreatetime STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmodifiedtime STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),t._v(" STRING\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" PARTITIONED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" format delimited "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fields")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" dw_orders_his "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\norderid "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncreatetime STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmodifiedtime STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),t._v(" STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndw_start_date STRING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndw_end_date STRING\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" format delimited "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fields")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("terminated")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("p",[t._v("order_chain.txtnode03/kkb/install/hivedatas")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/kkb/install/hivedatas/order_chain.txt'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" orders"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v(""),n("strong",[t._v("")]),t._v("2016-08-20")]),t._v(" "),n("p",[t._v("2016-08-20")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_orders_inc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-20'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("createtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("modifiedtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" orders\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" createtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" modifiedtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("dw")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" dw_orders_his\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("createtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("modifiedtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncreatetime "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" dw_start_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'9999-12-31'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" dw_end_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ods_orders_inc\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-20'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_orders_his"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nOK\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n")])])]),n("p",[t._v("2016-08-21")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" ods_orders_inc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("createtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("modifiedtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" orders\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("createtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" modifiedtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("OR")]),t._v(" modifiedtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ods_orders_inc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nOK\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n")])])]),n("p",[t._v("")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" dw_orders_his_tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" dw_orders_his_tmp "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ncreatetime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmodifiedtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndw_start_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\ndw_end_date\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("modifiedtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dw_start_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHEN")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("orderid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dw_end_date "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("THEN")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ELSE")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dw_end_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" dw_end_date\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dw_orders_his a\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("outer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ods_orders_inc "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("orderid "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    createtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    modifiedtime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    modifiedtime "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" dw_start_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'9999-12-31'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" dw_end_date\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ods_orders_inc\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2016-08-21'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" x\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" orderid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dw_start_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" overwrite "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" dw_orders_his "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dw_orders_his_tmp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("p",[t._v("2016-08-22")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" dw_orders_his"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nOK\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n")])])]),n("p",[t._v("")])])}),[],!1,null,null,null);s.default=e.exports}}]);