(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1978:function(t,s,a){"use strict";a.r(s);var n=a(17),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"_1、clickhouse概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、clickhouse概述"}},[t._v("#")]),t._v(" 1、ClickHouse概述")]),t._v(" "),n("h3",{attrs:{id:"_1、clickhouse基本简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、clickhouse基本简介"}},[t._v("#")]),t._v(" 1、ClickHouse基本简介")]),t._v(" "),n("p",[t._v("ClickHouse是俄罗斯的Yandex于2016年开源的"),n("strong",[t._v("列式存储****数据库管理系统")]),t._v("(DBMS:Database Management System)，简称CK。")]),t._v(" "),n("p",[t._v("主要**用于在线分析处理查询（**OLAP:Online Analytical Processing）")]),t._v(" "),n("p",[t._v("能够使用SQL查询实时生成分析数据报表")]),t._v(" "),n("p",[t._v("ClickHouse官方文档：https://clickhouse.tech/docs/en/")]),t._v(" "),n("h3",{attrs:{id:"_2、clickhouse的特性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、clickhouse的特性"}},[t._v("#")]),t._v(" 2、ClickHouse的特性")]),t._v(" "),n("ul",[n("li",[t._v("² 真正的面向列的DBMS")]),t._v(" "),n("li",[t._v("² 数据压缩")]),t._v(" "),n("li",[t._v("² 磁盘存储的数据")]),t._v(" "),n("li",[t._v("² 多核并行处理")]),t._v(" "),n("li",[t._v("² 多个服务器上分布式处理")]),t._v(" "),n("li",[t._v("² SQL支持")]),t._v(" "),n("li",[t._v("² 向量化引擎")]),t._v(" "),n("li",[t._v("² 实时数据更新")]),t._v(" "),n("li",[t._v("² 索引")]),t._v(" "),n("li",[t._v("² 支持在线查询")]),t._v(" "),n("li",[t._v("² 支持近似计算")]),t._v(" "),n("li",[t._v("² 数据复制和对数据完整性的支持")])]),t._v(" "),n("p",[t._v("ClickHouse的不完美")]),t._v(" "),n("ul",[n("li",[t._v("u 没有完整的事务支持")]),t._v(" "),n("li",[t._v("u  缺少高频率，低延迟的修改或删除已存在数据的能力。仅能用于批量修改或删除数据")]),t._v(" "),n("li",[t._v("u 稀疏索引使得clickhouse不适合通过其键检索单行的点查询")])]),t._v(" "),n("h3",{attrs:{id:"_3、clickhouse的应用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、clickhouse的应用场景"}},[t._v("#")]),t._v(" 3、clickhouse的应用场景")]),t._v(" "),n("p",[t._v("Ø OLAP场景关键特征：")]),t._v(" "),n("ul",[n("li",[t._v("l 大多数是读请求")]),t._v(" "),n("li",[t._v("l 数据总是以相当大的批(> 1000 rows)进行写入")]),t._v(" "),n("li",[t._v("l 不修改已添加的数据")]),t._v(" "),n("li",[t._v("l 每次查询都从数据库中读取大量的行，但是同时又仅需要少量的列")]),t._v(" "),n("li",[t._v("l 宽表，即每个表包含着大量的列")]),t._v(" "),n("li",[t._v("l 较少的查询(通常每台服务器每秒数百个查询或更少)")]),t._v(" "),n("li",[t._v("l 对于简单查询，允许延迟大约50毫秒")]),t._v(" "),n("li",[t._v("l 列中的数据相对较小： 数字和短字符串(例如，每个UR60个字节)")]),t._v(" "),n("li",[t._v("l 处理单个查询时需要高吞吐量（每个服务器每秒高达数十亿行）")]),t._v(" "),n("li",[t._v("l 事务不是必须的")]),t._v(" "),n("li",[t._v("l 对数据一致性要求低")]),t._v(" "),n("li",[t._v("l 每一个查询除了一个大表外都很小")]),t._v(" "),n("li",[t._v("l 查询结果明显小于源数据，换句话说，数据被过滤或聚合后能够被盛放在单台服务器的内存中")])]),t._v(" "),n("p",[t._v("Ø "),n("strong",[t._v("应用场景：")])]),t._v(" "),n("p",[t._v("l 用于结构良好清晰且不可变的事件或日志流分析。")]),t._v(" "),n("p",[t._v("Ø "),n("strong",[t._v("不适合的场景：")])]),t._v(" "),n("p",[t._v("l 事务性工作(OLTP)，高请求率的键值访问，低延迟的修改或删除已存在数据，Blob或文档存储，超标准化数据。")]),t._v(" "),n("h2",{attrs:{id:"_2、clickhouse的安装部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、clickhouse的安装部署"}},[t._v("#")]),t._v(" 2、ClickHouse的安装部署")]),t._v(" "),n("p",[t._v("​    clickhouse官网并没有提供二进制或rpm安装包，但是Altinity公司提供了对应的rpm安装包，可以通过rpm方式去安装。")]),t._v(" "),n("h3",{attrs:{id:"第一步-下载rpm包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一步-下载rpm包"}},[t._v("#")]),t._v(" 第一步：下载rpm包")]),t._v(" "),n("p",[t._v("下载地址：https://packagecloud.io/Altinity/clickhouse")]),t._v(" "),n("p",[n("img",{attrs:{src:a(442),alt:"img"}})]),t._v(" "),n("h3",{attrs:{id:"第二步-上传rpm包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二步-上传rpm包"}},[t._v("#")]),t._v(" 第二步：上传rpm包")]),t._v(" "),n("p",[t._v("上传rpm包到服务器node01、node02、node03服务器上的/kkb/soft路径下")]),t._v(" "),n("h3",{attrs:{id:"第三步-安装rpm包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三步-安装rpm包"}},[t._v("#")]),t._v(" 第三步：安装rpm包")]),t._v(" "),n("p",[t._v("每台节点安装下面的2个依赖")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y libtool\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y *unixODBC*\n")])])]),n("p",[t._v("每台节点安装ck服务")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/soft/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" -ivh *rpm\n")])])]),n("p",[n("img",{attrs:{src:a(443),alt:"img"}})]),t._v(" "),n("h3",{attrs:{id:"第四步-修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第四步-修改配置文件"}},[t._v("#")]),t._v(" 第四步：修改配置文件")]),t._v(" "),n("h4",{attrs:{id:"修改config-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改config-xml"}},[t._v("#")]),t._v(" 修改config.xml")]),t._v(" "),n("p",[t._v("三台机器都修改配置文件")]),t._v(" "),n("p",[t._v("node01执行以下命令修改config.xml")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sudo vim /etc/clickhouse-server/config.xml\n")])])]),n("p",[t._v("将这一行注释文件给打开")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("<listen_host>::</listen_host>\n")])])]),n("p",[t._v("将配置文件拷贝到其他机器上面去")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v("  /etc/clickhouse-server/config.xml  node02:/etc/clickhouse-server/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v("  /etc/clickhouse-server/config.xml  node03:/etc/clickhouse-server/\n")])])]),n("h4",{attrs:{id:"创建metrika-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建metrika-xml"}},[t._v("#")]),t._v(" 创建metrika.xml")]),t._v(" "),n("h5",{attrs:{id:"node01服务器创建metrika-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node01服务器创建metrika-xml"}},[t._v("#")]),t._v(" node01服务器创建metrika.xml")]),t._v(" "),n("p",[t._v("node01服务器的/etc 目录下新建metrika.xml文件")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/metrika.xml\n")])])]),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("yandex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 集群配置 --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("clickhouse_remote_servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("bip_ck_cluster")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("        \n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("bip_ck_cluster")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("clickhouse_remote_servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 本节点副本，不同的机器配置不同 --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("macros")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("macros")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ZK --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("zookeeper-servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("zookeeper-servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 监听网络 --\x3e")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("::/0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 数据压缩算法 --\x3e")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("clickhouse_compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("case")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("min_part_size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("10000000000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("min_part_size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("min_part_size_ratio")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("0.01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("min_part_size_ratio")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("lz4"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("case")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("clickhouse_compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("yandex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"node02服务器创建metrika-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node02服务器创建metrika-xml"}},[t._v("#")]),t._v(" node02服务器创建metrika.xml")]),t._v(" "),n("p",[t._v("node02服务器的/etc 目录下新建metrika.xml文件")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sudo vim /etc/metrika.xml\n")])])]),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("yandex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 集群配置 --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("clickhouse_remote_servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("bip_ck_cluster")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("        \n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("bip_ck_cluster")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("clickhouse_remote_servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 本节点副本，不同的机器配置不同 --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("macros")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("macros")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ZK --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("zookeeper-servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("zookeeper-servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 监听网络 --\x3e")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("::/0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 数据压缩算法 --\x3e")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("clickhouse_compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("case")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("min_part_size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("10000000000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("min_part_size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("min_part_size_ratio")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("0.01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("min_part_size_ratio")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("lz4"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("case")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("clickhouse_compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("yandex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"node03服务器创建metrika-xml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node03服务器创建metrika-xml"}},[t._v("#")]),t._v(" node03服务器创建metrika.xml")]),t._v(" "),n("p",[t._v("node03服务器的/etc 目录下新建metrika.xml文件")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sudo vim /etc/metrika.xml\n")])])]),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("yandex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 集群配置 --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("clickhouse_remote_servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("bip_ck_cluster")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("        \n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("internal_replication")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                 "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n             "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("shard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("bip_ck_cluster")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("clickhouse_remote_servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 本节点副本，不同的机器配置不同 --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("macros")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("replica")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("macros")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("  \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ZK --\x3e")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("zookeeper-servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node02"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   \n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("index")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("node03"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2181"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("zookeeper-servers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 监听网络 --\x3e")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("::/0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 数据压缩算法 --\x3e")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("clickhouse_compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("case")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("min_part_size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("10000000000"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("min_part_size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("min_part_size_ratio")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("0.01"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("min_part_size_ratio")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("lz4"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("case")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("clickhouse_compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("yandex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h4",{attrs:{id:"给予权限"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#给予权限"}},[t._v("#")]),t._v(" 给予权限")]),t._v(" "),n("p",[t._v("给每台机器的目录授权（避免后面操作异常）,如果报错说不存在文件，此步可以省略不做。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" -R "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("777")]),t._v(" /var/lib/clickhouse/data\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" -R "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("777")]),t._v(" /var/lib/clickhouse/metadata\n")])])]),n("p",[t._v("搭建clickhouse过程中会生成对应的目录")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" 配置文件路径：/etc/clickhouse-server/config.xml\n 日志文件路径：/var/log/clickhouse-server/\n 建表信息路径：/data/clickhouse/metadata/\n 分区数据路径：/data/clickhouse/data/\n")])])]),n("h2",{attrs:{id:"_3、clickhouse的启动与停止"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、clickhouse的启动与停止"}},[t._v("#")]),t._v(" 3、clickHouse的启动与停止")]),t._v(" "),n("h3",{attrs:{id:"clickhouse的启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#clickhouse的启动"}},[t._v("#")]),t._v(" ClickHouse的启动")]),t._v(" "),n("p",[t._v("首先需要在三台机器上面"),n("strong",[t._v("启动zookeeper服务")]),t._v("，然后通过以下命令来启动clickHouse服务")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sudo service clickhouse-server start\n")])])]),n("p",[t._v("可以通过 ps -ef | grep clickhouse 命令查看ck是否启动成功")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("ps -ef | grep clickhouse\n")])])]),n("p",[t._v("连接客户端")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("[hadoop@node01 bin]$ clickhouse-client\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hadoop"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@node01")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("$ clickhouse"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("client\nClickHouse client version "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19.16")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".10")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".44")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nConnecting "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" localhost:"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nConnected "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" ClickHouse server version "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19.16")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v(".10")]),t._v(" revision "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("54427.")]),t._v("\n\nnode01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("show")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("databases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SHOW")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATABASES")]),t._v("\n\n┌─name────┐\n│ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" │\n│ system  │\n└─────────┘\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rows")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Elapsed: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.002")]),t._v(" sec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" \n")])])]),n("p",[t._v("ClickHouse的服务停止，三台节点上执行命令")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sudo service clickhouse-server stop\n")])])]),n("h2",{attrs:{id:"_4-命令行客户端连接clickhouse"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-命令行客户端连接clickhouse"}},[t._v("#")]),t._v(" 4. 命令行客户端连接ClickHouse")]),t._v(" "),n("p",[t._v("通过命令行来访问 ClickHouse，您可以使用 "),n("code",[t._v("clickhouse-client")])]),t._v(" "),n("p",[t._v("语法格式示例")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" clickhouse-client -m -u "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" -h "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --password "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --port "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  \n--user `"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("或者"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("` -u\n")])])]),n("p",[t._v("用户名。 默认值： default。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("--password\n")])])]),n("p",[t._v("密码。 默认值：空字符串。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("--host `"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("或者"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("` -h\n")])])]),n("p",[t._v("服务端的 host 名称, 默认是 'localhost'")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("--port\n")])])]),n("p",[t._v("连接的端口，默认值： 9000。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("--multiline `"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("或者"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("` -m\n")])])]),n("p",[t._v("如果指定，允许"),n("strong",[t._v("多行语句查询")]),t._v("（Enter 仅代表换行，不代表查询语句完结）。")]),t._v(" "),n("p",[t._v("演示：开启多行查询")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("clickhouse-client -m 或者 clickhouse-client -multiline\n")])])]),n("h2",{attrs:{id:"_5-数据类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-数据类型"}},[t._v("#")]),t._v(" 5. 数据类型")]),t._v(" "),n("h3",{attrs:{id:"_5-1-整型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-整型"}},[t._v("#")]),t._v(" 5.1 整型")]),t._v(" "),n("p",[t._v("固定长度的整型，包括有符号整型或无符号整型")]),t._v(" "),n("p",[t._v("·    整型范围")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" Int8 ："),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-128 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n Int16："),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-32768 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("32767")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n Int32："),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-2147483648 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2147483647")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n Int64："),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-9223372036854775808 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9223372036854775807")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),n("p",[t._v("·    无符号整型范围")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" UInt8 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n UInt16: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("65535")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n UInt32: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4294967295")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n UInt64: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18446744073709551615")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),n("h3",{attrs:{id:"_5-2-浮点型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-浮点型"}},[t._v("#")]),t._v(" 5.2 浮点型")]),t._v(" "),n("p",[t._v("·    Float32: float")]),t._v(" "),n("p",[t._v("·    Float64: double")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" 建议尽可能以整数形式存储数据。\n 例如，将固定精度的数字转换为整数值，如时间用毫秒为单位表示，因为浮点型进行计算时可能引起四舍五入的误差。\n \n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v("\n ┌───────minus"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.09999999999999998")]),t._v(" │\n └─────────────────────┘\n")])])]),n("p",[t._v("·    与标准SQL相比，ClickHouse 支持以下类别的浮点数：")]),t._v(" "),n("p",[t._v("o  inf 正无穷")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n ┌─divide"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │         inf │\n └──────────────┘\n")])])]),n("p",[t._v("o  -inf 负无穷")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n ┌─divide"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inf │\n └───────────────┘\n")])])]),n("p",[t._v("o  NaN 非数字")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n ┌─divide"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │         nan │\n └──────────────┘\n")])])]),n("h3",{attrs:{id:"_5-3-布尔型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-布尔型"}},[t._v("#")]),t._v(" 5.3 布尔型")]),t._v(" "),n("p",[t._v("·    没有单独的类型来存储布尔值。可以使"),n("strong",[t._v("用 UInt8 类型，取值限制为 0 或 1。")])]),t._v(" "),n("h3",{attrs:{id:"_5-4-字符串"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-字符串"}},[t._v("#")]),t._v(" 5.4 字符串")]),t._v(" "),n("p",[t._v("String：字符串可以任意长度的。它可以包含任意的字节集，包含空字节。")]),t._v(" "),n("p",[t._v("FixedString(N)：固定长度 N 的字符串，N 必须是严格的正自然数。当向ClickHouse中插入数据时：")]),t._v(" "),n("ol",[n("li",[t._v("如果字符串包含的字节数少于"),n("code",[t._v("N")]),t._v(", 将对字符串末尾进行空字节填充。")]),t._v(" "),n("li",[t._v("如果字符串包含的字节数大于"),n("code",[t._v("N")]),t._v(", 将抛出"),n("code",[t._v("Too large value for FixedString(N)")]),t._v("异常。")])]),t._v(" "),n("p",[t._v("与String相比，"),n("strong",[t._v("极少会使用FixedString")]),t._v("，因为使用起来不是很方便。")]),t._v(" "),n("h3",{attrs:{id:"_5-5-枚举类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-枚举类型"}},[t._v("#")]),t._v(" 5.5 枚举类型")]),t._v(" "),n("p",[t._v("包括 "),n("strong",[t._v("Enum8")]),t._v(" 和 "),n("strong",[t._v("Enum16")]),t._v(" 类型。Enum 保存 'string'= integer 的对应关系。")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("Enum8")]),t._v(" 用 'String'= Int8 对描述。")]),t._v(" "),n("li",[n("strong",[t._v("Enum16")]),t._v(" 用 'String'= Int16 对描述。")])]),t._v(" "),n("p",[t._v("用法演示")]),t._v(" "),n("ul",[n("li",[t._v("创建一个带有一个枚举 "),n("code",[t._v("Enum8('hello' = 1, 'world' = 2)")]),t._v(" 类型的列：")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(" clickhouse-client --multiline\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" enum_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n x Enum8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("o  这个 "),n("code",[t._v("x")]),t._v(" 列只能存储类型定义中列出的值："),n("code",[t._v("'hello'")]),t._v("或"),n("code",[t._v("'world'")]),t._v("。如果您尝试保存任何其他值，ClickHouse 抛出异常。")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--插入数据")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" enum_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--插入非'hello'或者'world'的数据")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" enum_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                          \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" enum_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v("\n Exception "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" client:\n Code: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("49.")]),t._v(" DB::Exception: Unknown element "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Enum8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'world'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n")])])]),n("p",[t._v("o  从表中查询数据时，ClickHouse 从 "),n("code",[t._v("Enum")]),t._v(" 中输出字符串值")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" enum_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" enum_table \n \n ┌─────x─┐\n │ hello │\n │ world │\n │ hello │\n └───────┘\n")])])]),n("p",[t._v("o  如果需要看到对应行的数值，则必须将 "),n("code",[t._v("Enum")]),t._v(" 值转换为整数类型。")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" CAST"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Int8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" enum_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" CAST"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Int8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" enum_table \n \n ┌─CAST"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \\'Int8\\'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │                 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │\n │                 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │\n │                 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │\n └───────────────────┘\n")])])]),n("h3",{attrs:{id:"_5-6-数组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-数组"}},[t._v("#")]),t._v(" 5.6 数组")]),t._v(" "),n("p",[t._v("Array(T)：由 "),n("code",[t._v("T")]),t._v(" 类型元素组成的数组。")]),t._v(" "),n("p",[n("code",[t._v("T")]),t._v(" "),n("strong",[t._v("可以是任意类型")]),t._v("，包含数组类型。 但不推荐使用多维数组，ClickHouse 对多维数组的支持有限。例如，不能存储在 "),n("code",[t._v("MergeTree")]),t._v(" 表中存储多维数组。")]),t._v(" "),n("p",[t._v("创建数组")]),t._v(" "),n("ol",[n("li",[t._v("可以使用array函数来创建数组：array[T]")]),t._v(" "),n("li",[t._v("也可以使用方括号 []")])]),t._v(" "),n("p",[t._v("案例")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n ┌─x─────┬─toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" │ Array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("           │\n └───────┴─────────────────────────┘\n \n \n \n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n ┌─x─────────┬─toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" │ Array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Float64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("         │\n └───────────┴────────────────────────┘\n \n")])])]),n("h3",{attrs:{id:"_5-7-元组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-元组"}},[t._v("#")]),t._v(" 5.7 元组")]),t._v(" "),n("p",[t._v("Tuple(T1, T2, ...)：元组，其中"),n("strong",[t._v("每个元素都有单独的类型")]),t._v("。")]),t._v(" "),n("p",[t._v("创建元组，可以使用函数来创建元组")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(" tuple(T1, T2, ...)\n")])])]),n("p",[t._v("·    案例")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" tuple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n ┌─x───────┬─toTypeName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tuple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \\'a\\'"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" │ Tuple"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       │\n └─────────┴─────────────────────────────┘\n")])])]),n("h3",{attrs:{id:"_5-8-date日期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-date日期"}},[t._v("#")]),t._v(" 5.8 Date日期")]),t._v(" "),n("p",[n("strong",[t._v("日期类型")]),t._v("，用两个字节存储，表示从 1970-01-01 (无符号) 到当前的日期值")]),t._v(" "),n("h3",{attrs:{id:"_5-9-datetime时间戳"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-9-datetime时间戳"}},[t._v("#")]),t._v(" 5.9 DateTime时间戳")]),t._v(" "),n("p",[n("strong",[t._v("时间戳类型")]),t._v("。用四个字节（无符号的）存储 Unix 时间戳）。")]),t._v(" "),n("p",[t._v("允许存储与日期类型相同的范围内的值。最小值为 0000-00-00 00:00:00。时间戳类型值精确到秒")]),t._v(" "),n("p",[t._v("还有很多数据结构，可以参考官方文档：https://clickhouse.yandex/docs/zh/data_types/")]),t._v(" "),n("h2",{attrs:{id:"_6-表引擎"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-表引擎"}},[t._v("#")]),t._v(" 6. 表引擎")]),t._v(" "),n("p",[n("strong",[t._v("表引擎（即表的类型）决定了：")])]),t._v(" "),n("p",[t._v("o   数据的存储方式和位置，写到哪里以及从哪里读取数据")]),t._v(" "),n("p",[t._v("o   支持哪些查询以及如何支持。")]),t._v(" "),n("p",[t._v("o   并发数据访问。")]),t._v(" "),n("p",[t._v("o   索引的使用（如果存在）。")]),t._v(" "),n("p",[t._v("o   是否可以执行多线程请求。")]),t._v(" "),n("p",[t._v("o   数据复制参数。")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(" ClickHouse的表引擎有很多，下面介绍其中几种，对其他引擎有兴趣的可以去查阅官方文档：https://clickhouse.yandex/docs/zh/operations/table_engines/\n")])])]),n("h3",{attrs:{id:"_6-1-tinylog"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-tinylog"}},[t._v("#")]),t._v(" 6.1 TinyLog")]),t._v(" "),n("p",[t._v("最简单的表引擎，用于"),n("strong",[t._v("将数据存储在磁盘上。每列都存储在单独的压缩文件中")]),t._v("。写入时，数据将附加到文件末尾。")]),t._v(" "),n("p",[n("strong",[t._v("该引擎没有并发控制")])]),t._v(" "),n("ol",[n("li",[t._v("如果同时从表中读取和写入数据，则读取操作将抛出异常；")]),t._v(" "),n("li",[t._v("如果同时写入多个查询中的表，则数据将被破坏。")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("  这种表引擎的典型用法是 write-once：首先只写入一次数据，然后根据需要多次读取。此引擎适用于相对较小的表（建议最多1,000,000行）。如果有许多小表，则使用此表引擎是适合的，因为它比Log引擎更简单（需要打开的文件更少）。当您拥有大量小表时，可能会导致性能低下，不支持索引。\n")])])]),n("p",[t._v("案例：创建一个TinyLog引擎的表并插入一条数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" f1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" f1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'abc'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("o  此时我们到保存数据的目录/var/lib/clickhouse/data/default/f1中可以看到如下目录结构：")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 f1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ll")]),t._v("\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":58 a.bin\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":58 b.bin\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":58 sizes.json\n \n 其中a.bin 和 b.bin 是压缩过的对应的列的数据，\n sizes.json 中记录了每个 *.bin 文件的大小\n \n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 f1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## cat sizes.json ")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yandex"')]),t._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a%2Ebin"')]),t._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"28"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b%2Ebin"')]),t._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("注意："),n("strong",[t._v("使用这种引擎，在机器A中创建的表，在机器B中是看不到这个表的")]),t._v("，这个就是tinylog单表引擎，一般很少用。")]),t._v(" "),n("h3",{attrs:{id:"_6-2-memory"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-memory"}},[t._v("#")]),t._v(" 6.2 Memory")]),t._v(" "),n("p",[t._v("内存引擎，数据以未压缩的原始形式直接"),n("strong",[t._v("保存在内存当中")]),t._v("，服务器重启数据就会消失。"),n("strong",[t._v("读写操作不会相互阻塞，不支持索引")]),t._v("。简单查询下有"),n("strong",[t._v("非常非常高的性能表现（超过10G/s）。")])]),t._v(" "),n("p",[t._v("一般用到它的地方不多，除了用来测试，就是在"),n("strong",[t._v("需要非常高的性能，同时数据量又不太大（上限大概 1 亿行）的场景。")])]),t._v(" "),n("h3",{attrs:{id:"_6-3-merge"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-merge"}},[t._v("#")]),t._v(" 6.3 Merge")]),t._v(" "),n("p",[n("strong",[t._v("Merge 引擎 (不要跟 MergeTree 引擎混淆")]),t._v(") "),n("strong",[t._v("本身不存储数据")]),t._v("，但可用于同时从任意多个其他的表中读取数据。 读是自动并行的，不支持写入。读取时，那些被真正读取到数据的表的索引（如果有的话）会被使用。")]),t._v(" "),n("p",[t._v("Merge 引擎的参数：一个数据库名和一个用于匹配表名的正则表达式。")]),t._v(" "),n("p",[t._v("案例")]),t._v(" "),n("p",[t._v("先在node01建立t1，t2，t3三个表，然后用 Merge 引擎的 tt 表再把它们链接起来")]),t._v(" "),n("p",[t._v("创建表")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t3 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("​向表中插入数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'first'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" t2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'second'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" t3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'three'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("​创建t表 ，把defalut数据库中所有以t开头的表连接起来")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Merge")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentDatabase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^t'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t\n ┌─id─┬─name──┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("first")]),t._v(" │\n └────┴───────┘\n ┌─id─┬─name───┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("second")]),t._v(" │\n └────┴────────┘\n ┌─id─┬─name──┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ three │\n └────┴───────┘\n")])])]),n("h3",{attrs:{id:"_6-4-mergetree-使用最多"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-mergetree-使用最多"}},[t._v("#")]),t._v(" 6.4 MergeTree(使用最多)")]),t._v(" "),n("p",[t._v("Clickhouse 中最强大的表引擎当属 "),n("code",[t._v("MergeTree")]),t._v(" （合并树）引擎及该系列（"),n("code",[t._v("*MergeTree")]),t._v("）中的其他引擎。")]),t._v(" "),n("p",[n("code",[t._v("MergeTree")]),t._v(" 引擎系列的基本理念如下。当你有巨量数据要插入到表中，你要高效地一批批写入数据片段，并希望这些数据片段在后台按照一定规则合并。相比在插入时不断修改（重写）数据进存储，这种策略会高效很多。")]),t._v(" "),n("p",[t._v("语法")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" CLUSTER cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    name1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" MergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sampling_expression"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("primary")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index_granularity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ul",[n("li",[t._v("date-column：类型为 Date 的列名。ClickHouse 会自动依据这个列创建分区。")]),t._v(" "),n("li",[t._v("sampling_expression ：采样表达式。")]),t._v(" "),n("li",[t._v("(primary, key) ：联合主键。类型为Tuple()，主键可以是任意表达式构成的元组（通常是列名称的元组）.")]),t._v(" "),n("li",[t._v("index_granularity ：索引粒度。即索引中相邻”标记”间的数据行数。设为 8192 可以适用大部分场景。")])]),t._v(" "),n("p",[t._v("案例：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--创建基于MergeTree的引擎表")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" mt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--插入数据")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" mt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-05-01'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zhangsan'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" mt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-06-01'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lisi'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" mt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-05-03'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wangwu'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查询表")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mt_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" mt_table \n \n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name───┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("05")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("03")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ wangwu │\n └────────────┴────┴────────┘\n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name─────┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("05")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n └────────────┴────┴──────────┘\n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("06")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi │\n └────────────┴────┴──────┘\n")])])]),n("p",[t._v("o  在/var/lib/clickhouse/data/default/mt_table目录下可以看到信息")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 mt_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ll")]),t._v("\n drwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("157")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 20190501_20190501_2_2_0\n drwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("157")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 20190503_20190503_6_6_0\n drwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("157")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 20190601_20190601_4_4_0\n drwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" clickhouse clickhouse   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 detached\n")])])]),n("p",[t._v("o  进入到20190501_20190501_2_2_0目录中")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node01 20190501_20190501_2_2_0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ll")]),t._v("\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 checksums.txt\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("74")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 columns.txt\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 date.bin\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 date.mrk\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 id.bin\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 id.mrk\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 name.bin\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 name.mrk\n -rw-rw-rw- "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" clickhouse clickhouse  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" Feb "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(":51 primary.idx\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##其中")]),t._v("\n *.bin是按列保存数据的文件\n *.mrk保存块偏移量\n primary.idx保存主键索引\n")])])]),n("h3",{attrs:{id:"_6-5-replacingmergetree"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-replacingmergetree"}},[t._v("#")]),t._v(" 6.5 ReplacingMergeTree")]),t._v(" "),n("p",[t._v("这个引擎是在 MergeTree 的基础上，添加了**“处理重复数据”"),n("strong",[t._v("的功能，该引擎和MergeTree的不同之处在于")]),t._v("它会删除具有相同主键的重复项。**")]),t._v(" "),n("p",[t._v("数据的去重只会在合并的过程中出现。合并会在未知的时间在后台进行，所以你无法预先作出计划。有一些数据可能仍未被处理。因此，"),n("strong",[t._v("ReplacingMergeTree 适用于在后台清除重复的数据以节省空间，但是它不保证没有重复的数据出现。")])]),t._v(" "),n("p",[t._v("语法")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" CLUSTER cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    name1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ReplacingMergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sampling_expression"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("primary")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index_granularity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--可以看出他比MergeTree只多了一个ver")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--这个ver指代版本列，它和时间一起配置用来区分哪条数据是最新的。")]),t._v("\n")])])]),n("p",[t._v("案例")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--创建一个基于ReplacingMergeTree引擎的表")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" rmt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("point")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ReplacingMergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("point")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 　\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--插入数据")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" rmt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-10'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" rmt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-10'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" rmt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" rmt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" rmt_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--等待一段时间或者使用 optimize table rmt_table 命令手动触发merge")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查询数据（返回去重之后最新的数据）")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" rmt_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" rmt_table \n \n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name─┬─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("point")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ a   │    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" │\n └────────────┴────┴──────┴───────┘\n")])])]),n("h3",{attrs:{id:"_6-6-summingmergetree"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-summingmergetree"}},[t._v("#")]),t._v(" 6.6 SummingMergeTree")]),t._v(" "),n("p",[t._v("该引擎继承自 MergeTree。")]),t._v(" "),n("p",[t._v("区别在于: 当合并 SummingMergeTree 表的数据片段时，"),n("strong",[t._v("ClickHouse 会把所有具有相同主键的行合并为一行")]),t._v("，该行包含了被合并的行中具有数值数据类型的列的"),n("strong",[t._v("汇总值")]),t._v("。")]),t._v(" "),n("p",[t._v("在 merge 时，主键相同的行，被指定列的值会相加，没有被指定的列会取最先出现的值")]),t._v(" "),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" CLUSTER cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    name1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" SummingMergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sampling_expression"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("primary")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index_granularity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("columns")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("columns ：包含"),n("strong",[t._v("将要被汇总的列的列名的元组")])]),t._v(" "),n("p",[t._v("案例")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("----创建一个基于SummingMergeTree引擎的表")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("SummingMergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--插入数据")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-10'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-10'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" smt_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-07-12'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("----等待一段时间或者使用 optimize table smt_table 命令手动触发merge")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查询数据")]),t._v("\n \n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" smt_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" smt_table \n \n\n┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─name─┬─a─┬─b─┐\n│ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" │ a    │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │\n│ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" │ b    │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │\n│ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" │ a    │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │\n│ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" │ b    │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" │\n└────────────┴──────┴───┴───┘\n┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─name─┬─a─┬─b─┐\n│ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(" │ c    │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │\n└────────────┴──────┴───┴───┘\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--发现2019-07-11，b的a列合并相加了，b列取了8（因为b列为8的数据最先插入）")]),t._v("\n")])])]),n("h3",{attrs:{id:"_6-7-distributed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-distributed"}},[t._v("#")]),t._v(" 6.7 Distributed")]),t._v(" "),n("p",[t._v("分布式引擎，"),n("strong",[t._v("本身不存储数据")]),t._v(", 但"),n("strong",[t._v("可以在多个服务器上进行分布式查询")]),t._v("。 读是自动并行的。读取时，远程服务器表的索引（如果有的话）会被使用。")]),t._v(" "),n("p",[t._v("语法")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" CLUSTER cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    name1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Distributed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cluster_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sharding_key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("参数解析：")]),t._v(" "),n("ul",[n("li",[t._v("cluster_name ：服务器配置文件中的集群名,在/etc/metrika.xml中配置的")]),t._v(" "),n("li",[t._v("database ：数据库名")]),t._v(" "),n("li",[t._v("table ：表名")]),t._v(" "),n("li",[t._v("sharding_key ：数据分片键")])]),t._v(" "),n("p",[t._v("案例：")]),t._v(" "),n("p",[t._v("（1）在node01，node02，node03上分别创建一个表 kaikeba")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" kaikeba"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("（2）在三台机器的 kaikeba 表中插入一些数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" kaikeba "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zhangsan'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" kaikeba "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lisi'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("（3）在 node01上创建分布式表")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" distributed_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Distributed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bip_ck_cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" kaikeba"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("（4）查询 distributed_table 表的数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" distributed_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" distributed_table \n \n\n┌─id─┬─name─────┐\n│  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n│  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n└────┴──────────┘\n┌─id─┬─name─────┐\n│  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n│  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n└────┴──────────┘\n┌─id─┬─name─────┐\n│  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n│  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n└────┴──────────┘\n")])])]),n("p",[t._v("（5）向distributed_table插入数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" distributed_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" kaikeba"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" distributed_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" distributed_table \n \n ┌─id─┬─name─────┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n └────┴──────────┘\n ┌─id─┬─name─────┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n └────┴──────────┘\n ┌─id─┬─name─────┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n └────┴──────────┘\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--可以看到每个节点分布的数据差不多")]),t._v("\n")])])]),n("p",[t._v("总结")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(" 分布式表实际上是Clickhouse集群本地表的一种“视图”。对分布式表的SELECT查询，会利用集群所有分片资源进行执行。你可以配置多个集群，并创建多个分布式表，给不同的集群提供视图\n")])])]),n("p",[t._v("更多表引擎可以参考官方文档：https://clickhouse.tech/docs/zh/operations/table_engines/")]),t._v(" "),n("p",[t._v("更多表引擎可以参考官方文档：https://clickhouse.tech/docs/zh/operations/table_engines/")]),t._v(" "),n("h2",{attrs:{id:"_7-sql语法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-sql语法"}},[t._v("#")]),t._v(" 7. SQL语法")]),t._v(" "),n("h3",{attrs:{id:"_7-1-create"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-create"}},[t._v("#")]),t._v(" 7.1 create")]),t._v(" "),n("h4",{attrs:{id:"_7-1-1-create-database"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-1-create-database"}},[t._v("#")]),t._v(" 7.1.1 create database")]),t._v(" "),n("p",[t._v("·    用于创建指定名称的数据库，语法如下：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATABASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" db_name\n")])])]),n("p",[t._v("·    演示")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exists")]),t._v(" test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"_7-1-2-create-table"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-2-create-table"}},[t._v("#")]),t._v(" 7.1.2 create table")]),t._v(" "),n("p",[t._v("·    对于创建表，语法如下")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" CLUSTER cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    name1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("MATERIALIZED"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ALIAS expr2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--DEFAULT expr ： 默认值，用法与SQL类似。")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--MATERIALIZED expr ：物化表达式，被该表达式指定的列不能被INSERT，因为它总是被计算出来的。 对于INSERT而言，不需要考虑这些列。 另外，在SELECT查询中如果包含星号，此列不会被查询。")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--ALIAS expr ：别名。")]),t._v("\n")])])]),n("p",[t._v("创建表的三种方式")]),t._v(" "),n("p",[t._v("（1）直接创建")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t_demo1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("（2）创建一个与其他表具有相同结构的表")]),t._v(" "),n("p",[t._v("语法")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("name2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),n("p",[t._v("演示")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t_demo2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" t_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Memory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" t_demo2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESCRIBE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" t_demo2\n \n ┌─name─┬─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v("───┬─default_type─┬─default_expression─┐\n │ id   │ UInt16 │             │                   │\n │ name │ String │             │                   │\n └──────┴────────┴──────────────┴────────────────────┘\n")])])]),n("p",[t._v("（3）使用指定的引擎创建一个与SELECT子句的结果具有相同结构的表，并使用SELECT子句的结果填充它。")]),t._v(" "),n("p",[t._v("语法")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("table_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),n("p",[t._v("演示")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--向t_demo1表中添加数据")]),t._v("\n \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" t_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zhangsan'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lisi'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wangwu'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t_demo3 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" t_demo1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查询表数据")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" t_demo3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_demo3 \n \n ┌─id─┬─name─────┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ wangwu   │\n └────┴──────────┘\n")])])]),n("h3",{attrs:{id:"_7-2-insert-into"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-insert-into"}},[t._v("#")]),t._v(" 7.2 insert into")]),t._v(" "),n("p",[t._v("insert主要用于向系统中添加数据.")]),t._v(" "),n("p",[t._v("语法：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v11"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v12"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v13"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v21"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" v23"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),n("p",[t._v("演示")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" t_demo4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TinyLog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" t_demo4 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zhangsan'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lisi'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查询")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" t_demo4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_demo4 \n \n ┌─id─┬─name─────┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │\n └────┴──────────┘\n")])])]),n("p",[t._v("注意")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" clickhouse不支持的其他用于修改数据的查询："),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("REPLACE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("MERGE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UPSERT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v("。 但是可以使用 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALTER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v("查询来删除一些旧的数据。\n")])])]),n("h3",{attrs:{id:"_7-3-alter"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-alter"}},[t._v("#")]),t._v(" 7.3 alter")]),t._v(" "),n("p",[n("strong",[t._v("ALTER只支持MergeTree系列，Merge和Distributed引擎的表")])]),t._v(" "),n("p",[t._v("语法")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALTER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" CLUSTER cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("MODIFY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLUMN")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),n("p",[t._v("参数解析")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLUMN")]),t._v(" 向表中添加新列\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLUMN")]),t._v("     在表中删除列\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("MODIFY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLUMN")]),t._v("   更改列的类型\n")])])]),n("p",[t._v("演示")]),t._v(" "),n("p",[t._v("（1）创建一个MergerTree引擎的表")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("（2）向表中插入数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-05-01'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zhangsan'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-06-01'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lisi'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2019-05-03'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wangwu'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("（3）新增age列")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--添加age列")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" age UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查看表结构")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" mt_table_demo1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESCRIBE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" mt_table_demo1\n \n ┌─name─┬─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v("───┬─default_type─┬─default_expression─┐\n │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("   │             │                   │\n │ id   │ UInt8 │             │                   │\n │ name │ String │             │                   │\n │ age │ UInt8 │             │                   │\n └──────┴────────┴──────────────┴────────────────────┘\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查询表数据")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mt_table_demo1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" mt_table_demo1 \n \n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name───┬─age─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("05")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("03")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ wangwu │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │\n └────────────┴────┴────────┴─────┘\n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name─────┬─age─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("05")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │\n └────────────┴────┴──────────┴─────┘\n ┌───────"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v("─┬─id─┬─name─┬─age─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("06")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │\n └────────────┴────┴──────┴─────┘\n")])])]),n("p",[t._v("（4）更改age列的类型")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--更改age列的类型为UInt16")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("modify")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" age UInt16\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查看表结构")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" mt_table_demo1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESCRIBE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" mt_table_demo1\n \n ┌─name─┬─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v("───┬─default_type─┬─default_expression─┐\n │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("   │             │                   │\n │ id   │ UInt8 │             │                   │\n │ name │ String │             │                   │\n │ age │ UInt16 │             │                   │\n └──────┴────────┴──────────────┴────────────────────┘\n \n")])])]),n("p",[t._v("（5）删除age列")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--删除age列")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" mt_table_demo1 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("drop")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("column")]),t._v(" age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--查看表结构")]),t._v("\n node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" mt_table_demo1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("               \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESCRIBE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" mt_table_demo1\n \n ┌─name─┬─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v("───┬─default_type─┬─default_expression─┐\n │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("   │             │                   │\n │ id   │ UInt8 │             │                   │\n │ name │ String │             │                   │\n └──────┴────────┴──────────────┴────────────────────┘\n")])])]),n("h3",{attrs:{id:"_7-4-check-table"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-check-table"}},[t._v("#")]),t._v(" 7.4 check table")]),t._v(" "),n("p",[t._v("检查表中的数据是否损坏，它会返回两种结果：")]),t._v(" "),n("p",[t._v("0：表数据已损坏")]),t._v(" "),n("p",[t._v("1：表数据完整")]),t._v(" "),n("p",[t._v("该命令只支持Log、TinyLog和StripeLog引擎")]),t._v(" "),n("p",[t._v("演示")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("check")]),t._v(" t1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHECK")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" t1\n \n ┌─result─┐\n │      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │\n └────────┘\n \n")])])]),n("h2",{attrs:{id:"_8-clickhouse集成外部存储系统"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-clickhouse集成外部存储系统"}},[t._v("#")]),t._v(" 8. clickhouse集成外部存储系统")]),t._v(" "),n("h3",{attrs:{id:"_8-1-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-kafka"}},[t._v("#")]),t._v(" 8.1 kafka")]),t._v(" "),n("p",[t._v("把消息从kafka集群中实时写入到clickhouse中")]),t._v(" "),n("h4",{attrs:{id:"_8-1-1-创建一个topic"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-1-创建一个topic"}},[t._v("#")]),t._v(" 8.1.1 创建一个topic")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/kafka_2.11-1.1.0 \nkafka-topics.sh --create --partitions "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" --replication-factor "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" --topic ck --zookeeper node01:2181,node02:2181,node03:2181\n")])])]),n("h4",{attrs:{id:"_8-1-2-创建表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-2-创建表"}},[t._v("#")]),t._v(" 8.1.2 创建表")]),t._v(" "),n("p",[t._v("在node01上启动 clickhouse-client -m 客户端，执行sql语句")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" queue "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("timestamp")]),t._v(" UInt64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    message String\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Kafka SETTINGS kafka_broker_list "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node01:9092,node02:9092,node03:9092'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                            kafka_topic_list "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ck'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                            kafka_group_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'consumer_ck'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                            kafka_format "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'JSONEachRow'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                            kafka_num_consumers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                                                    \n")])])]),n("p",[t._v("kafka_broker_list：指定kafka集群地址")]),t._v(" "),n("p",[t._v("kafka_topic_list：topic 列表")]),t._v(" "),n("p",[t._v("kafka_group_name：Kafka 消费组名称")]),t._v(" "),n("p",[t._v("kafka_format：消息体格式，使用与 SQL 部分的 "),n("code",[t._v("FORMAT")]),t._v(" 函数相同表示方法，例如 "),n("code",[t._v("JSONEachRow")])]),t._v(" "),n("p",[t._v("kafka_num_consumers：消费者线程数")]),t._v(" "),n("h4",{attrs:{id:"_8-1-3-向topic写入数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-3-向topic写入数据"}},[t._v("#")]),t._v(" 8.1.3 向topic写入数据")]),t._v(" "),n("p",[t._v("利用脚本写数据到ck主题中")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("bin/kafka-console-producer.sh --broker-list node01:9092,node02:9092,node03:9092 --topic ck\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##发送一条数据")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"timestamp"')]),t._v(":153000000,"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"level"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello ck"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"_8-1-4-查询数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-4-查询数据"}},[t._v("#")]),t._v(" 8.1.4 查询数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" queue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" queue\n \n ┌─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("timestamp")]),t._v("─┬─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),t._v("─┬─message──┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("153000000")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("     │ hello ck │\n └───────────┴───────┴──────────┘\n")])])]),n("p",[t._v("笔记：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("clickhouse查询kafka当中的数据，查询一次之后，数据就没了？？？每次都是消费一批kafka当中的数据，消费完了，就没了\n\n可以使用clickhouse去查询一批次的数据：最近五分钟的消费金额总和？？？\n使用clickhouse每隔五分钟去查询一次kafak当中的数据即可\n")])])]),n("p",[t._v("注意")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--这里使用select查询每条数据数据只能够读取一次。可以使用物化视图创建实时线程更实用。")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--实现步骤：")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--（1）使用引擎创建一个 Kafka 消费者并作为一条数据流。")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--（2）创建一个结构表。")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--（3）创建物化视图，改视图会在后台转换引擎中的数据并将其放入之前创建的表中。")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--当 MATERIALIZED VIEW 添加至引擎，它将会在后台收集数据。可以持续不断地从 Kafka 收---集数据并通过 SELECT 将数据转换为所需要的格式。")]),t._v("\n  \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" daily "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    total UInt64\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SummingMergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" MATERIALIZED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VIEW")]),t._v(" consumer "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TO")]),t._v(" daily\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" toDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("toDateTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("timestamp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" queue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("day")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("total"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" daily "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("level")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_8-2-hdfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-hdfs"}},[t._v("#")]),t._v(" 8.2 HDFS")]),t._v(" "),n("p",[t._v("该引擎允许通过ClickHouse 管理HDFS上的数据，从而与Apache Hadoop生态系统集成。")]),t._v(" "),n("h4",{attrs:{id:"_8-2-1-创建一张表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-创建一张表"}},[t._v("#")]),t._v(" 8.2.1 创建一张表")]),t._v(" "),n("p",[t._v("格式：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" HDFS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("URI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--URI:指定hdfs文件目录")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--format:指定数据的格式")]),t._v("\n")])])]),n("p",[t._v("演示：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" hdfs_engine_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("HDFS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hdfs://node01:8020/other_storage/*'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CSV'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--数据来自于hdfs上other_storage目录下的所有文件")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--文件的格式是CSV(字段之前的分隔符是逗号)")]),t._v("\n")])])]),n("p",[t._v("支持的数据格式 ：")]),t._v(" "),n("p",[t._v("https://clickhouse.tech/docs/zh/interfaces/formats/#formats")]),t._v(" "),n("h4",{attrs:{id:"_8-2-2-准备数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-2-准备数据"}},[t._v("#")]),t._v(" 8.2.2 准备数据")]),t._v(" "),n("p",[t._v("node01执行以下命令创建文件，然后上传到hdfs对应文件夹")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" file1.txt\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(",zhangsan,20\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(",lisi,29\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(",wangwu,25\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(",zhaoliu,35\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(",tianqi,35\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(",kobe,40\n")])])]),n("p",[t._v("上传文件到hdfs上对应的目录")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("hdfs  dfs -mkdir -p /other_storage \nhdfs dfs -put file1 /other_storage\n")])])]),n("h4",{attrs:{id:"_8-2-3-查看表数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-3-查看表数据"}},[t._v("#")]),t._v(" 8.2.3 查看表数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" hdfs_engine_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" hdfs_engine_table\n \n ┌─id─┬─name─────┬─age─┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ zhangsan │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ lisi     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(" │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ wangwu   │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" │ zhaoliu │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v(" │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" │ tianqi   │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v(" │\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" │ kobe     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" │\n └────┴──────────┴─────┘\n")])])]),n("h2",{attrs:{id:"_9-实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-实战"}},[t._v("#")]),t._v(" 9. 实战")]),t._v(" "),n("p",[t._v("需求：基于clickhouse对航班飞行数据进行分析处理")]),t._v(" "),n("h3",{attrs:{id:"_9-1-准备数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-准备数据"}},[t._v("#")]),t._v(" 9.1 准备数据")]),t._v(" "),n("p",[t._v("node01服务器执行以下命令，创建shell脚本")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" down_data.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("s")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1987")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("m")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("seq")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://transtats.bts.gov/PREZIP/On_Time_Reporting_Carrier_On_Time_Performance_1987_present_"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${s}")]),t._v("\n_"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${m}")]),t._v(".zip\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n")])])]),n("p",[t._v("该脚本主要是为了下载从1987年到 2018年航班飞行数据，由于数据量比较大，这里只使用1988年和1989年的飞行数据")]),t._v(" "),n("p",[n("img",{attrs:{src:a(444),alt:"img"}})]),t._v(" "),n("h3",{attrs:{id:"_9-2-创建表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-创建表"}},[t._v("#")]),t._v(" 9.2 创建表")]),t._v(" "),n("p",[t._v("node01服务器进入clickhouse的客户端，然后准备创建表")]),t._v(" "),n("p",[t._v("click-")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ontime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt16"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Quarter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Month")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DayofMonth"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DayOfWeek"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("FlightDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("UniqueCarrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("AirlineID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("TailNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("FlightNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginAirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginAirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginCityMarketID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Origin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginCityName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginStateFips"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginStateName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("OriginWac"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestAirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestAirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestCityMarketID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Dest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestCityName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestStateFips"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestStateName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DestWac"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("CRSDepTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DepTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DepDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DepDelayMinutes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DepDel15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DepartureDelayGroups"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DepTimeBlk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("TaxiOut"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("WheelsOff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("WheelsOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("TaxiIn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("CRSArrTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ArrTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ArrDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ArrDelayMinutes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ArrDel15"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ArrivalDelayGroups"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ArrTimeBlk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Cancelled"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("CancellationCode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" FixedString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Diverted"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("CRSElapsedTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ActualElapsedTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("AirTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Flights"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Distance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DistanceGroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" UInt8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("CarrierDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("WeatherDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("NASDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("SecurityDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("LateAircraftDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("FirstDepTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("TotalAddGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("LongestAddGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DivAirportLandings"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DivReachedDest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DivActualElapsedTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DivArrDelay"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("DivDistance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1Airport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1AirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1AirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1WheelsOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1TotalGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1LongestGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1WheelsOff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div1TailNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2Airport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2AirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2AirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2WheelsOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2TotalGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2LongestGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2WheelsOff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div2TailNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3Airport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3AirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3AirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3WheelsOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3TotalGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3LongestGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3WheelsOff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div3TailNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4Airport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4AirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4AirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4WheelsOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4TotalGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4LongestGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4WheelsOff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div4TailNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5Airport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5AirportID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5AirportSeqID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" Int32"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5WheelsOn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5TotalGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5LongestGTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5WheelsOff"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("Div5TailNum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" String\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MergeTree"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FlightDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" FlightDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_9-3-加载数据到表中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-加载数据到表中"}},[t._v("#")]),t._v(" 9.3 加载数据到表中")]),t._v(" "),n("p",[t._v("在数据所在的目录执行下面命令")]),t._v(" "),n("p",[t._v("将所有的数据上传到node01服务器的/kkb/soft/flydatas路径下")]),t._v(" "),n("p",[t._v("然后执行以下命令加载数据")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("sudo yum -y install unzip\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[t._v("i")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" *.zip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$i")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v(" -cq "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$i")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.csv'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sed")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s/\\.00//g'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" clickhouse-client  --query"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INSERT INTO ontime FORMAT CSVWithNames"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n")])])]),n("p",[t._v("·    加载成功后，查看表数据")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" node01 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ontime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n \n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime \n \n ┌──"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10243296")]),t._v(" │\n └──────────┘\n \n "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rows")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Elapsed: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.005")]),t._v(" sec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Processed "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.24")]),t._v(" million "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rows")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.24")]),t._v(" MB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.26")]),t._v(" billion "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rows")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.26")]),t._v(" GB"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])])]),n("h3",{attrs:{id:"_9-4-需求指标分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-需求指标分析"}},[t._v("#")]),t._v(" 9.4 需求指标分析")]),t._v(" "),n("h4",{attrs:{id:"_9-4-1-查询所有月份中航班数的最大值、最小值、平均值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-1-查询所有月份中航班数的最大值、最小值、平均值"}},[t._v("#")]),t._v(" 9.4.1 查询所有月份中航班数的最大值、最小值、平均值")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Month")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c1\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Month")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n ┌─"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┬─"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┬─"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("446769")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("395176")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("426804")]),t._v(" │\n └─────────┴─────────┴─────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-2-查询从1988年到1989年中周内的航班数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-2-查询从1988年到1989年中周内的航班数"}},[t._v("#")]),t._v(" 9.4.2 查询从1988年到1989年中周内的航班数")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" DayOfWeek"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1989")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" DayOfWeek\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" c "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n ┌─DayOfWeek─┬───────c─┐\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1497912")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1493143")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492544")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1489357")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1484423")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1420042")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1365875")]),t._v(" │\n └───────────┴─────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-3-查询从1988年到1989年中周内延误超过10分钟的航班数。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-3-查询从1988年到1989年中周内延误超过10分钟的航班数。"}},[t._v("#")]),t._v(" 9.4.3 查询从1988年到1989年中周内延误超过10分钟的航班数。")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" DayOfWeek"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1989")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" DayOfWeek\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" c "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n ┌─DayOfWeek─┬──────c─┐\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("307762")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("304375")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("290879")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("270656")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("243052")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("234229")]),t._v(" │\n │         "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("219208")]),t._v(" │\n └───────────┴────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-4-查询1988年到1989年每个机场延误超过10分钟以上的次数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-4-查询1988年到1989年每个机场延误超过10分钟以上的次数"}},[t._v("#")]),t._v(" 9.4.4 查询1988年到1989年每个机场延误超过10分钟以上的次数")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Origin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1989")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Origin\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" c "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n \n ┌─Origin──┬──────c─┐\n │ ORD\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("138100")]),t._v(" │\n │ DFW\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80991")]),t._v(" │\n │ ATL\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80184")]),t._v(" │\n │ CLT\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("68363")]),t._v(" │\n │ PIT\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("67484")]),t._v(" │\n │ LAX\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("63626")]),t._v(" │\n │ DEN\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("60269")]),t._v(" │\n │ SFO\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("58458")]),t._v(" │\n │ EWR\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("55438")]),t._v(" │\n │ STL\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("53238")]),t._v(" │\n └─────────┴────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-5-查询1988年各航空公司延误超过10分钟以上的次数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-5-查询1988年各航空公司延误超过10分钟以上的次数"}},[t._v("#")]),t._v(" 9.4.5 查询1988年各航空公司延误超过10分钟以上的次数")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" num\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" num "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n \n ┌─Carrier─┬────num─┐\n │ UA     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("113208")]),t._v(" │\n │ AA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("96946")]),t._v(" │\n │ DL     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("96443")]),t._v(" │\n │ PI     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("94642")]),t._v(" │\n │ CO     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80925")]),t._v(" │\n │ AL     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("78368")]),t._v(" │\n │ EA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("66918")]),t._v(" │\n │ NW     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64962")]),t._v(" │\n │ TW     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("51121")]),t._v(" │\n │ WN     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("44572")]),t._v(" │\n │ US     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26604")]),t._v(" │\n │ HP     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21175")]),t._v(" │\n │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v("     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13352")]),t._v(" │\n │ PA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10181")]),t._v(" │\n │ PS     │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5020")]),t._v(" │\n └─────────┴────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-6-查询1988年各航空公司延误超过10分钟以上的百分比"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-6-查询1988年各航空公司延误超过10分钟以上的百分比"}},[t._v("#")]),t._v(" 9.4.6 查询1988年各航空公司延误超过10分钟以上的百分比")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("c2 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" c3\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n        Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ANY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n        Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c2\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USING")]),t._v(" Carrier\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" c3 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("---更好的查询版本")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c3\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier\n \n \n ┌─Carrier─┬──────c─┬─────c2─┬─────────────────c3─┐\n │ AL     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("78368")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("361059")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21.705039896526607")]),t._v(" │\n │ PI     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("94642")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("470957")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20.095677524699706")]),t._v(" │\n │ US     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("26604")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("133324")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19.954396807776543")]),t._v(" │\n │ UA     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("113208")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("587144")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19.281130353030942")]),t._v(" │\n │ TW     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("51121")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("275819")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.534256160743094")]),t._v(" │\n │ CO     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80925")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("457031")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17.70667635236997")]),t._v(" │\n │ EA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("66918")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("389292")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17.18966739619617")]),t._v(" │\n │ WN     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("44572")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("262422")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16.984856452584005")]),t._v(" │\n │ NW     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("64962")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("431440")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.057018357129612")]),t._v(" │\n │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v("     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13352")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("89822")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.864955133486228")]),t._v(" │\n │ PA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10181")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("72264")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.088619506254844")]),t._v(" │\n │ AA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("96946")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("694757")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13.953943609060435")]),t._v(" │\n │ DL     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("96443")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("753983")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.791137200706117")]),t._v(" │\n │ PS     │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5020")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("41911")]),t._v(" │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.9777624012789")]),t._v(" │\n │ HP     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21175")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("180871")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.707238860845575")]),t._v(" │\n └─────────┴────────┴────────┴────────────────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-7-同上一个查询一致-只是查询范围扩大到1988年到1989年"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-7-同上一个查询一致-只是查询范围扩大到1988年到1989年"}},[t._v("#")]),t._v(" 9.4.7 同上一个查询一致,只是查询范围扩大到1988年到1989年")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" c3\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1989")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Carrier"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n ┌─Carrier─┬─────────────────c3─┐\n │ AA     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.973459265773348")]),t._v(" │\n │ AL     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21.705039896526607")]),t._v(" │\n │ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v("     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.402829935622318")]),t._v(" │\n │ CO     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16.96160617418744")]),t._v(" │\n │ DL     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.788366379301934")]),t._v(" │\n │ EA     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16.675253490185977")]),t._v(" │\n │ HP     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13.738282256500709")]),t._v(" │\n │ NW     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("14.799160318481144")]),t._v(" │\n │ PA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.59199720311088")]),t._v(" │\n │ PI     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("24.084359219776232")]),t._v(" │\n │ PS     │   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.9777624012789")]),t._v(" │\n │ TW     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.715348820366113")]),t._v(" │\n │ UA     │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.14408797247073")]),t._v(" │\n │ US     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("25.955873831985677")]),t._v(" │\n │ WN     │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20.385723408269595")]),t._v(" │\n └─────────┴────────────────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-8-每年航班延误超过10分钟的百分比"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-8-每年航班延误超过10分钟的百分比"}},[t._v("#")]),t._v(" 9.4.8 每年航班延误超过10分钟的百分比")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("c2\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" c1\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ontime\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ANY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" c2\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ontime\n     "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USING")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("---更好的查询版本")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("avg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DepDelay"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n ┌─"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),t._v("─┬─────divide"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("─┐\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v(" │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16.61709049583091")]),t._v(" │\n │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1989")]),t._v(" │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("19.950091248115527")]),t._v(" │\n └──────┴────────────────────┘\n")])])]),n("h4",{attrs:{id:"_9-4-9-每年更受人们喜爱的目的地"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-9-每年更受人们喜爱的目的地"}},[t._v("#")]),t._v(" 9.4.9 每年更受人们喜爱的目的地")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" DestCityName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uniqExact"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OriginCityName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" u\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" ontime\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1988")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Year")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1989")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" DestCityName\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" u "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--uniqExact去重")]),t._v("\n \n ┌─DestCityName──────────┬───u─┐\n │ Chicago"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IL           │ "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("111")]),t._v(" │\n │ Atlanta"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" GA           │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(" │\n │ Dallas"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Fort Worth"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TX │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),t._v(" │\n │ Denver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CO           │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),t._v(" │\n │ Pittsburgh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PA       │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("79")]),t._v(" │\n │ St"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Louis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MO         │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("78")]),t._v(" │\n │ Minneapolis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MN       │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(" │\n │ Charlotte"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NC         │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("69")]),t._v(" │\n │ Detroit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MI           │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("69")]),t._v(" │\n │ Phoenix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AZ           │  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("67")]),t._v(" │\n └───────────────────────┴─────┘\n")])])]),n("h2",{attrs:{id:"_10、hive表迁移到clickhouse"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10、hive表迁移到clickhouse"}},[t._v("#")]),t._v(" 10、hive表迁移到clickHouse")]),t._v(" "),n("p",[t._v("由于历史原因，很多公司的历史数仓都是基于hive构建，数据表都是存储在hive当中，如何实现hive表数据迁移到clickHouse就至关重要了，接下来我们来一起看看如何将hive表数据全部平滑的迁移到clickHouse里面来")]),t._v(" "),n("p",[t._v("由于我们hive的数据全部都是存储在hdfs上面的，所以我们"),n("strong",[t._v("直接将hdfs的数据加载到clickhouse里面创建的表里面来即可")]),t._v("，我们可以"),n("strong",[t._v("通过第三方插件例如datax或者waterdrop等数据传输工具，将hdfs的数据全部采集到clickhouse里面来即可")])]),t._v(" "),n("p",[t._v("需求："),n("strong",[t._v("将hive数据仓库当中的game_center这个库的ods_user_login表数据迁移到clickHouse表里面来")])]),t._v(" "),n("p",[t._v("这里涉及到数据的迁移，将hive当中的表数据迁移到clickHouse里面来，数据迁移的工具很多，例如sqoop，datax，waterdrop等，其中有一个比较优秀的插件叫做waterdrop的，可以非常方便的实现我们各种数据的迁移，官网链接如下：")]),t._v(" "),n("p",[t._v("https://interestinglab.github.io/waterdrop/#/")]),t._v(" "),n("p",[t._v("通过简单的配置即可，我们就可以通过waterdrop将各个地方的数据进行抽取到各个目的地去")]),t._v(" "),n("h3",{attrs:{id:"_1、waterdrop的基本介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、waterdrop的基本介绍"}},[t._v("#")]),t._v(" 1、waterdrop的基本介绍")]),t._v(" "),n("p",[t._v("官网链接如下：")]),t._v(" "),n("p",[t._v("https://interestinglab.github.io/waterdrop/#/")]),t._v(" "),n("p",[t._v("通过简单的配置即可，我们就可以通过waterdrop将各个地方的数据进行抽取到各个目的地去")]),t._v(" "),n("p",[n("img",{attrs:{src:a(445),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(446),alt:"img"}})]),t._v(" "),n("h3",{attrs:{id:"_2、waterdrop的安装与使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、waterdrop的安装与使用"}},[t._v("#")]),t._v(" 2、waterdrop的安装与使用")]),t._v(" "),n("p",[t._v("waterdrop使用"),n("strong",[t._v("spark的引擎")]),t._v("来实现数据的抽取和传输到目的地，所以"),n("strong",[t._v("使用waterdrop之前需要我们先安装好spark的环境，")])]),t._v(" "),n("p",[t._v("运行环境要求：")]),t._v(" "),n("p",[t._v("java运行环境，java >= 8")]),t._v(" "),n("p",[t._v("如果您要在集群环境中运行Waterdrop，那么需要以下Spark集群环境的任意一种：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("Spark on Yarn")])]),t._v(" "),n("li",[n("p",[t._v("Spark Standalone")])]),t._v(" "),n("li",[n("p",[t._v("Spark on Mesos")])])]),t._v(" "),n("p",[t._v("如果您的数据量较小或者只是做功能验证，也可以仅使用local模式启动，无需集群环境，Waterdrop支持单机运行。")]),t._v(" "),n("p",[t._v("waterdrop不支持spark1.x的各种版本，"),n("strong",[t._v("最低需要安装spark2.x的版本")]),t._v("，如果使用spark2.3.x的版本，那么waterdrop需要1.4.x及以上的版本")]),t._v(" "),n("h4",{attrs:{id:"第一步-安装spark集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一步-安装spark集群"}},[t._v("#")]),t._v(" 第一步：安装spark集群")]),t._v(" "),n("p",[t._v("我们这里已经安装成功，不用再进行安装，并且我们使用的spark集群版本是2.3.x版本")]),t._v(" "),n("h4",{attrs:{id:"第二步-集成spark与hive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二步-集成spark与hive"}},[t._v("#")]),t._v(" 第二步：集成spark与hive")]),t._v(" "),n("p",[t._v("由于我们需要将hive表当中的数据，导入到clickhouse当中去，而waterdrop又是借助于spark来进行数据抽取的，所以我们"),n("strong",[t._v("需要整合spark与hive")])]),t._v(" "),n("p",[t._v("node03执行以下命令，拷贝hive-site.xml")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hive-1.1.0-cdh5.14.2/conf\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" hive-site.xml  node01:/kkb/install/spark/conf/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" hive-site.xml  node02:/kkb/install/spark/conf/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" hive-site.xml  node03:/kkb/install/spark/conf/\n")])])]),n("h4",{attrs:{id:"第三步-启动hive的metastore以及hiveserver2服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三步-启动hive的metastore以及hiveserver2服务"}},[t._v("#")]),t._v(" 第三步：启动hive的metastore以及hiveserver2服务")]),t._v(" "),n("p",[t._v("使用spark作为引擎，读取hive表数据，我们"),n("strong",[t._v("需要启动hive的metastore服务")]),t._v("，node03执行以下命令启动hivedemetastore服务即可")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/hive-1.1.0-cdh5.14.2/\nbin/hive --service metastore  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#若配置了环境变量，则 hive --service metastore")]),t._v("\nbin/hive --service hiveserver2 \n")])])]),n("h4",{attrs:{id:"第四步-下载安装waterdrop-node02上"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第四步-下载安装waterdrop-node02上"}},[t._v("#")]),t._v(" 第四步：下载安装waterdrop（node02上）")]),t._v(" "),n("p",[t._v("我们这里使用waterdrop1.4.2的这个版本，waterdrop的下载地址如下：")]),t._v(" "),n("p",[t._v("https://github.com/InterestingLab/waterdrop/releases/download/v1.4.2/waterdrop-1.4.2.zip")]),t._v(" "),n("p",[n("strong",[t._v("node02")]),t._v("执行以下命令下载waterdrop")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/soft/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://github.com/InterestingLab/waterdrop/releases/download/v1.4.2/waterdrop-1.4.2.zip\n")])])]),n("p",[t._v("node02执行以下命令进行解压")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v(" waterdrop-1.4.2.zip -d /kkb/install/\n")])])]),n("h4",{attrs:{id:"第五步-修改waterdrop的配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第五步-修改waterdrop的配置文件"}},[t._v("#")]),t._v(" 第五步：修改waterdrop的配置文件")]),t._v(" "),n("p",[t._v("node02服务器执行以下命令，修改配置文件")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/waterdrop-1.4.2/config\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" waterdrop-env.sh\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("SPARK_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/kkb/install/spark\n")])])]),n("h4",{attrs:{id:"第六步-创建clickhouse数据库以及数据库表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第六步-创建clickhouse数据库以及数据库表"}},[t._v("#")]),t._v(" 第六步：创建clickhouse数据库以及数据库表")]),t._v(" "),n("p",[n("strong",[t._v("node02服务器")]),t._v("进入到clickHouse客户端，然后创建数据库以及数据库表")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("clickhouse-client -m\n")])])]),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("node02 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),t._v(" game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nnode02 :"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("创建clickHouse表")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ods_user_login\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    plat_id                 String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    server_id               Int32     "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    channel_id              String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    user_id                 String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    role_id                 String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    role_name               String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    client_ip               String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    event_time              Int32     "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    op_type                 String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  online_time             Int32     "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  operating_system        String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  operating_version       String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  device_brand            String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  device_type             String  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  part_date               "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),t._v(" \n  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MergeTree "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" part_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("part_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" SETTINGS index_granularity "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16384")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"第七步-开发clickhouse数据处理配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第七步-开发clickhouse数据处理配置文件"}},[t._v("#")]),t._v(" 第七步：开发clickHouse数据处理配置文件")]),t._v(" "),n("p",[t._v("node02执行以下命令开发waterdrop的配置文件")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/waterdrop-1.4.2/config\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" batch.conf\n")])])]),n("p",[t._v("配置文件内容如下")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("spark {\n  spark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Waterdrop"')]),t._v("\n  spark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("executor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instances "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  spark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("executor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cores "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  spark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("executor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memory "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1g"')]),t._v("\n  spark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("catalogImplementation "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hive"')]),t._v("\n}\n\ninput {\n   hive {\n        pre_sql "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * from game_center.ods_user_login"')]),t._v("\n        result_table_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ods_user_login2"')]),t._v("\n        table_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ods_user_login2"')]),t._v("\n    }\n\n }\nfilter {\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## split data by specific delimiter")]),t._v("\n  }\n\noutput {\n   clickhouse {\n        host "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node02:8123"')]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("database")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"game_center"')]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ods_user_login"')]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fields")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plat_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"server_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"channel_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role_name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"client_ip"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"event_time"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"op_type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"online_time"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"operating_system"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"operating_version"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"device_brand"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"device_type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        username "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n        password "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    }\n}\n")])])]),n("h4",{attrs:{id:"第八步-启动waterdrop导入数据到clickhouse表当中去"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第八步-启动waterdrop导入数据到clickhouse表当中去"}},[t._v("#")]),t._v(" 第八步：启动waterdrop导入数据到clickhouse表当中去")]),t._v(" "),n("p",[t._v("node02执行以下命令，启动waterdrop开始导入数据")]),t._v(" "),n("p",[t._v("使用spark的local模式进行运行")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/waterdrop-1.4.2/  \nbin/start-waterdrop.sh --config config/batch.conf -e client -m "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'local[2]'")]),t._v("\n")])])]),n("p",[t._v("如果想要使用spark的standAlone模式进行运行，通过以下方式进行提交("),n("strong",[t._v("必须确保spark已开启，而且--master对应的master是alive状态，batch.conf是上面那个自己创建的配置文件")]),t._v(")")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /kkb/install/waterdrop-1.4.2/  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## client 模式")]),t._v("\n./bin/start-waterdrop.sh --master spark://node01:7077 --deploy-mode client --config ./config/batch.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## cluster 模式")]),t._v("\n./bin/start-waterdrop.sh --master spark://node01:7077 --deploy-mode cluster --config ./config/batch.conf\n")])])]),n("p",[t._v("如果想要使用spark on yarn模式进行提交，那么通过以下方式进行提交")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## client 模式")]),t._v("\n./bin/start-waterdrop.sh --master "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" --deploy-mode client --config ./config/batch.conf\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## cluster 模式")]),t._v("\n./bin/start-waterdrop.sh --master "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" --deploy-mode cluster --config ./config/batch.conf\n")])])]),n("h4",{attrs:{id:"第九步-查询clickhouse数据-验证数据进入clickhouse"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第九步-查询clickhouse数据-验证数据进入clickhouse"}},[t._v("#")]),t._v(" 第九步：查询clickhouse数据，验证数据进入clickhouse")]),t._v(" "),n("p",[t._v("node02执行以下命令，查询clickhouse当中的数据")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("clickhouse-client  -m\nnode02.kaikeba.com "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" use game_center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nnode02.kaikeba.com "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" from ods_user_login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("img",{staticStyle:{zoom:"80%"},attrs:{src:"clickhouse.assets/image-20200521155555435.png",alt:"image-20200521155555435"}})])}),[],!1,null,null,null);s.default=e.exports},442:function(t,s,a){t.exports=a.p+"assets/img/clip_image002.e2ba6bbc.png"},443:function(t,s,a){t.exports=a.p+"assets/img/clip_image004.9cd7f02e.png"},444:function(t,s,a){t.exports=a.p+"assets/img/clip_image006.7d3e6c11.jpg"},445:function(t,s,a){t.exports=a.p+"assets/img/clip_image008.584dbb3f.jpg"},446:function(t,s,a){t.exports=a.p+"assets/img/clip_image010.d9cecb93.png"}}]);