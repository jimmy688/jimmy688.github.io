<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ansible简介 | 个人博客 | JiiiiG</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="自是年少，韶华倾负">
    
    <link rel="preload" href="/assets/css/0.styles.420b7c1f.css" as="style"><link rel="preload" href="/assets/js/app.fdd7a502.js" as="script"><link rel="preload" href="/assets/js/16.375b747e.js" as="script"><link rel="preload" href="/assets/js/43.587e7966.js" as="script"><link rel="prefetch" href="/assets/js/10.bbd38b9e.js"><link rel="prefetch" href="/assets/js/11.f49fc7d3.js"><link rel="prefetch" href="/assets/js/12.c5d97aa1.js"><link rel="prefetch" href="/assets/js/13.426d0224.js"><link rel="prefetch" href="/assets/js/14.1f257a58.js"><link rel="prefetch" href="/assets/js/15.be29bb6a.js"><link rel="prefetch" href="/assets/js/17.d02cdd8b.js"><link rel="prefetch" href="/assets/js/18.5d2371a4.js"><link rel="prefetch" href="/assets/js/19.038919a3.js"><link rel="prefetch" href="/assets/js/2.d6257727.js"><link rel="prefetch" href="/assets/js/20.b3582e09.js"><link rel="prefetch" href="/assets/js/21.0c1e826b.js"><link rel="prefetch" href="/assets/js/22.91bff1a5.js"><link rel="prefetch" href="/assets/js/23.faacea60.js"><link rel="prefetch" href="/assets/js/24.69816497.js"><link rel="prefetch" href="/assets/js/25.c9fcaa62.js"><link rel="prefetch" href="/assets/js/26.d28c3abe.js"><link rel="prefetch" href="/assets/js/27.1518da7d.js"><link rel="prefetch" href="/assets/js/28.748a5581.js"><link rel="prefetch" href="/assets/js/29.775019f1.js"><link rel="prefetch" href="/assets/js/3.141002a4.js"><link rel="prefetch" href="/assets/js/30.74e7c570.js"><link rel="prefetch" href="/assets/js/31.190b11f2.js"><link rel="prefetch" href="/assets/js/32.d8f4f116.js"><link rel="prefetch" href="/assets/js/33.c489bc81.js"><link rel="prefetch" href="/assets/js/34.db609d51.js"><link rel="prefetch" href="/assets/js/35.ad3402e6.js"><link rel="prefetch" href="/assets/js/36.45f11923.js"><link rel="prefetch" href="/assets/js/37.b47e0576.js"><link rel="prefetch" href="/assets/js/38.58b934a2.js"><link rel="prefetch" href="/assets/js/39.e4d6bcdf.js"><link rel="prefetch" href="/assets/js/4.e9b44388.js"><link rel="prefetch" href="/assets/js/40.555106bc.js"><link rel="prefetch" href="/assets/js/41.4387ceb1.js"><link rel="prefetch" href="/assets/js/42.9bd4aea0.js"><link rel="prefetch" href="/assets/js/44.80285763.js"><link rel="prefetch" href="/assets/js/45.f978da77.js"><link rel="prefetch" href="/assets/js/46.d93e3f2e.js"><link rel="prefetch" href="/assets/js/47.c15bd2aa.js"><link rel="prefetch" href="/assets/js/48.cb55fa72.js"><link rel="prefetch" href="/assets/js/49.d0f4e454.js"><link rel="prefetch" href="/assets/js/5.b90b80cb.js"><link rel="prefetch" href="/assets/js/50.112e8260.js"><link rel="prefetch" href="/assets/js/51.a66bcd03.js"><link rel="prefetch" href="/assets/js/52.0c7cbfb1.js"><link rel="prefetch" href="/assets/js/53.67ef240b.js"><link rel="prefetch" href="/assets/js/54.2c2d082d.js"><link rel="prefetch" href="/assets/js/55.88f19a20.js"><link rel="prefetch" href="/assets/js/56.c726e920.js"><link rel="prefetch" href="/assets/js/57.eaee47c5.js"><link rel="prefetch" href="/assets/js/58.ac15a3ac.js"><link rel="prefetch" href="/assets/js/59.64bdc849.js"><link rel="prefetch" href="/assets/js/6.7eea74ff.js"><link rel="prefetch" href="/assets/js/7.a1370e98.js"><link rel="prefetch" href="/assets/js/8.2e898240.js"><link rel="prefetch" href="/assets/js/9.a2439994.js">
    <link rel="stylesheet" href="/assets/css/0.styles.420b7c1f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人博客 | JiiiiG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/linux/linux常用命令/01linux常用命令01.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hadoop/01hadoop环境搭建/01搭建hadoop集群.html" class="nav-link">
  hadoop
</a></li><li class="dropdown-item"><!----> <a href="/hbase/hbase.html" class="nav-link">
  hbase
</a></li><li class="dropdown-item"><!----> <a href="/flink/flink.html" class="nav-link">
  flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ansible/.html" class="nav-link">
  java
</a></li></ul></div></div> <a href="https://github.com/MaLunan/press" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/linux/linux常用命令/01linux常用命令01.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hadoop/01hadoop环境搭建/01搭建hadoop集群.html" class="nav-link">
  hadoop
</a></li><li class="dropdown-item"><!----> <a href="/hbase/hbase.html" class="nav-link">
  hbase
</a></li><li class="dropdown-item"><!----> <a href="/flink/flink.html" class="nav-link">
  flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ansible/.html" class="nav-link">
  java
</a></li></ul></div></div> <a href="https://github.com/MaLunan/press" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ansible简介"><a href="#ansible简介" class="header-anchor">#</a> ansible简介</h2> <p>ansible是一个自动化部署工具，主要应用场景有配置系统、软件部署、持续发布及不停服平滑滚动更新的高级任务编排。</p> <p>ansible版本更新很快，社区贡献的新模块和组件发展的非常快，每个版本都会合入很多的新模块。</p> <p>安装ansible的时候，建议安装较新版本。</p> <p>ansible官方文档：</p> <ul><li>https://cn-ansibledoc.readthedocs.io/zh_CN/latest/</li> <li>https://docs.ansible.com/ansible/latest/user_guide/index.html</li> <li>http://www.ansible.com.cn/docs/intro_installation.html</li></ul> <h2 id="ansible的安装"><a href="#ansible的安装" class="header-anchor">#</a> ansible的安装</h2> <h3 id="准备工作"><a href="#准备工作" class="header-anchor">#</a> 准备工作</h3> <p><strong>管理机环境要求：</strong></p> <p>准备一台管理机，该管理机可通过 SSH 连接到你所有的被管理机。</p> <p>运行 Ansible 的服务器必须且只需要安装有 Python 2.7+ 或者 Python 3.5+。Red Hat, Debian, CentOS, macOS, 任一 BSD 系列的系统均可。 但<code>Windows</code> 不能用于管理机。</p> <p>选择管理机时，需要注意的时，网络条件越好越便于管理。 比如：当你选择在云上使用 Ansible 时，那么管理机和管理节点都在云上是最佳选择，连接外网的节点速度则会慢很多，也存在很大的安全风险。</p> <p><strong>受管节点环境要求：</strong></p> <p>受管节点需要和外界正常通信，默认使用 SSH 协议。 默认使用 SFTP 。 如果 SFTP 无法使用，你可以在 ansible.cfg 中将其修改为 SCP。</p> <p>同样，受管机需要有 Python 2.6+ 或 Python 3.5以上的环境。</p> <p>默认情况下 Ansible 使用 <code>/usr/bin/python</code> 下的Python 解释器运行命令。 但部分 Linux 发行版可能只安装了 Python 3 解释器，可以从 <code>/usr/bin/python3</code> 找到。</p> <p>1、可以通过inventory文件来设置指定python解释器 <a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#ansible-python-interpreter" target="_blank" rel="noopener noreferrer">ansible_python_interpreter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，如：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>freebsd_host      <span class="token assign-left variable">ansible_python_interpreter</span><span class="token operator">=</span>/usr/local/bin/python
</code></pre></div><p>2、也可以干脆安装一个 Python 2的解释器。如果 Python 2 的解释器没有安装在指定目录 <strong>/usr/bin/python</strong> 。也需要使用第一种方法来指定解释器的位置。</p> <h3 id="开始安装"><a href="#开始安装" class="header-anchor">#</a> 开始安装</h3> <p><strong>安装ansible的方式有一下几种：</strong></p> <ul><li>使用系统默认的包管理器安装 (<code>for Red Hat Enterprise Linux (TM), CentOS, Fedora, Debian, or Ubuntu</code>).</li> <li>使用<code>pip</code>安装</li> <li>源码安装 <code>devel</code> 版本的Ansible，体验最新版本的功能</li></ul> <p>1、<strong>在ubuntu中配置 PPA 来安装：</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">sudo</span> <span class="token function">apt</span> update
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> software-properties-common
$ <span class="token function">sudo</span> apt-add-repository --yes --update ppa:ansible/ansible
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ansible
</code></pre></div><p>2、<strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/installation_guide/intro_installation.html#id32" target="_blank" rel="noopener noreferrer">从源码安装运行 Ansible (devel)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p>3、<strong>安装指定版本的ansible:</strong></p> <h2 id="配置ansible"><a href="#配置ansible" class="header-anchor">#</a> 配置ansible</h2> <p>配置ansible有几种方式：</p> <div class="language- extra-class"><pre class="language-text"><code>1、配置文件
2、系统环境配置
3、命令行选项
</code></pre></div><p><code>ansible</code>的配置文件是<code>ansible.cfg</code>，核心配置都在这个文件中。</p> <p>如果通过包管理工具安装的，那最新的 <code>ansible.cfg</code> 默认存放在 <code>/etc/ansible</code> 中，也有可能因为重复安装或升级，文件是以 <code>.rpmnew</code> 结尾。</p> <hr> <p>ansible配置支持系统变量，<strong>如果系统环境设置了，会覆盖ansible的配置。</strong></p> <hr> <p><strong>在命令行指定的配置优先级比从配置文件中读取的优化级要高</strong>，也即会覆盖从配置文件中读取的环境变量。</p> <h2 id="用户指南"><a href="#用户指南" class="header-anchor">#</a> 用户指南</h2> <p>欢迎使用 Ansible User Guide!</p> <p>该页内容包括命令行使用、配置 inventory、编写 playbooks.</p> <ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/quickstart.html" target="_blank" rel="noopener noreferrer">Ansible 快速入门指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Ansible 概览
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id2" target="_blank" rel="noopener noreferrer">管理机<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id3" target="_blank" rel="noopener noreferrer">受控节点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#inventory" target="_blank" rel="noopener noreferrer">Inventory 仓库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#modules" target="_blank" rel="noopener noreferrer">Modules 模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#tasks" target="_blank" rel="noopener noreferrer">Tasks 任务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#playbooks" target="_blank" rel="noopener noreferrer">Playbooks 任务剧本<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>入门
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_getting_started.html#id3" target="_blank" rel="noopener noreferrer">选择指定机器执行<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_getting_started.html#remote-connection-information" target="_blank" rel="noopener noreferrer">连接远程受控节点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_getting_started.html#id8" target="_blank" rel="noopener noreferrer">复制和执行模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_getting_started.html#id10" target="_blank" rel="noopener noreferrer">接下来<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Inventory 使用进阶
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#inventory-formats-hosts-and-groups" target="_blank" rel="noopener noreferrer">Inventory 基础: formats, hosts, and groups<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#id6" target="_blank" rel="noopener noreferrer">Inventory 变量定义<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#host-variables" target="_blank" rel="noopener noreferrer">给单台主机设置变量 : host variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#group-variables" target="_blank" rel="noopener noreferrer">给多台主机设置变量 : group variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#splitting-out-vars" target="_blank" rel="noopener noreferrer">编排主机和组变量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#how-we-merge" target="_blank" rel="noopener noreferrer">变量合并<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#using-multiple-inventory-sources" target="_blank" rel="noopener noreferrer">使用多个 Inventory<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#behavioral-parameters" target="_blank" rel="noopener noreferrer">主机连接: Inventory 参数设置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_inventory.html#inventory-setup-examples" target="_blank" rel="noopener noreferrer">Inventory 设置示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>动态 Inventory 清单配置
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_dynamic_inventory.html#inventory-cobbler" target="_blank" rel="noopener noreferrer">Inventory 脚本示例: Cobbler<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_dynamic_inventory.html#inventory-aws-ec2" target="_blank" rel="noopener noreferrer">Inventory 清单脚本示例: AWS EC2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_dynamic_inventory.html#inventory-openstack" target="_blank" rel="noopener noreferrer">Inventory 脚本示例: OpenStack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_dynamic_inventory.html#inventory-scripts" target="_blank" rel="noopener noreferrer">其它 inventory scripts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_dynamic_inventory.html#inventory-inventory" target="_blank" rel="noopener noreferrer">Inventory 目录和多个 Inventory 源的使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_dynamic_inventory.html#static-groups-of-dynamic" target="_blank" rel="noopener noreferrer">动态组中的静态组<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Pattern: 正则匹配主机和组
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_patterns.html#patterns" target="_blank" rel="noopener noreferrer">使用 patterns 模式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_patterns.html#common-patterns" target="_blank" rel="noopener noreferrer">通过 patterns<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_patterns.html#id3" target="_blank" rel="noopener noreferrer">patterns 局限性<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_patterns.html#id4" target="_blank" rel="noopener noreferrer">高级 Pattern 选项<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_patterns.html#patterns-and-ansible-playbook" target="_blank" rel="noopener noreferrer">Patterns and ansible-playbook 标志<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>ad-hoc 命令操作指引
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_adhoc.html#why-use-ad-hoc-commands" target="_blank" rel="noopener noreferrer">Why use ad-hoc commands?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_adhoc.html#use-cases-for-ad-hoc-tasks" target="_blank" rel="noopener noreferrer">Use cases for ad-hoc tasks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Connection methods and details
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/connection_details.html#controlpersist-and-paramiko" target="_blank" rel="noopener noreferrer">ControlPersist and paramiko<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/connection_details.html#setting-a-remote-user" target="_blank" rel="noopener noreferrer">Setting a remote user<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/connection_details.html#setting-up-ssh-keys" target="_blank" rel="noopener noreferrer">Setting up SSH keys<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/connection_details.html#running-against-localhost" target="_blank" rel="noopener noreferrer">Running against localhost<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/connection_details.html#managing-host-key-checking" target="_blank" rel="noopener noreferrer">Managing host key checking<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/connection_details.html#other-connection-methods" target="_blank" rel="noopener noreferrer">Other connection methods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Working with command line tools</li> <li>Working With Playbooks
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_intro.html" target="_blank" rel="noopener noreferrer">Intro to Playbooks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_best_practices.html" target="_blank" rel="noopener noreferrer">Tips and tricks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_reuse.html" target="_blank" rel="noopener noreferrer">Re-using Ansible artifacts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_reuse_roles.html" target="_blank" rel="noopener noreferrer">Roles<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_variables.html" target="_blank" rel="noopener noreferrer">Using Variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_templating.html" target="_blank" rel="noopener noreferrer">Templating (Jinja2)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_conditionals.html" target="_blank" rel="noopener noreferrer">Conditionals<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_loops.html" target="_blank" rel="noopener noreferrer">Loops<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_blocks.html" target="_blank" rel="noopener noreferrer">Blocks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_special_topics.html" target="_blank" rel="noopener noreferrer">Advanced Playbooks Features<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_strategies.html" target="_blank" rel="noopener noreferrer">Controlling playbook execution: strategies and more<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/guide_rolling_upgrade.html" target="_blank" rel="noopener noreferrer">Playbook Example: Continuous Delivery and Rolling Upgrades<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Understanding privilege escalation: become
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/become.html#using-become" target="_blank" rel="noopener noreferrer">Using become<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/become.html#risks-and-limitations-of-become" target="_blank" rel="noopener noreferrer">Risks and limitations of become<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/become.html#become-and-network-automation" target="_blank" rel="noopener noreferrer">Become and network automation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/become.html#become-and-windows" target="_blank" rel="noopener noreferrer">Become and Windows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Ansible Vault
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#what-can-be-encrypted-with-vault" target="_blank" rel="noopener noreferrer">What Can Be Encrypted With Vault<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#vault-ids-and-multiple-vault-passwords" target="_blank" rel="noopener noreferrer">Vault IDs and Multiple Vault Passwords<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#creating-encrypted-files" target="_blank" rel="noopener noreferrer">Creating Encrypted Files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#editing-encrypted-files" target="_blank" rel="noopener noreferrer">Editing Encrypted Files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#rekeying-encrypted-files" target="_blank" rel="noopener noreferrer">Rekeying Encrypted Files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#encrypting-unencrypted-files" target="_blank" rel="noopener noreferrer">Encrypting Unencrypted Files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#decrypting-encrypted-files" target="_blank" rel="noopener noreferrer">Decrypting Encrypted Files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#viewing-encrypted-files" target="_blank" rel="noopener noreferrer">Viewing Encrypted Files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#use-encrypt-string-to-create-encrypted-variables-to-embed-in-yaml" target="_blank" rel="noopener noreferrer">Use encrypt_string to create encrypted variables to embed in yaml<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#providing-vault-passwords" target="_blank" rel="noopener noreferrer">Providing Vault Passwords<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#vault-password-client-scripts" target="_blank" rel="noopener noreferrer">Vault Password Client Scripts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#speeding-up-vault-operations" target="_blank" rel="noopener noreferrer">Speeding Up Vault Operations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#vault-format" target="_blank" rel="noopener noreferrer">Vault Format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/vault.html#vault-payload-format-1-1-1-2" target="_blank" rel="noopener noreferrer">Vault Payload Format 1.1 - 1.2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Sample Ansible setup
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#sample-directory-layout" target="_blank" rel="noopener noreferrer">Sample directory layout<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#alternative-directory-layout" target="_blank" rel="noopener noreferrer">Alternative directory layout<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#sample-group-and-host-variables" target="_blank" rel="noopener noreferrer">Sample group and host variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#sample-playbooks-organized-by-function" target="_blank" rel="noopener noreferrer">Sample playbooks organized by function<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#sample-task-and-handler-files-in-a-function-based-role" target="_blank" rel="noopener noreferrer">Sample task and handler files in a function-based role<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#what-the-sample-setup-enables" target="_blank" rel="noopener noreferrer">What the sample setup enables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#organizing-for-deployment-or-configuration" target="_blank" rel="noopener noreferrer">Organizing for deployment or configuration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/sample_setup.html#using-local-ansible-modules" target="_blank" rel="noopener noreferrer">Using local Ansible modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Working With Modules
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/modules_intro.html" target="_blank" rel="noopener noreferrer">Introduction to modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/reference_appendices/common_return_values.html" target="_blank" rel="noopener noreferrer">Return Values<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/modules_support.html" target="_blank" rel="noopener noreferrer">Module Maintenance &amp; Support<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Working With Plugins
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/action.html" target="_blank" rel="noopener noreferrer">Action Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/become.html" target="_blank" rel="noopener noreferrer">Become Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/cache.html" target="_blank" rel="noopener noreferrer">Cache Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/callback.html" target="_blank" rel="noopener noreferrer">Callback Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/cliconf.html" target="_blank" rel="noopener noreferrer">Cliconf Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/connection.html" target="_blank" rel="noopener noreferrer">Connection Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/httpapi.html" target="_blank" rel="noopener noreferrer">Httpapi Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/inventory.html" target="_blank" rel="noopener noreferrer">Inventory Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/lookup.html" target="_blank" rel="noopener noreferrer">Lookup Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/netconf.html" target="_blank" rel="noopener noreferrer">Netconf Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/shell.html" target="_blank" rel="noopener noreferrer">Shell Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/strategy.html" target="_blank" rel="noopener noreferrer">Strategy Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/plugins/vars.html" target="_blank" rel="noopener noreferrer">Vars Plugins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_filters.html" target="_blank" rel="noopener noreferrer">Filters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/playbooks_tests.html" target="_blank" rel="noopener noreferrer">Tests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/plugin_filtering_config.html" target="_blank" rel="noopener noreferrer">Plugin Filter Configuration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Ansible and BSD
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#connecting-to-bsd-nodes" target="_blank" rel="noopener noreferrer">Connecting to BSD nodes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#bootstrapping-bsd" target="_blank" rel="noopener noreferrer">Bootstrapping BSD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#setting-the-python-interpreter" target="_blank" rel="noopener noreferrer">Setting the Python interpreter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#which-modules-are-available" target="_blank" rel="noopener noreferrer">Which modules are available?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#using-bsd-as-the-control-node" target="_blank" rel="noopener noreferrer">Using BSD as the control node<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#bsd-facts" target="_blank" rel="noopener noreferrer">BSD facts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/intro_bsd.html#bsd-efforts-and-contributions" target="_blank" rel="noopener noreferrer">BSD efforts and contributions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Windows Guides
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/windows_setup.html" target="_blank" rel="noopener noreferrer">Setting up a Windows Host<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/windows_winrm.html" target="_blank" rel="noopener noreferrer">Windows Remote Management<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/windows_usage.html" target="_blank" rel="noopener noreferrer">Using Ansible and Windows<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/windows_dsc.html" target="_blank" rel="noopener noreferrer">Desired State Configuration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/windows_performance.html" target="_blank" rel="noopener noreferrer">Windows performance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/windows_faq.html" target="_blank" rel="noopener noreferrer">Windows Frequently Asked Questions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>Using collections
<ul><li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/collections_using.html#installing-collections" target="_blank" rel="noopener noreferrer">Installing collections<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/collections_using.html#listing-collections" target="_blank" rel="noopener noreferrer">Listing collections<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/collections_using.html#verifying-collections" target="_blank" rel="noopener noreferrer">Verifying collections<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/collections_using.html#using-collections-in-a-playbook" target="_blank" rel="noopener noreferrer">Using collections in a Playbook<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/collections_using.html#simplifying-module-names-with-the-collections-keyword" target="_blank" rel="noopener noreferrer">Simplifying module names with the <code>collections</code> keyword<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <hr> <h2 id="ansible概览"><a href="#ansible概览" class="header-anchor">#</a> ansible概览</h2> <p><strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id4" target="_blank" rel="noopener noreferrer">管理机<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p>任何安装了 Ansbile 的服务器，你都可以使用 <code>ansible</code> or <code>ansible-playbook</code> 命令。 任何安装了 Ansbile 的机器都可以做为管理节点，便携式计算机，共享桌面和服务器都可以。 你可以配置多个管理节点。唯一需要注意的是，<strong>管理节点不支持 Windows 系统。</strong></p> <p><strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id5" target="_blank" rel="noopener noreferrer">受管节点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p>Ansbile 管理的服务器或者网络设备都称为受控节点。 受控节点有时候也叫做 “hosts” ( 主机 ). 受控节点不需要安装 Ansible.</p> <p><strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id6" target="_blank" rel="noopener noreferrer">Inventory<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p>Inventory是保存受控节点的信息列表，类似于系统的 hosts 文件。Inventory 可以用 IP 的方式指定受控节点。</p> <p><strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id7" target="_blank" rel="noopener noreferrer">Modules 模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p>Modules 模块是 Ansible 执行代码的最小单元。 每个模块都是特殊用途，从特殊类型的数据库用户管理，到特殊类型的网络设备  VLAN 接口管理。  你可以通过一个任务调用单个模块，也可以在一个剧本中调用多个不同的模块。</p> <p><strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id8" target="_blank" rel="noopener noreferrer">Tasks 任务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p>Ansible 执行操作的最小单位。 ad-hoc 更适合临时执行命令的执行场景。</p> <p><strong><a href="https://cn-ansibledoc.readthedocs.io/zh_CN/latest/user_guide/basic_concepts.html#id9" target="_blank" rel="noopener noreferrer">Playbooks 任务剧本<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <p><strong>playbook是一个任务task的列表</strong>，可以按照顺序重复运行，playbook可以同时包含变量和任务。</p> <p>playbook通常使用yaml文件来编写。</p> <hr> <h2 id="ansible初体验"><a href="#ansible初体验" class="header-anchor">#</a> ansible初体验</h2> <h3 id="创建一个inventory"><a href="#创建一个inventory" class="header-anchor">#</a> 创建一个Inventory</h3> <p>编辑<code>/etc/ansible/hosts</code>文件或者自己创建一个<code>Inventory</code>文件。可以通过<strong>IP或者域名</strong>来添加受管理的主机，如：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token number">192.0</span>.2.50
aserver.example.org
bserver.example.org
</code></pre></div><h3 id="检查ssh连接"><a href="#检查ssh连接" class="header-anchor">#</a> 检查ssh连接</h3> <p>确保管理节点可以通过<code>ssh</code>协议使用同一个用户名连接到所有的节点，如果有必要，也可以将<code>ssh</code>公钥添加到<code>authorized_keys</code>文件中。</p> <p>设置并测试ssh免密登录的方法：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ssh-keygen
ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.52.137
<span class="token function">ssh</span> root@192.168.52.137
</code></pre></div><p>可以通过以下几种方式来<strong>覆盖默认的用户名</strong>：</p> <ul><li>在命令行中通过<code>-u</code>选项来指定</li> <li>在<code>Inventory</code>文件中设置用户信息</li> <li>在<code>ansible</code>配置文件中设置用户信息</li> <li>设置环境变量</li></ul> <p>点击此处查看上面几种方式的优先级规则： <a href="https://docs.ansible.com/ansible/latest/reference_appendices/general_precedence.html#general-precedence-rules" target="_blank" rel="noopener noreferrer">Controlling how Ansible behaves: precedence rules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>连接上受管节点后，就可以通过命令行或者playbook将模块传到远程机器来运行了。</p> <h3 id="运行ansible命令"><a href="#运行ansible命令" class="header-anchor">#</a> 运行ansible命令</h3> <p>使用ping模块，用ping测试连接 <code>Inventory</code>文件中的所有节点：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ansible all -m <span class="token function">ping</span>
</code></pre></div><p>在所有节点上运行命令：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ansible all -a <span class="token string">&quot;/bin/echo hello&quot;</span>
</code></pre></div><p>如果需要<strong>提升权限</strong>来执行权限，可以使用 <code>become</code>选项：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">## as bruce</span>
$ ansible all -m <span class="token function">ping</span> -u bruce
<span class="token comment">## as bruce, sudoing to root (sudo is default method)</span>
$ ansible all -m <span class="token function">ping</span> -u bruce --become
<span class="token comment">## as bruce, sudoing to batman</span>
$ ansible all -m <span class="token function">ping</span> -u bruce --become --become-user batman
</code></pre></div><p>点击此处查看更多扩大权限的方法：<a href="https://docs.ansible.com/ansible/latest/user_guide/become.html#become" target="_blank" rel="noopener noreferrer">Understanding privilege escalation: become<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>ansible默认使用<code>sftp</code>来传输文件，如果你的机器不支持<code>sftp</code>，可以配置切换到<code>scp</code>模式。配置方法：<a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_configuration.html#intro-configuration" target="_blank" rel="noopener noreferrer">Configuring Ansible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ad-hoc命令"><a href="#ad-hoc命令" class="header-anchor">#</a> ad-hoc命令</h2> <h3 id="ad-hoc命令介绍"><a href="#ad-hoc命令介绍" class="header-anchor">#</a> ad-hoc命令介绍</h3> <p><code>ad-hoc</code>的理解：<strong>临时的，简单的，可实现目的的</strong>任意一种简单方式。</p> <p><code>ad-hoc</code>对不需要重复运行的任务的很有帮助，比如，想要关闭所有的机器，可以执行一个简单的命令即可，而不需要写一个playbook。</p> <p><code>ad-hoc</code>命令的格式如下：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token punctuation">[</span>pattern<span class="token punctuation">]</span> -m <span class="token punctuation">[</span>module<span class="token punctuation">]</span> -a <span class="token string">&quot;[module options]&quot;</span>
</code></pre></div><p>点击此处查看 <a href="https://docs.ansible.com/ansible/latest/user_guide/intro_patterns.html#intro-patterns" target="_blank" rel="noopener noreferrer">patterns<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://docs.ansible.com/ansible/latest/user_guide/modules.html#working-with-modules" target="_blank" rel="noopener noreferrer">modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><code>an-hoc</code>命令可以使用<code>ansible</code>的任意模块来执行任务。</p> <p><code>ad-hoc</code>命令和<code>playbook</code>一样，使用声明式模型，计算并执行达到指定最终状态所需的操作。它们通过在开始前<strong>检查当前状态来实现一种幂等形式</strong>，除非当前状态与指定的最终状态不同，否则什么也不做。</p> <h3 id="例子-重启一个组的机器"><a href="#例子-重启一个组的机器" class="header-anchor">#</a> 例子：重启一个组的机器</h3> <p><code>ansible</code>命令行工具的默认模块是： <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/command_module.html#command-module" target="_blank" rel="noopener noreferrer">ansible.builtin.command module<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。可以使用<code>ad-hoc</code>命令来<code>command</code>命令模块来重启机器，不需要使用<code>-m</code>来指定使用的模块。</p> <p>配置<code>Inventory</code>文件：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token number">192.168</span>.51.137
<span class="token number">192.168</span>.51.138
<span class="token number">192.168</span>.51.139
</code></pre></div><p>执行ad-hoc命令：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -a <span class="token string">&quot;/sbin/reboot&quot;</span>
</code></pre></div><p>默认情况下，ansible只会使用5个并发线程来执行任务，如果你有更多的机器，可能会花费一点时间。</p> <p>可以通过<code>-f</code>选项来设定并发个数，如使用10个并发数来重启机器：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -a <span class="token string">&quot;/sbin/reboot&quot;</span> -f <span class="token number">10</span>
</code></pre></div><p><code>ansible</code>默认会用当前用户来执行任务，可以<code>-u</code>选项来使用其它用户连接受管机器：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -a <span class="token string">&quot;/sbin/reboot&quot;</span> -f <span class="token number">10</span> -u jinguang
</code></pre></div><p>使用sudo提升用户权限：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -a <span class="token string">&quot;/sbin/reboot&quot;</span> -f <span class="token number">10</span> -u username --become <span class="token punctuation">[</span>--ask-become-pass<span class="token punctuation">]</span>
</code></pre></div><p>如果使用<code>--ask-become-pass</code>选项，ansible会提示您输入用于权限提升的密码（sudo/su/pfexec/doas/etc）</p> <p>上面的例子，没有使用<code>-m</code>来指定模块，而是使用默认的<code>command</code>模块。</p> <p>我们可以使用-<code>m</code>选项来指定使用的模块：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible raleigh -m ansible.builtin.shell -a <span class="token string">'echo <span class="token environment constant">$TERM</span>'</span>
<span class="token comment">#可以去掉ansible.builtin前缀</span>
</code></pre></div><h3 id="例子-管理文件"><a href="#例子-管理文件" class="header-anchor">#</a> 例子：管理文件</h3> <p><code>ad-hoc</code>命令可以利用<code>ansible</code>和<code>scp</code>的功能来<strong>将文件并行传输到多个机器</strong>。</p> <p>例如，传输文件到一个主机组中的所有机器：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m ansible.builtin.copy -a <span class="token string">&quot;src=/etc/hosts dest=/temp/hosts&quot;</span>
<span class="token comment">#可以去掉sible.builtin前缀</span>
</code></pre></div><p><a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html#file-module" target="_blank" rel="noopener noreferrer">ansible.builtin.file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 模块可以设置传输的文件的所有者和权限：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible webservers -m ansible.builtin.file -a <span class="token string">&quot;dest=/srv/foo/a.txt mode=600&quot;</span>
$ ansible webservers -m ansible.builtin.file -a <span class="token string">&quot;dest=/srv/foo/b.txt mode=600 owner=mdehaan group=mdehaan&quot;</span>
</code></pre></div><p><code>copy</code>模块也可以使用上面的选项来设置所有者和权限：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m copy -a <span class="token string">&quot;src=/home/test1/hello.txt dest=/home/test2 owner=root&quot;</span>
</code></pre></div><p><code>file</code>模块可以创建目录，等同于命令<code>mkdir -p</code>：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m <span class="token function">file</span> -a <span class="token string">&quot;dest=/home/a owner=root group=root state=directory&quot;</span>
</code></pre></div><p>file模块也可以递归删除目录和文件：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m <span class="token function">file</span> -a <span class="token string">&quot;dest=/home/a state=absent&quot;</span>
</code></pre></div><h3 id="例子-管理package"><a href="#例子-管理package" class="header-anchor">#</a> 例子：管理package</h3> <p>可以使用<code>ansible.builtin.yum</code>模块来安装package：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m yum -a <span class="token string">&quot;name=lrzsz state=present&quot;</span>
</code></pre></div><p>安装指定版本：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m yum -a <span class="token string">&quot;name=acme-1.5 state=present&quot;</span>
</code></pre></div><p>安装最新版本：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m yum -a <span class="token string">&quot;name=lrzsz state=latest&quot;</span>
</code></pre></div><p>确保一个package没有被下载安装：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible <span class="token builtin class-name">test</span> -m yum -a <span class="token string">&quot;name=lrzsz state=absent&quot;</span>
</code></pre></div><h3 id="例子-管理用户和组"><a href="#例子-管理用户和组" class="header-anchor">#</a> 例子：管理用户和组</h3> <p><code>ad-hoc</code>命令可以使用<code>ansible.builtin.user</code>模块来创建、删除受管节点的用户。</p> <p>创建用户：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ansible <span class="token builtin class-name">test</span> -m user -a <span class="token string">&quot;name=user01 password=123456&quot;</span>
</code></pre></div><p>删除用户：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ansible <span class="token builtin class-name">test</span> -m user -a <span class="token string">&quot;name=user01 state=absent&quot;</span>
</code></pre></div><p>点击此处查看更多相关操作： <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html#user-module" target="_blank" rel="noopener noreferrer">ansible.builtin.user<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="例子-管理服务"><a href="#例子-管理服务" class="header-anchor">#</a> 例子：管理服务</h3> <p><code>ansible.builtin.service</code>模块可以管理节点的服务。</p> <p>确保所有节点的服务都启动了：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible webservers -m <span class="token function">service</span> -a <span class="token string">&quot;name=httpd state=started&quot;</span>
</code></pre></div><p>重启服务：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible webservers -m ansible.builtin.service -a <span class="token string">&quot;name=httpd state=restarted&quot;</span>
</code></pre></div><h3 id="例子-收集facts"><a href="#例子-收集facts" class="header-anchor">#</a> 例子：收集Facts</h3> <p><code>Facts</code>代表着在一个机器的系统中发现的变量，是Ansible用于采集被管理机器设备信息的一个功能，采集的机器设备信息主要包含IP地址，操作系统，以太网设备，mac 地址，时间/日期相关数据，硬件信息等。</p> <p>可以使用<code>Facts</code>来实现任务的有条件执行。</p> <p>使用<code>setup</code>模块查看所有<code>Facts</code>：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ ansible all -m setup
</code></pre></div><p>点击此处查看<code>setup</code>更多内容： <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html#setup-module" target="_blank" rel="noopener noreferrer">ansible.builtin.setup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>使用<code>filter</code>参数来查看指定的信息：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>nsible all -m setup -a <span class="token string">&quot;filter=ansible_all_ipv4_addresses&quot;</span>
</code></pre></div><p><img src="/assets/img/image-20210102031733477.3b1e8e3f.png" alt="image-20210102031733477"></p> <h2 id="使用playbook"><a href="#使用playbook" class="header-anchor">#</a> 使用playbook</h2> <p>Playbooks记录并执行Ansible的配置、部署和编排功能。它可以描述您希望远程系统强制执行的策略，也可以描述一般IT流程中的一组步骤。如果Ansible模块是您的车间中的工具，那么剧本就是您的说明手册，主机的清单就是您的原材料。</p> <h3 id="templating-jinja2"><a href="#templating-jinja2" class="header-anchor">#</a> Templating (Jinja2)</h3> <p><code>Ansible</code>使用<code>Jinja2</code>模板来启动动态表达式和对变量的访问。</p> <p><code>Ansible</code>包括许多专门的过滤器和模板测试，也可以使用<code>Jinja2</code>中包含的所有标准过滤器和测试。</p> <p><code>Ansible</code>还提供了一种新的插件类型： <a href="https://docs.ansible.com/ansible/latest/plugins/lookup.html#lookup-plugins" target="_blank" rel="noopener noreferrer">Lookup插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>在任务被发送到目标机器上或者执行之前，<strong>所有模板都发生在Ansible控制器上</strong>。这种方法使目标上的包需求最小化（<code>jinja2</code>只在控制器上需要），也限制了<code>Ansible</code>传递到目标机器的数据量。</p> <p><code>Ansible</code>在控制器上解析模板，然后只会传送必要的信息到目标机器上去执行任务，而不是传递所有在控制器上的数据。</p> <h4 id="获取当前时间"><a href="#获取当前时间" class="header-anchor">#</a> 获取当前时间</h4> <p><code>Jinja2</code>使用now()函数获取当前时间。</p> <p>now()函数有2个参数：</p> <ul><li><code>utc</code>：表示使用UTC的当前时间，默认为Fase。True/False。</li> <li><code>fmt</code>：接受返回格式化日期时间字符串的strftime字符串。、</li></ul> <h4 id="使用过滤器处理数据"><a href="#使用过滤器处理数据" class="header-anchor">#</a> 使用过滤器处理数据</h4> <p>过滤器的功能：</p> <ul><li>将Json数据转为Yaml数据</li> <li>拆分URL获取主机名</li> <li>获取字符串的SHA1散列值</li> <li>进行整数的加法和乘法</li> <li>......等等</li></ul> <p>可以使用Ansible的过滤器来处理数据，也可以使用Jinja2附带的过滤器来处理数据。</p> <h5 id="处理未定义的变量"><a href="#处理未定义的变量" class="header-anchor">#</a> 处理未定义的变量</h5> <p>过滤器可以为未定义的变量提供默认值或者使变量变成可选的。</p> <p>如果Ansible配置了忽略大多数的未定义的变量，可以使用mandatory强制过滤器来标记这些变量。</p> <p><strong>使用default提供默认值：</strong></p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token function">default</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>提供了默认值后，Ansible就不会抛出 “undefined variable” 错误了。	如果使用role，可以添加defaults/main.yml文件来为role定义变量的默认值。</p> <p>当变量可能为false或者空字符串时，需要将第二个参数设为true：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token function">lookup</span><span class="token punctuation">(</span><span class="token string">'env'</span><span class="token punctuation">,</span> <span class="token string">'MY_USER'</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">default</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p><strong>将变量值变为可选的：</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code>- name: Touch files with an optional mode
  ansible.builtin.file:
    dest: <span class="token string">&quot;{{ item.path }}&quot;</span>
    state: <span class="token function">touch</span>
    mode: <span class="token string">&quot;{{ item.mode | default(omit) }}&quot;</span>
  loop:
    - path: /tmp/foo
    - path: /tmp/bar
    - path: /tmp/baz
      mode: <span class="token string">&quot;0444&quot;</span>
</code></pre></div><p><code>loop</code>关键字是用来创建循环的，循环<code>touch</code>创建三个文件，<code>/tmp/foo</code>和<code>/tmp/bar</code>文件的<code>mode</code>都是使用系统的默认值，只有<code>/tmp/baz</code>文件使用 <code>0444 mode</code>。</p> <p>为了让<code>mode</code>变量的值变成可选的，将<code>mode</code>的默认值设置成了特殊变量<code>omit</code>。</p> <p><strong>定义将强制值：</strong></p> <p>可以配置Ansible中 <a href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-undefined-var-behavior" target="_blank" rel="noopener noreferrer">DEFAULT_UNDEFINED_VAR_BEHAVIOR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的值为 <code>false</code>来允许未定义的变量的存在。</p> <p>如果配置了允许变量未定义，那么也可以通过<code>mandatory</code>过滤器来强制某些变量一定不能未定义：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">variable</span> <span class="token operator">|</span> <span class="token variable">mandatory</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><h5 id="定义不同的值-ternary三元"><a href="#定义不同的值-ternary三元" class="header-anchor">#</a> 定义不同的值（ternary三元）</h5> <p>为true、false不同的返回值定义不同的值：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token punctuation">(</span><span class="token variable">status</span> <span class="token operator">==</span> <span class="token string">'needs_restart'</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ternary</span><span class="token punctuation">(</span><span class="token string">'restart'</span><span class="token punctuation">,</span> <span class="token string">'continue'</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>为true、false、null不同的返回值定义不同的值：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">enabled</span> <span class="token operator">|</span> <span class="token function">ternary</span><span class="token punctuation">(</span><span class="token string">'no shutdown'</span><span class="token punctuation">,</span> <span class="token string">'shutdown'</span><span class="token punctuation">,</span> <span class="token variable">omit</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><h5 id="管理数据类型"><a href="#管理数据类型" class="header-anchor">#</a> 管理数据类型</h5> <p>可以使用type_debug、dict2items和item2dict过滤器来管理数据类型。</p> <p>1、<strong>显示数据类型（有助于调试）：</strong></p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">myvar</span> <span class="token operator">|</span> <span class="token variable">type_debug</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>2、<strong>字典转为列表：</strong></p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">dict</span> <span class="token operator">|</span> <span class="token variable">dict2items</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>字典转为列表之前：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token key atrule">Application</span><span class="token punctuation">:</span> payment
  <span class="token key atrule">Environment</span><span class="token punctuation">:</span> dev
</code></pre></div><p>转为列表之后：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> Application
  <span class="token key atrule">value</span><span class="token punctuation">:</span> payment
<span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> Environment 
  <span class="token key atrule">value</span><span class="token punctuation">:</span> dev
</code></pre></div><p>也可以传递key_name和value_name来指定key和value的名称：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">files</span> <span class="token operator">|</span> <span class="token function">dict2items</span><span class="token punctuation">(</span><span class="token variable">key_name</span><span class="token operator">=</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token variable">value_name</span><span class="token operator">=</span><span class="token string">'path'</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>字典转为列表之前：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">files</span><span class="token punctuation">:</span>
  <span class="token key atrule">users</span><span class="token punctuation">:</span> /etc/passwd
  <span class="token key atrule">groups</span><span class="token punctuation">:</span> /etc/group
</code></pre></div><p>转为列表之后：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">file</span><span class="token punctuation">:</span> users
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /etc/passwd
<span class="token punctuation">-</span> <span class="token key atrule">file</span><span class="token punctuation">:</span> groups
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /etc/group
</code></pre></div><p><strong>3、列表转为字典：</strong></p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">tags</span> <span class="token operator">|</span> <span class="token variable">item2dict</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>列表转为字典之前：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> Application
    <span class="token key atrule">value</span><span class="token punctuation">:</span> payment
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> Environment
    <span class="token key atrule">value</span><span class="token punctuation">:</span> dev
</code></pre></div><p>转为字典之后：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">Application</span><span class="token punctuation">:</span> payment
<span class="token key atrule">Environment</span><span class="token punctuation">:</span> dev
</code></pre></div><p>注意，并不是所有的列表都是使用<code>key</code>来指定<code>keys</code>，或者使用<code>value</code>来指定<code>values</code>，如：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">fruits</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">fruit</span><span class="token punctuation">:</span> apple
    <span class="token key atrule">color</span><span class="token punctuation">:</span> red
  <span class="token punctuation">-</span> <span class="token key atrule">fruit</span><span class="token punctuation">:</span> pear
    <span class="token key atrule">color</span><span class="token punctuation">:</span> yellow
  <span class="token punctuation">-</span> <span class="token key atrule">fruit</span><span class="token punctuation">:</span> grapefruit
    <span class="token key atrule">color</span><span class="token punctuation">:</span> yellow
</code></pre></div><p><strong>4、强制转为指定数据类型：</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">debug</span><span class="token punctuation">:</span>
  <span class="token key atrule">msg</span><span class="token punctuation">:</span> test
  <span class="token key atrule">when</span><span class="token punctuation">:</span> some_string_value <span class="token punctuation">|</span> bool
</code></pre></div><h5 id="格式化yaml和json数据"><a href="#格式化yaml和json数据" class="header-anchor">#</a> 格式化yaml和json数据</h5> <p>可以通过过滤器将<code>Jinja2</code>模板中的数据结构转为<code>YAML</code>或者<code>JSON</code>格式：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token variable">to_json</span> <span class="token delimiter punctuation">}}</span></span>
<span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token variable">to_yaml</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>可读性更强的：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token variable">to_nice_json</span> <span class="token delimiter punctuation">}}</span></span>
<span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token variable">to_nice_yaml</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>指定缩进：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token function">to_nice_json</span><span class="token punctuation">(</span><span class="token variable">indent</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
<span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token function">to_nice_yaml</span><span class="token punctuation">(</span><span class="token variable">indent</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p><code>to_yaml</code>和 <code>to_nice_yaml</code> 过滤器使用了 <a href="https://pyyaml.org/" target="_blank" rel="noopener noreferrer">PyYAML library<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，这个库支持的字符串长度只有80，如果超过80，会出现一些问题。为了避免这个问题，可以使用<code>width</code>选项来定义宽度：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token function">to_yaml</span><span class="token punctuation">(</span><span class="token variable">indent</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token variable">width</span><span class="token operator">=</span><span class="token number">1337</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
<span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token function">to_nice_yaml</span><span class="token punctuation">(</span><span class="token variable">indent</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token variable">width</span><span class="token operator">=</span><span class="token number">1337</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>如果读取的是已经格式化过的数据，可以使用以下过滤器来读取：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token variable">from_json</span> <span class="token delimiter punctuation">}}</span></span>
<span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token variable">some_variable</span> <span class="token operator">|</span> <span class="token variable">from_yaml</span> <span class="token delimiter punctuation">}}</span></span>
</code></pre></div><p>举个例子：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Register JSON output as a variable
    <span class="token key atrule">ansible.builtin.shell</span><span class="token punctuation">:</span> cat /some/path/to/file.json
    <span class="token key atrule">register</span><span class="token punctuation">:</span> result

  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set a variable
    <span class="token key atrule">ansible.builtin.set_fact</span><span class="token punctuation">:</span>
      <span class="token key atrule">myvar</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ result.stdout | from_json }}&quot;</span>
</code></pre></div><p>注意，默认情况下，<code>to_json</code>和<code>to_nice_json</code>会将接收到的数据转为<code>ascii</code>格式，如：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token string">'München'</span><span class="token operator">|</span> <span class="token variable">to_json</span> <span class="token delimiter punctuation">}}</span></span> 

'M\u00fcnchen'
</code></pre></div><p>为了保留<code>Unicode</code>字符，可以传递<code>ensure_ascii=False</code>参数给过滤器：</p> <div class="language-jinja2 extra-class"><pre class="language-jinja2"><code><span class="token jinja2 language-jinja2"><span class="token delimiter punctuation">{{</span> <span class="token string">'München'</span><span class="token operator">|</span> <span class="token function">to_json</span><span class="token punctuation">(</span><span class="token variable">ensure_ascii</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">}}</span></span>

'München'
</code></pre></div><h5 id="合并和选择数据"><a href="#合并和选择数据" class="header-anchor">#</a> 合并和选择数据</h5> <p>使用zip过滤器合并两个列表：</p> <p>You can  combine data from multiple sources and types, and select values from  large data structures, giving you precise control over complex data.</p> <h4 id="combining-items-from-multiple-lists-zip-and-zip-longest"><a href="#combining-items-from-multiple-lists-zip-and-zip-longest" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id15" target="_blank" rel="noopener noreferrer">Combining items from multiple lists: zip and zip_longest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.3.</p> <p>To get a list combining the elements of other lists use <code>zip</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Give me list combo of two lists
  ansible.builtin.debug:
   msg: &quot;{{ [1,2,3,4,5] | zip(['a','b','c','d','e','f']) | list }}&quot;

- name: Give me shortest combo of two lists
  ansible.builtin.debug:
    msg: &quot;{{ [1,2,3] | zip(['a','b','c','d','e','f']) | list }}&quot;
</code></pre></div><p>To always exhaust all lists use <code>zip_longest</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Give me longest combo of three lists , fill with X
  ansible.builtin.debug:
    msg: &quot;{{ [1,2,3] | zip_longest(['a','b','c','d','e','f'], [21, 22, 23], fillvalue='X') | list }}&quot;
</code></pre></div><p>Similarly to the output of the <code>items2dict</code> filter mentioned above, these filters can be used to construct a <code>dict</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ dict(keys_list | zip(values_list)) }}
</code></pre></div><p>List data (before applying the <code>zip</code> filter):</p> <div class="language- extra-class"><pre class="language-text"><code>keys_list:
  - one
  - two
values_list:
  - apple
  - orange
</code></pre></div><p>Dictonary data (after applying the <code>zip</code> filter):</p> <div class="language- extra-class"><pre class="language-text"><code>one: apple
two: orange
</code></pre></div><h4 id="combining-objects-and-subelements"><a href="#combining-objects-and-subelements" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id16" target="_blank" rel="noopener noreferrer">Combining objects and subelements<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.7.</p> <p>The <code>subelements</code> filter produces a product of an object and the subelement values of that object, similar to the <code>subelements</code> lookup. This lets you specify individual subelements to use in a template. For example, this expression:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ users | subelements('groups', skip_missing=True) }}
</code></pre></div><p>Data before applying the <code>subelements</code> filter:</p> <div class="language- extra-class"><pre class="language-text"><code>users:
- name: alice
  authorized:
  - /tmp/alice/onekey.pub
  - /tmp/alice/twokey.pub
  groups:
  - wheel
  - docker
- name: bob
  authorized:
  - /tmp/bob/id_rsa.pub
  groups:
  - docker
</code></pre></div><p>Data after applying the <code>subelements</code> filter:</p> <div class="language- extra-class"><pre class="language-text"><code>-
  - name: alice
    groups:
    - wheel
    - docker
    authorized:
    - /tmp/alice/onekey.pub
    - /tmp/alice/twokey.pub
  - wheel
-
  - name: alice
    groups:
    - wheel
    - docker
    authorized:
    - /tmp/alice/onekey.pub
    - /tmp/alice/twokey.pub
  - docker
-
  - name: bob
    authorized:
    - /tmp/bob/id_rsa.pub
    groups:
    - docker
  - docker
</code></pre></div><p>You can use the transformed data with <code>loop</code> to iterate over the same subelement for multiple objects:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Set authorized ssh key, extracting just that data from 'users'
  ansible.posix.authorized_key:
    user: &quot;{{ item.0.name }}&quot;
    key: &quot;{{ lookup('file', item.1) }}&quot;
  loop: &quot;{{ users | subelements('authorized') }}&quot;
</code></pre></div><h4 id="combining-hashes-dictionaries"><a href="#combining-hashes-dictionaries" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id17" target="_blank" rel="noopener noreferrer">Combining hashes/dictionaries<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.0.</p> <p>The <code>combine</code> filter allows hashes to be merged. For example, the following would override keys in one hash:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ {'a':1, 'b':2} | combine({'b':3}) }}
</code></pre></div><p>The resulting hash would be:</p> <div class="language- extra-class"><pre class="language-text"><code>{'a':1, 'b':3}
</code></pre></div><p>The filter can also take multiple arguments to merge:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ a | combine(b, c, d) }}
{{ [a, b, c, d] | combine }}
</code></pre></div><p>In this case, keys in <code>d</code> would override those in <code>c</code>, which would override those in <code>b</code>, and so on.</p> <p>The filter also accepts two optional parameters: <code>recursive</code> and <code>list_merge</code>.</p> <ul><li><p>recursive</p> <p>Is a boolean, default to <code>False</code>. Should the <code>combine</code> recursively merge nested hashes. Note: It does <strong>not</strong> depend on the value of the <code>hash_behaviour</code> setting in <code>ansible.cfg</code>.</p></li> <li><p>list_merge</p> <p>Is a string, its possible values are <code>replace</code> (default), <code>keep</code>, <code>append</code>, <code>prepend</code>, <code>append_rp</code> or <code>prepend_rp</code>. It modifies the behaviour of <code>combine</code> when the hashes to merge contain arrays/lists.</p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>default:
  a:
    x: default
    y: default
  b: default
  c: default
patch:
  a:
    y: patch
    z: patch
  b: patch
</code></pre></div><p>If <code>recursive=False</code> (the default), nested hash aren’t merged:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ default | combine(patch) }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  y: patch
  z: patch
b: patch
c: default
</code></pre></div><p>If <code>recursive=True</code>, recurse into nested hash and merge their keys:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ default | combine(patch, recursive=True) }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  x: default
  y: patch
  z: patch
b: patch
c: default
</code></pre></div><p>If <code>list_merge='replace'</code> (the default), arrays from the right hash will “replace” the ones in the left hash:</p> <div class="language- extra-class"><pre class="language-text"><code>default:
  a:
    - default
patch:
  a:
    - patch
{{ default | combine(patch) }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  - patch
</code></pre></div><p>If <code>list_merge='keep'</code>, arrays from the left hash will be kept:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ default | combine(patch, list_merge='keep') }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  - default
</code></pre></div><p>If <code>list_merge='append'</code>, arrays from the right hash will be appended to the ones in the left hash:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ default | combine(patch, list_merge='append') }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  - default
  - patch
</code></pre></div><p>If <code>list_merge='prepend'</code>, arrays from the right hash will be prepended to the ones in the left hash:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ default | combine(patch, list_merge='prepend') }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  - patch
  - default
</code></pre></div><p>If <code>list_merge='append_rp'</code>, arrays from the right hash will be appended to the ones in the left  hash. Elements of arrays in the left hash that are also in the  corresponding array of the right hash will be removed (“rp” stands for  “remove present”). Duplicate elements that aren’t in both hashes are  kept:</p> <div class="language- extra-class"><pre class="language-text"><code>default:
  a:
    - 1
    - 1
    - 2
    - 3
patch:
  a:
    - 3
    - 4
    - 5
    - 5
{{ default | combine(patch, list_merge='append_rp') }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  - 1
  - 1
  - 2
  - 3
  - 4
  - 5
  - 5
</code></pre></div><p>If <code>list_merge='prepend_rp'</code>, the behavior is similar to the one for <code>append_rp</code>, but elements of arrays in the right hash are prepended:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ default | combine(patch, list_merge='prepend_rp') }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  - 3
  - 4
  - 5
  - 5
  - 1
  - 1
  - 2
</code></pre></div><p><code>recursive</code> and <code>list_merge</code> can be used together:</p> <div class="language- extra-class"><pre class="language-text"><code>default:
  a:
    a':
      x: default_value
      y: default_value
      list:
        - default_value
  b:
    - 1
    - 1
    - 2
    - 3
patch:
  a:
    a':
      y: patch_value
      z: patch_value
      list:
        - patch_value
  b:
    - 3
    - 4
    - 4
    - key: value
{{ default | combine(patch, recursive=True, list_merge='append_rp') }}
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>a:
  a':
    x: default_value
    y: patch_value
    z: patch_value
    list:
      - default_value
      - patch_value
b:
  - 1
  - 1
  - 2
  - 3
  - 4
  - 4
  - key: value
</code></pre></div><h4 id="selecting-values-from-arrays-or-hashtables"><a href="#selecting-values-from-arrays-or-hashtables" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id18" target="_blank" rel="noopener noreferrer">Selecting values from arrays or hashtables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.1.</p> <p>The extract filter is used to map from a list of indices to a list of values from a container (hash or array):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ [0,2] | map('extract', ['x','y','z']) | list }}
{{ ['x','y'] | map('extract', {'x': 42, 'y': 31}) | list }}
</code></pre></div><p>The results of the above expressions would be:</p> <div class="language- extra-class"><pre class="language-text"><code>['x', 'z']
[42, 31]
</code></pre></div><p>The filter can take another argument:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ groups['x'] | map('extract', hostvars, 'ec2_ip_address') | list }}
</code></pre></div><p>This takes the list of hosts in group ‘x’, looks them up in hostvars, and then looks up the ec2_ip_address of the result. The final result is a list of IP addresses for the hosts in group ‘x’.</p> <p>The third argument to the filter can also be a list, for a recursive lookup inside the container:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ ['a'] | map('extract', b, ['x','y']) | list }}
</code></pre></div><p>This would return a list containing the value of b[‘a’][‘x’][‘y’].</p> <h4 id="combining-lists"><a href="#combining-lists" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id19" target="_blank" rel="noopener noreferrer">Combining lists<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>This set of filters returns a list of combined lists.</p> <h5 id="permutations"><a href="#permutations" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id20" target="_blank" rel="noopener noreferrer">permutations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p>To get permutations of a list:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Give me largest permutations (order matters)
  ansible.builtin.debug:
    msg: &quot;{{ [1,2,3,4,5] | permutations | list }}&quot;

- name: Give me permutations of sets of three
  ansible.builtin.debug:
    msg: &quot;{{ [1,2,3,4,5] | permutations(3) | list }}&quot;
</code></pre></div><h5 id="combinations"><a href="#combinations" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id21" target="_blank" rel="noopener noreferrer">combinations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p>Combinations always require a set size:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Give me combinations for sets of two
  ansible.builtin.debug:
    msg: &quot;{{ [1,2,3,4,5] | combinations(2) | list }}&quot;
</code></pre></div><p>Also see the <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#zip-filter" target="_blank" rel="noopener noreferrer">Combining items from multiple lists: zip and zip_longest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h5 id="products"><a href="#products" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id22" target="_blank" rel="noopener noreferrer">products<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p>The product filter returns the <a href="https://docs.python.org/3/library/itertools.html#itertools.product" target="_blank" rel="noopener noreferrer">cartesian product<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of the input iterables. This is roughly equivalent to nested for-loops in a generator expression.</p> <p>For example:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Generate multiple hostnames
  ansible.builtin.debug:
    msg: &quot;{{ ['foo', 'bar'] | product(['com']) | map('join', '.') | join(',') }}&quot;
</code></pre></div><p>This would result in:</p> <div class="language- extra-class"><pre class="language-text"><code>{ &quot;msg&quot;: &quot;foo.com,bar.com&quot; }
</code></pre></div><h4 id="selecting-json-data-json-queries"><a href="#selecting-json-data-json-queries" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id23" target="_blank" rel="noopener noreferrer">Selecting JSON data: JSON queries<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>To select a single element or a data subset from a complex data structure in JSON format (for example, Ansible facts), use the <code>json_query</code> filter.  The <code>json_query</code> filter lets you query a complex JSON structure and iterate over it using a loop structure.</p> <p>Note</p> <p>This filter has migrated to the <a href="https://galaxy.ansible.com/community/general" target="_blank" rel="noopener noreferrer">community.general<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> collection. Follow the installation instructions to install that collection.</p> <p>Note</p> <p>This filter is built upon <strong>jmespath</strong>, and you can use the same syntax. For examples, see <a href="http://jmespath.org/examples.html" target="_blank" rel="noopener noreferrer">jmespath examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Consider this data structure:</p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;domain_definition&quot;: {
        &quot;domain&quot;: {
            &quot;cluster&quot;: [
                {
                    &quot;name&quot;: &quot;cluster1&quot;
                },
                {
                    &quot;name&quot;: &quot;cluster2&quot;
                }
            ],
            &quot;server&quot;: [
                {
                    &quot;name&quot;: &quot;server11&quot;,
                    &quot;cluster&quot;: &quot;cluster1&quot;,
                    &quot;port&quot;: &quot;8080&quot;
                },
                {
                    &quot;name&quot;: &quot;server12&quot;,
                    &quot;cluster&quot;: &quot;cluster1&quot;,
                    &quot;port&quot;: &quot;8090&quot;
                },
                {
                    &quot;name&quot;: &quot;server21&quot;,
                    &quot;cluster&quot;: &quot;cluster2&quot;,
                    &quot;port&quot;: &quot;9080&quot;
                },
                {
                    &quot;name&quot;: &quot;server22&quot;,
                    &quot;cluster&quot;: &quot;cluster2&quot;,
                    &quot;port&quot;: &quot;9090&quot;
                }
            ],
            &quot;library&quot;: [
                {
                    &quot;name&quot;: &quot;lib1&quot;,
                    &quot;target&quot;: &quot;cluster1&quot;
                },
                {
                    &quot;name&quot;: &quot;lib2&quot;,
                    &quot;target&quot;: &quot;cluster2&quot;
                }
            ]
        }
    }
}
</code></pre></div><p>To extract all clusters from this structure, you can use the following query:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Display all cluster names
  ansible.builtin.debug:
    var: item
  loop: &quot;{{ domain_definition | community.general.json_query('domain.cluster[*].name') }}&quot;
</code></pre></div><p>To extract all server names:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Display all server names
  ansible.builtin.debug:
    var: item
  loop: &quot;{{ domain_definition | community.general.json_query('domain.server[*].name') }}&quot;
</code></pre></div><p>To extract ports from cluster1:</p> <div class="language- extra-class"><pre class="language-text"><code>- ansible.builtin.name: Display all ports from cluster1
  debug:
    var: item
  loop: &quot;{{ domain_definition | community.general.json_query(server_name_cluster1_query) }}&quot;
  vars:
    server_name_cluster1_query: &quot;domain.server[?cluster=='cluster1'].port&quot;
</code></pre></div><p>Note</p> <p>You can use a variable to make the query more readable.</p> <p>To print out the ports from cluster1 in a comma separated string:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Display all ports from cluster1 as a string
  ansible.builtin.debug:
    msg: &quot;{{ domain_definition | community.general.json_query('domain.server[?cluster==`cluster1`].port') | join(', ') }}&quot;
</code></pre></div><p>Note</p> <p>In the example above, quoting literals using backticks avoids escaping quotes and maintains readability.</p> <p>You can use YAML <a href="https://yaml.org/spec/current.html#id2534365" target="_blank" rel="noopener noreferrer">single quote escaping<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Display all ports from cluster1
  ansible.builtin.debug:
    var: item
  loop: &quot;{{ domain_definition | community.general.json_query('domain.server[?cluster==''cluster1''].port') }}&quot;
</code></pre></div><p>Note</p> <p>Escaping single quotes within single quotes in YAML is done by doubling the single quote.</p> <p>To get a hash map with all ports and names of a cluster:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Display all server ports and names from cluster1
  ansible.builtin.debug:
    var: item
  loop: &quot;{{ domain_definition | community.general.json_query(server_name_cluster1_query) }}&quot;
  vars:
    server_name_cluster1_query: &quot;domain.server[?cluster=='cluster2'].{name: name, port: port}&quot;
</code></pre></div><h3 id="randomizing-data"><a href="#randomizing-data" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id24" target="_blank" rel="noopener noreferrer">Randomizing data<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>When you need a randomly generated value, use one of these filters.</p> <h4 id="random-mac-addresses"><a href="#random-mac-addresses" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id25" target="_blank" rel="noopener noreferrer">Random MAC addresses<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.6.</p> <p>This filter can be used to generate a random MAC address from a string prefix.</p> <p>Note</p> <p>This filter has migrated to the <a href="https://galaxy.ansible.com/community/general" target="_blank" rel="noopener noreferrer">community.general<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> collection. Follow the installation instructions to install that collection.</p> <p>To get a random MAC address from a string prefix starting with ‘52:54:00’:</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;{{ '52:54:00' | community.general.random_mac }}&quot;
## =&gt; '52:54:00:ef:1c:03'
</code></pre></div><p>Note that if anything is wrong with the prefix string, the filter will issue an error.</p> <blockquote><p>New in version 2.9.</p></blockquote> <p>As of Ansible version 2.9, you can also initialize the random number  generator from a seed to create random-but-idempotent MAC addresses:</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;{{ '52:54:00' | community.general.random_mac(seed=inventory_hostname) }}&quot;
</code></pre></div><h4 id="random-items-or-numbers"><a href="#random-items-or-numbers" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id26" target="_blank" rel="noopener noreferrer">Random items or numbers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>The <code>random</code> filter in Ansible is an extension of the default Jinja2 random filter,  and can be used to return a random item from a sequence of items or to  generate a random number based on a range.</p> <p>To get a random item from a list:</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;{{ ['a','b','c'] | random }}&quot;
## =&gt; 'c'
</code></pre></div><p>To get a random number between 0 and a specified number:</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;{{ 60 | random }} * * * * root /script/from/cron&quot;
## =&gt; '21 * * * * root /script/from/cron'
</code></pre></div><p>To get a random number from 0 to 100 but in steps of 10:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 101 | random(step=10) }}
## =&gt; 70
</code></pre></div><p>To get a random number from 1 to 100 but in steps of 10:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 101 | random(1, 10) }}
## =&gt; 31
{{ 101 | random(start=1, step=10) }}
## =&gt; 51
</code></pre></div><p>You can initialize the random number generator from a seed to create random-but-idempotent numbers:</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;{{ 60 | random(seed=inventory_hostname) }} * * * * root /script/from/cron&quot;
</code></pre></div><h4 id="shuffling-a-list"><a href="#shuffling-a-list" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id27" target="_blank" rel="noopener noreferrer">Shuffling a list<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>The <code>shuffle</code> filter randomizes an existing list, giving a different order every invocation.</p> <p>To get a random list from an existing  list:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ ['a','b','c'] | shuffle }}
## =&gt; ['c','a','b']
{{ ['a','b','c'] | shuffle }}
## =&gt; ['b','c','a']
</code></pre></div><p>You can initialize the shuffle generator from a seed to generate a random-but-idempotent order:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ ['a','b','c'] | shuffle(seed=inventory_hostname) }}
## =&gt; ['b','a','c']
</code></pre></div><p>The shuffle filter returns a list whenever possible. If you use it with a non ‘listable’ item, the filter does nothing.</p> <h3 id="managing-list-variables"><a href="#managing-list-variables" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id28" target="_blank" rel="noopener noreferrer">Managing list variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>You can search for the minimum or maximum value in a list, or flatten a multi-level list.</p> <p>To get the minimum value from list of numbers:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ list1 | min }}
</code></pre></div><p>To get the maximum value from a list of numbers:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ [3, 4, 2] | max }}
</code></pre></div><p>New in version 2.5.</p> <p>Flatten a list (same thing the flatten lookup does):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ [3, [4, 2] ] | flatten }}
</code></pre></div><p>Flatten only the first level of a list (akin to the items lookup):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ [3, [4, [2]] ] | flatten(levels=1) }}
</code></pre></div><h3 id="selecting-from-sets-or-lists-set-theory"><a href="#selecting-from-sets-or-lists-set-theory" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id29" target="_blank" rel="noopener noreferrer">Selecting from sets or lists (set theory)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>You can select or combine items from sets or lists.</p> <p>New in version 1.4.</p> <p>To get a unique set from a list:</p> <div class="language- extra-class"><pre class="language-text"><code>## list1: [1, 2, 5, 1, 3, 4, 10]
{{ list1 | unique }}
## =&gt; [1, 2, 5, 3, 4, 10]
</code></pre></div><p>To get a union of two lists:</p> <div class="language- extra-class"><pre class="language-text"><code>## list1: [1, 2, 5, 1, 3, 4, 10]
## list2: [1, 2, 3, 4, 5, 11, 99]
{{ list1 | union(list2) }}
## =&gt; [1, 2, 5, 1, 3, 4, 10, 11, 99]
</code></pre></div><p>To get the intersection of 2 lists (unique list of all items in both):</p> <div class="language- extra-class"><pre class="language-text"><code>## list1: [1, 2, 5, 3, 4, 10]
## list2: [1, 2, 3, 4, 5, 11, 99]
{{ list1 | intersect(list2) }}
## =&gt; [1, 2, 5, 3, 4]
</code></pre></div><p>To get the difference of 2 lists (items in 1 that don’t exist in 2):</p> <div class="language- extra-class"><pre class="language-text"><code>## list1: [1, 2, 5, 1, 3, 4, 10]
## list2: [1, 2, 3, 4, 5, 11, 99]
{{ list1 | difference(list2) }}
## =&gt; [10]
</code></pre></div><p>To get the symmetric difference of 2 lists (items exclusive to each list):</p> <div class="language- extra-class"><pre class="language-text"><code>## list1: [1, 2, 5, 1, 3, 4, 10]
## list2: [1, 2, 3, 4, 5, 11, 99]
{{ list1 | symmetric_difference(list2) }}
## =&gt; [10, 11, 99]
</code></pre></div><h3 id="calculating-numbers-math"><a href="#calculating-numbers-math" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id30" target="_blank" rel="noopener noreferrer">Calculating numbers (math)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>New in version 1.9.</p> <p>You can calculate logs, powers, and roots of numbers with Ansible  filters. Jinja2 provides other mathematical functions like abs() and  round().</p> <p>Get the logarithm (default is e):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ myvar | log }}
</code></pre></div><p>Get the base 10 logarithm:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ myvar | log(10) }}
</code></pre></div><p>Give me the power of 2! (or 5):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ myvar | pow(2) }}
{{ myvar | pow(5) }}
</code></pre></div><p>Square root, or the 5th:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ myvar | root }}
{{ myvar | root(5) }}
</code></pre></div><h3 id="managing-network-interactions"><a href="#managing-network-interactions" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id31" target="_blank" rel="noopener noreferrer">Managing network interactions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>These filters help you with common network tasks.</p> <p>Note</p> <p>These filters have migrated to the <a href="https://galaxy.ansible.com/ansible/netcommon" target="_blank" rel="noopener noreferrer">ansible.netcommon<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> collection. Follow the installation instructions to install that collection.</p> <h4 id="ip-address-filters"><a href="#ip-address-filters" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id32" target="_blank" rel="noopener noreferrer">IP address filters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 1.9.</p> <p>To test if a string is a valid IP address:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ myvar | ansible.netcommon.ipaddr }}
</code></pre></div><p>You can also require a specific IP protocol version:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ myvar | ansible.netcommon.ipv4 }}
{{ myvar | ansible.netcommon.ipv6 }}
</code></pre></div><p>IP address filter can also be used to extract specific information from an IP address. For example, to get the IP address itself from a CIDR, you can use:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ '192.0.2.1/24' | ansible.netcommon.ipaddr('address') }}
</code></pre></div><p>More information about <code>ipaddr</code> filter and complete usage guide can be found in <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters_ipaddr.html#playbooks-filters-ipaddr" target="_blank" rel="noopener noreferrer">ipaddr filter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h4 id="network-cli-filters"><a href="#network-cli-filters" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id33" target="_blank" rel="noopener noreferrer">Network CLI filters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.4.</p> <p>To convert the output of a network device CLI command into structured JSON output, use the <code>parse_cli</code> filter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ output | ansible.netcommon.parse_cli('path/to/spec') }}
</code></pre></div><p>The <code>parse_cli</code> filter will load the spec file and pass the command output through it, returning JSON output. The YAML spec file defines how to parse the CLI output.</p> <p>The spec file should be valid formatted YAML.  It defines how to parse the CLI output and return JSON data.  Below is an example of a valid spec file that will parse the output from the <code>show vlan</code> command.</p> <div class="language- extra-class"><pre class="language-text"><code>---
vars:
  vlan:
    vlan_id: &quot;{{ item.vlan_id }}&quot;
    name: &quot;{{ item.name }}&quot;
    enabled: &quot;{{ item.state != 'act/lshut' }}&quot;
    state: &quot;{{ item.state }}&quot;

keys:
  vlans:
    value: &quot;{{ vlan }}&quot;
    items: &quot;^(?P&lt;vlan_id&gt;\\d+)\\s+(?P&lt;name&gt;\\w+)\\s+(?P&lt;state&gt;active|act/lshut|suspended)&quot;
  state_static:
    value: present
</code></pre></div><p>The spec file above will return a JSON data structure that is a list of hashes with the parsed VLAN information.</p> <p>The same command could be parsed into a hash by using the key and values directives.  Here is an example of how to parse the output into a hash value using the same <code>show vlan</code> command.</p> <div class="language- extra-class"><pre class="language-text"><code>---
vars:
  vlan:
    key: &quot;{{ item.vlan_id }}&quot;
    values:
      vlan_id: &quot;{{ item.vlan_id }}&quot;
      name: &quot;{{ item.name }}&quot;
      enabled: &quot;{{ item.state != 'act/lshut' }}&quot;
      state: &quot;{{ item.state }}&quot;

keys:
  vlans:
    value: &quot;{{ vlan }}&quot;
    items: &quot;^(?P&lt;vlan_id&gt;\\d+)\\s+(?P&lt;name&gt;\\w+)\\s+(?P&lt;state&gt;active|act/lshut|suspended)&quot;
  state_static:
    value: present
</code></pre></div><p>Another common use case for parsing CLI commands is to break a large command into blocks that can be parsed.  This can be done using the <code>start_block</code> and <code>end_block</code> directives to break the command into blocks that can be parsed.</p> <div class="language- extra-class"><pre class="language-text"><code>---
vars:
  interface:
    name: &quot;{{ item[0].match[0] }}&quot;
    state: &quot;{{ item[1].state }}&quot;
    mode: &quot;{{ item[2].match[0] }}&quot;

keys:
  interfaces:
    value: &quot;{{ interface }}&quot;
    start_block: &quot;^Ethernet.*$&quot;
    end_block: &quot;^$&quot;
    items:
      - &quot;^(?P&lt;name&gt;Ethernet\\d\\/\\d*)&quot;
      - &quot;admin state is (?P&lt;state&gt;.+),&quot;
      - &quot;Port mode is (.+)&quot;
</code></pre></div><p>The example above will parse the output of <code>show interface</code> into a list of hashes.</p> <p>The network filters also support parsing the output of a CLI command using the TextFSM library.  To parse the CLI output with TextFSM use the following filter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ output.stdout[0] | ansible.netcommon.parse_cli_textfsm('path/to/fsm') }}
</code></pre></div><p>Use of the TextFSM filter requires the TextFSM library to be installed.</p> <h4 id="network-xml-filters"><a href="#network-xml-filters" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id34" target="_blank" rel="noopener noreferrer">Network XML filters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.5.</p> <p>To convert the XML output of a network device command into structured JSON output, use the <code>parse_xml</code> filter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ output | ansible.netcommon.parse_xml('path/to/spec') }}
</code></pre></div><p>The <code>parse_xml</code> filter will load the spec file and pass the command output through formatted as JSON.</p> <p>The spec file should be valid formatted YAML. It defines how to parse the XML output and return JSON data.</p> <p>Below is an example of a valid spec file that will parse the output from the <code>show vlan | display xml</code> command.</p> <div class="language- extra-class"><pre class="language-text"><code>---
vars:
  vlan:
    vlan_id: &quot;{{ item.vlan_id }}&quot;
    name: &quot;{{ item.name }}&quot;
    desc: &quot;{{ item.desc }}&quot;
    enabled: &quot;{{ item.state.get('inactive') != 'inactive' }}&quot;
    state: &quot;{% if item.state.get('inactive') == 'inactive'%} inactive {% else %} active {% endif %}&quot;

keys:
  vlans:
    value: &quot;{{ vlan }}&quot;
    top: configuration/vlans/vlan
    items:
      vlan_id: vlan-id
      name: name
      desc: description
      state: &quot;.[@inactive='inactive']&quot;
</code></pre></div><p>The spec file above will return a JSON data structure that is a list of hashes with the parsed VLAN information.</p> <p>The same command could be parsed into a hash by using the key and values directives.  Here is an example of how to parse the output into a hash value using the same <code>show vlan | display xml</code> command.</p> <div class="language- extra-class"><pre class="language-text"><code>---
vars:
  vlan:
    key: &quot;{{ item.vlan_id }}&quot;
    values:
        vlan_id: &quot;{{ item.vlan_id }}&quot;
        name: &quot;{{ item.name }}&quot;
        desc: &quot;{{ item.desc }}&quot;
        enabled: &quot;{{ item.state.get('inactive') != 'inactive' }}&quot;
        state: &quot;{% if item.state.get('inactive') == 'inactive'%} inactive {% else %} active {% endif %}&quot;

keys:
  vlans:
    value: &quot;{{ vlan }}&quot;
    top: configuration/vlans/vlan
    items:
      vlan_id: vlan-id
      name: name
      desc: description
      state: &quot;.[@inactive='inactive']&quot;
</code></pre></div><p>The value of <code>top</code> is the XPath relative to the XML root node. In the example XML output given below, the value of <code>top</code> is <code>configuration/vlans/vlan</code>, which is an XPath expression relative to the root node (&lt;rpc-reply&gt;). <code>configuration</code> in the value of <code>top</code> is the outer most container node, and <code>vlan</code> is the inner-most container node.</p> <div class="language- extra-class"><pre class="language-text"><code>items` is a dictionary of key-value pairs that map user-defined names to XPath expressions that select elements. The Xpath expression is relative to the value of the XPath value contained in `top`. For example, the `vlan_id` in the spec file is a user defined name and its value `vlan-id` is the relative to the value of XPath in `top
</code></pre></div><p>Attributes of XML tags can be extracted using XPath expressions. The value of <code>state</code> in the spec is an XPath expression used to get the attributes of the <code>vlan</code> tag in output XML.:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;rpc-reply&gt;
  &lt;configuration&gt;
    &lt;vlans&gt;
      &lt;vlan inactive=&quot;inactive&quot;&gt;
       &lt;name&gt;vlan-1&lt;/name&gt;
       &lt;vlan-id&gt;200&lt;/vlan-id&gt;
       &lt;description&gt;This is vlan-1&lt;/description&gt;
      &lt;/vlan&gt;
    &lt;/vlans&gt;
  &lt;/configuration&gt;
&lt;/rpc-reply&gt;
</code></pre></div><p>Note</p> <p>For more information on supported XPath expressions, see <a href="https://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support" target="_blank" rel="noopener noreferrer">XPath Support<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h4 id="network-vlan-filters"><a href="#network-vlan-filters" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id35" target="_blank" rel="noopener noreferrer">Network VLAN filters<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.8.</p> <p>Use the <code>vlan_parser</code> filter to transform an unsorted list of VLAN integers into a sorted string list of integers according to IOS-like VLAN list rules. This list has the following properties:</p> <ul><li>Vlans are listed in ascending order.</li> <li>Three or more consecutive VLANs are listed with a dash.</li> <li>The first line of the list can be first_line_len characters long.</li> <li>Subsequent list lines can be other_line_len characters.</li></ul> <p>To sort a VLAN list:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ [3003, 3004, 3005, 100, 1688, 3002, 3999] | ansible.netcommon.vlan_parser }}
</code></pre></div><p>This example renders the following sorted list:</p> <div class="language- extra-class"><pre class="language-text"><code>['100,1688,3002-3005,3999']
</code></pre></div><p>Another example Jinja template:</p> <div class="language- extra-class"><pre class="language-text"><code>{% set parsed_vlans = vlans | ansible.netcommon.vlan_parser %}
switchport trunk allowed vlan {{ parsed_vlans[0] }}
{% for i in range (1, parsed_vlans | count) %}
switchport trunk allowed vlan add {{ parsed_vlans[i] }}
</code></pre></div><p>This allows for dynamic generation of VLAN lists on a Cisco IOS  tagged interface. You can store an exhaustive raw list of the exact  VLANs required for an interface and then compare that to the parsed IOS  output that would actually be generated for the configuration.</p> <h3 id="encrypting-and-checksumming-strings-and-passwords"><a href="#encrypting-and-checksumming-strings-and-passwords" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id36" target="_blank" rel="noopener noreferrer">Encrypting and checksumming strings and passwords<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>New in version 1.9.</p> <p>To get the sha1 hash of a string:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'test1' | hash('sha1') }}
</code></pre></div><p>To get the md5 hash of a string:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'test1' | hash('md5') }}
</code></pre></div><p>Get a string checksum:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'test2' | checksum }}
</code></pre></div><p>Other hashes (platform dependent):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'test2' | hash('blowfish') }}
</code></pre></div><p>To get a sha512 password hash (random salt):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'passwordsaresecret' | password_hash('sha512') }}
</code></pre></div><p>To get a sha256 password hash with a specific salt:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'secretpassword' | password_hash('sha256', 'mysecretsalt') }}
</code></pre></div><p>An idempotent method to generate unique hashes per system is to use a salt that is consistent between runs:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'secretpassword' | password_hash('sha512', 65534 | random(seed=inventory_hostname) | string) }}
</code></pre></div><p>Hash types available depend on the master system running Ansible, ‘hash’ depends on hashlib, password_hash depends on passlib (https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html).</p> <p>New in version 2.7.</p> <p>Some hash types allow providing a rounds parameter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ 'secretpassword' | password_hash('sha256', 'mysecretsalt', rounds=10000) }}
</code></pre></div><h3 id="manipulating-text"><a href="#manipulating-text" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id37" target="_blank" rel="noopener noreferrer">Manipulating text<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>Several filters work with text, including URLs, file names, and path names.</p> <h4 id="adding-comments-to-files"><a href="#adding-comments-to-files" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id38" target="_blank" rel="noopener noreferrer">Adding comments to files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>The <code>comment</code> filter lets you create comments in a file from text in a template, with a variety of comment styles. By default Ansible uses <code>#</code> to start a comment line and adds a blank comment line above and below your comment text. For example the following:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ &quot;Plain style (default)&quot; | comment }}
</code></pre></div><p>produces this output:</p> <div class="language- extra-class"><pre class="language-text"><code>#
## Plain style (default)
#
</code></pre></div><p>Ansible offers styles for comments in C (<code>//...</code>), C block (<code>/*...*/</code>), Erlang (<code>%...</code>) and XML (``):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ &quot;C style&quot; | comment('c') }}
{{ &quot;C block style&quot; | comment('cblock') }}
{{ &quot;Erlang style&quot; | comment('erlang') }}
{{ &quot;XML style&quot; | comment('xml') }}
</code></pre></div><p>You can define a custom comment character. This filter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ &quot;My Special Case&quot; | comment(decoration=&quot;! &quot;) }}
</code></pre></div><p>produces:</p> <div class="language- extra-class"><pre class="language-text"><code>!
! My Special Case
!
</code></pre></div><p>You can fully customize the comment style:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ &quot;Custom style&quot; | comment('plain', prefix='#######\n#', postfix='#\n#######\n   ###\n    #') }}
</code></pre></div><p>That creates the following output:</p> <div class="language- extra-class"><pre class="language-text"><code>#######
#
## Custom style
#
#######
   ###
    #
</code></pre></div><p>The filter can also be applied to any Ansible variable. For example to make the output of the <code>ansible_managed</code> variable more readable, we can change the definition in the <code>ansible.cfg</code> file to this:</p> <div class="language- extra-class"><pre class="language-text"><code>[defaults]

ansible_managed = This file is managed by Ansible.%n
  template: {file}
  date: %Y-%m-%d %H:%M:%S
  user: {uid}
  host: {host}
</code></pre></div><p>and then use the variable with the comment filter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ ansible_managed | comment }}
</code></pre></div><p>which produces this output:</p> <div class="language- extra-class"><pre class="language-text"><code>#
## This file is managed by Ansible.
#
## template: /home/ansible/env/dev/ansible_managed/roles/role1/templates/test.j2
## date: 2015-09-10 11:02:58
## user: ansible
## host: myhost
#
</code></pre></div><h4 id="splitting-urls"><a href="#splitting-urls" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id39" target="_blank" rel="noopener noreferrer">Splitting URLs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>New in version 2.4.</p> <p>The <code>urlsplit</code> filter extracts the fragment, hostname, netloc, password, path, port,  query, scheme, and username from an URL. With no arguments, returns a  dictionary of all the fields:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('hostname') }}
## =&gt; 'www.acme.com'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('netloc') }}
## =&gt; 'user:password@www.acme.com:9000'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('username') }}
## =&gt; 'user'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('password') }}
## =&gt; 'password'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('path') }}
## =&gt; '/dir/index.html'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('port') }}
## =&gt; '9000'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('scheme') }}
## =&gt; 'http'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('query') }}
## =&gt; 'query=term'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit('fragment') }}
## =&gt; 'fragment'

{{ &quot;http://user:password@www.acme.com:9000/dir/index.html?query=term#fragment&quot; | urlsplit }}
## =&gt;
##   {
##       &quot;fragment&quot;: &quot;fragment&quot;,
##       &quot;hostname&quot;: &quot;www.acme.com&quot;,
##       &quot;netloc&quot;: &quot;user:password@www.acme.com:9000&quot;,
##       &quot;password&quot;: &quot;password&quot;,
##       &quot;path&quot;: &quot;/dir/index.html&quot;,
##       &quot;port&quot;: 9000,
##       &quot;query&quot;: &quot;query=term&quot;,
##       &quot;scheme&quot;: &quot;http&quot;,
##       &quot;username&quot;: &quot;user&quot;
##   }
</code></pre></div><h4 id="searching-strings-with-regular-expressions"><a href="#searching-strings-with-regular-expressions" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id40" target="_blank" rel="noopener noreferrer">Searching strings with regular expressions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>To search a string with a regex, use the “regex_search” filter:</p> <div class="language- extra-class"><pre class="language-text"><code>## search for &quot;foo&quot; in &quot;foobar&quot;
{{ 'foobar' | regex_search('(foo)') }}

## will return empty if it cannot find a match
{{ 'ansible' | regex_search('(foobar)') }}

## case insensitive search in multiline mode
{{ 'foo\nBAR' | regex_search(&quot;^bar&quot;, multiline=True, ignorecase=True) }}
</code></pre></div><p>To search for all occurrences of regex matches, use the “regex_findall” filter:</p> <div class="language- extra-class"><pre class="language-text"><code>## Return a list of all IPv4 addresses in the string
{{ 'Some DNS servers are 8.8.8.8 and 8.8.4.4' | regex_findall('\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b') }}
</code></pre></div><p>To replace text in a string with regex, use the “regex_replace” filter:</p> <div class="language- extra-class"><pre class="language-text"><code>## convert &quot;ansible&quot; to &quot;able&quot;
{{ 'ansible' | regex_replace('^a.*i(.*)$', 'a\\1') }}

## convert &quot;foobar&quot; to &quot;bar&quot;
{{ 'foobar' | regex_replace('^f.*o(.*)$', '\\1') }}

## convert &quot;localhost:80&quot; to &quot;localhost, 80&quot; using named groups
{{ 'localhost:80' | regex_replace('^(?P&lt;host&gt;.+):(?P&lt;port&gt;\\d+)$', '\\g&lt;host&gt;, \\g&lt;port&gt;') }}

## convert &quot;localhost:80&quot; to &quot;localhost&quot;
{{ 'localhost:80' | regex_replace(':80') }}

## change a multiline string
{{ var | regex_replace('^', '#CommentThis#', multiline=True) }}
</code></pre></div><p>Note</p> <p>If you want to match the whole string and you are using <code>*</code> make sure to always wraparound your regular expression with the start/end anchors. For example <code>^(.*)$</code> will always match only one result, while <code>(.*)</code> on some Python versions will match the whole string and an empty string at the end, which means it will make two replacements:</p> <div class="language- extra-class"><pre class="language-text"><code>## add &quot;https://&quot; prefix to each item in a list
GOOD:
{{ hosts | map('regex_replace', '^(.*)$', 'https://\\1') | list }}
{{ hosts | map('regex_replace', '(.+)', 'https://\\1') | list }}
{{ hosts | map('regex_replace', '^', 'https://') | list }}

BAD:
{{ hosts | map('regex_replace', '(.*)', 'https://\\1') | list }}

## append ':80' to each item in a list
GOOD:
{{ hosts | map('regex_replace', '^(.*)$', '\\1:80') | list }}
{{ hosts | map('regex_replace', '(.+)', '\\1:80') | list }}
{{ hosts | map('regex_replace', '$', ':80') | list }}

BAD:
{{ hosts | map('regex_replace', '(.*)', '\\1:80') | list }}
</code></pre></div><p>Note</p> <p>Prior to ansible 2.0, if “regex_replace” filter was used with  variables inside YAML arguments (as opposed to simpler ‘key=value’  arguments), then you needed to escape backreferences (for example, <code>\\1</code>) with 4 backslashes (<code>\\\\</code>) instead of 2 (<code>\\</code>).</p> <p>New in version 2.0.</p> <p>To escape special characters within a standard Python regex, use the  “regex_escape” filter (using the default re_type=’python’ option):</p> <div class="language- extra-class"><pre class="language-text"><code>## convert '^f.*o(.*)$' to '\^f\.\*o\(\.\*\)\$'
{{ '^f.*o(.*)$' | regex_escape() }}
</code></pre></div><p>New in version 2.8.</p> <p>To escape special characters within a POSIX basic regex, use the “regex_escape” filter with the re_type=’posix_basic’ option:</p> <div class="language- extra-class"><pre class="language-text"><code>## convert '^f.*o(.*)$' to '\^f\.\*o(\.\*)\$'
{{ '^f.*o(.*)$' | regex_escape('posix_basic') }}
</code></pre></div><h4 id="managing-file-names-and-path-names"><a href="#managing-file-names-and-path-names" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id41" target="_blank" rel="noopener noreferrer">Managing file names and path names<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>To get the last name of a file path, like ‘foo.txt’ out of ‘/etc/asdf/foo.txt’:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | basename }}
</code></pre></div><p>To get the last name of a windows style file path (new in version 2.0):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | win_basename }}
</code></pre></div><p>To separate the windows drive letter from the rest of a file path (new in version 2.0):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | win_splitdrive }}
</code></pre></div><p>To get only the windows drive letter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | win_splitdrive | first }}
</code></pre></div><p>To get the rest of the path without the drive letter:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | win_splitdrive | last }}
</code></pre></div><p>To get the directory from a path:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | dirname }}
</code></pre></div><p>To get the directory from a windows path (new version 2.0):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | win_dirname }}
</code></pre></div><p>To expand a path containing a tilde (~) character (new in version 1.5):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | expanduser }}
</code></pre></div><p>To expand a path containing environment variables:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | expandvars }}
</code></pre></div><p>Note</p> <p>expandvars expands local variables; using it on remote paths can lead to errors.</p> <p>New in version 2.6.</p> <p>To get the real path of a link (new in version 1.8):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | realpath }}
</code></pre></div><p>To get the relative path of a link, from a start point (new in version 1.7):</p> <div class="language- extra-class"><pre class="language-text"><code>{{ path | relpath('/etc') }}
</code></pre></div><p>To get the root and extension of a path or file name (new in version 2.0):</p> <div class="language- extra-class"><pre class="language-text"><code>## with path == 'nginx.conf' the return would be ('nginx', '.conf')
{{ path | splitext }}
</code></pre></div><p>The <code>splitext</code> filter returns a string. The individual components can be accessed by using the <code>first</code> and <code>last</code> filters:</p> <div class="language- extra-class"><pre class="language-text"><code>## with path == 'nginx.conf' the return would be 'nginx'
{{ path | splitext | first }}

## with path == 'nginx.conf' the return would be 'conf'
{{ path | splitext | last }}
</code></pre></div><p>To join one or more path components:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ ('/etc', path, 'subdir', file) | path_join }}
</code></pre></div><p>New in version 2.10.</p> <h3 id="manipulating-strings"><a href="#manipulating-strings" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id42" target="_blank" rel="noopener noreferrer">Manipulating strings<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>To add quotes for shell usage:</p> <div class="language- extra-class"><pre class="language-text"><code>- name: Run a shell command
  ansible.builtin.shell: echo {{ string_value | quote }}
</code></pre></div><p>To concatenate a list into a string:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ list | join(&quot; &quot;) }}
</code></pre></div><p>To work with Base64 encoded strings:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ encoded | b64decode }}
{{ decoded | string | b64encode }}
</code></pre></div><p>As of version 2.6, you can define the type of encoding to use, the default is <code>utf-8</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ encoded | b64decode(encoding='utf-16-le') }}
{{ decoded | string | b64encode(encoding='utf-16-le') }}
</code></pre></div><p>Note</p> <p>The <code>string</code> filter is only required for Python 2 and ensures that text to encode is a unicode string. Without that filter before b64encode the wrong value  will be encoded.</p> <p>New in version 2.6.</p> <h3 id="managing-uuids"><a href="#managing-uuids" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id43" target="_blank" rel="noopener noreferrer">Managing UUIDs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>To create a namespaced UUIDv5:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ string | to_uuid(namespace='11111111-2222-3333-4444-555555555555') }}
</code></pre></div><p>New in version 2.10.</p> <p>To create a namespaced UUIDv5 using the default Ansible namespace ‘361E6D51-FAEC-444A-9079-341386DA8E2E’:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ string | to_uuid }}
</code></pre></div><p>New in version 1.9.</p> <p>To make use of one attribute from each item in a list of complex variables, use the <a href="https://jinja.palletsprojects.com/en/2.11.x/templates/#map" target="_blank" rel="noopener noreferrer"><code>Jinja2 map filter</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language- extra-class"><pre class="language-text"><code>## get a comma-separated list of the mount points (for example, &quot;/,/mnt/stuff&quot;) on a host
{{ ansible_mounts | map(attribute='mount') | join(',') }}
</code></pre></div><h3 id="handling-dates-and-times"><a href="#handling-dates-and-times" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id44" target="_blank" rel="noopener noreferrer">Handling dates and times<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>To get a date object from a string use the to_datetime filter:</p> <div class="language- extra-class"><pre class="language-text"><code>## Get total amount of seconds between two dates. Default date format is %Y-%m-%d %H:%M:%S but you can pass your own format
{{ ((&quot;2016-08-14 20:00:12&quot; | to_datetime) - (&quot;2015-12-25&quot; | to_datetime('%Y-%m-%d'))).total_seconds()  }}

## Get remaining seconds after delta has been calculated. NOTE: This does NOT convert years, days, hours, and so on to seconds. For that, use total_seconds()
{{ ((&quot;2016-08-14 20:00:12&quot; | to_datetime) - (&quot;2016-08-14 18:00:00&quot; | to_datetime)).seconds  }}
## This expression evaluates to &quot;12&quot; and not &quot;132&quot;. Delta is 2 hours, 12 seconds

## get amount of days between two dates. This returns only number of days and discards remaining hours, minutes, and seconds
{{ ((&quot;2016-08-14 20:00:12&quot; | to_datetime) - (&quot;2015-12-25&quot; | to_datetime('%Y-%m-%d'))).days  }}
</code></pre></div><p>New in version 2.4.</p> <p>To format a date using a string (like with the shell date command), use the “strftime” filter:</p> <div class="language- extra-class"><pre class="language-text"><code>## Display year-month-day
{{ '%Y-%m-%d' | strftime }}

## Display hour:min:sec
{{ '%H:%M:%S' | strftime }}

## Use ansible_date_time.epoch fact
{{ '%Y-%m-%d %H:%M:%S' | strftime(ansible_date_time.epoch) }}

## Use arbitrary epoch value
{{ '%Y-%m-%d' | strftime(0) }}          ## =&gt; 1970-01-01
{{ '%Y-%m-%d' | strftime(1441357287) }} ## =&gt; 2015-09-04
</code></pre></div><p>Note</p> <p>To get all string possibilities, check https://docs.python.org/3/library/time.html#time.strftime</p> <h3 id="getting-kubernetes-resource-names"><a href="#getting-kubernetes-resource-names" class="header-anchor">#</a> <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#id45" target="_blank" rel="noopener noreferrer">Getting Kubernetes resource names<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>Note</p> <p>These filters have migrated to the <a href="https://galaxy.ansible.com/community/kubernetes" target="_blank" rel="noopener noreferrer">community.kubernetes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> collection. Follow the installation instructions to install that collection.</p> <p>Use the “k8s_config_resource_name” filter to obtain the name of a Kubernetes ConfigMap or Secret, including its hash:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ configmap_resource_definition | community.kubernetes.k8s_config_resource_name }}
</code></pre></div><p>This can then be used to reference hashes in Pod specifications:</p> <div class="language- extra-class"><pre class="language-text"><code>my_secret:
  kind: Secret
  name: my_secret_name

deployment_resource:
  kind: Deployment
  spec:
    template:
      spec:
        containers:
        - envFrom:
            - secretRef:
                name: {{ my_secret | community.kubernetes.k8s_config_resource_name }}
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/MaLunan/press/edit/dev-mln/docs/ansible/ansible.md" target="_blank" rel="noopener noreferrer">在GitHub 上编辑此页！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">1/19/2021, 1:41:59 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fdd7a502.js" defer></script><script src="/assets/js/16.375b747e.js" defer></script><script src="/assets/js/43.587e7966.js" defer></script>
  </body>
</html>
