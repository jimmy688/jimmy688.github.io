<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1、Atlas的基本概述 | 个人博客 | JiiiiG</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="自是年少，韶华倾负">
    
    <link rel="preload" href="/assets/css/0.styles.420b7c1f.css" as="style"><link rel="preload" href="/assets/js/app.fdd7a502.js" as="script"><link rel="preload" href="/assets/js/16.375b747e.js" as="script"><link rel="preload" href="/assets/js/31.190b11f2.js" as="script"><link rel="prefetch" href="/assets/js/10.bbd38b9e.js"><link rel="prefetch" href="/assets/js/11.f49fc7d3.js"><link rel="prefetch" href="/assets/js/12.c5d97aa1.js"><link rel="prefetch" href="/assets/js/13.426d0224.js"><link rel="prefetch" href="/assets/js/14.1f257a58.js"><link rel="prefetch" href="/assets/js/15.be29bb6a.js"><link rel="prefetch" href="/assets/js/17.d02cdd8b.js"><link rel="prefetch" href="/assets/js/18.5d2371a4.js"><link rel="prefetch" href="/assets/js/19.038919a3.js"><link rel="prefetch" href="/assets/js/2.d6257727.js"><link rel="prefetch" href="/assets/js/20.b3582e09.js"><link rel="prefetch" href="/assets/js/21.0c1e826b.js"><link rel="prefetch" href="/assets/js/22.91bff1a5.js"><link rel="prefetch" href="/assets/js/23.faacea60.js"><link rel="prefetch" href="/assets/js/24.69816497.js"><link rel="prefetch" href="/assets/js/25.c9fcaa62.js"><link rel="prefetch" href="/assets/js/26.d28c3abe.js"><link rel="prefetch" href="/assets/js/27.1518da7d.js"><link rel="prefetch" href="/assets/js/28.748a5581.js"><link rel="prefetch" href="/assets/js/29.775019f1.js"><link rel="prefetch" href="/assets/js/3.141002a4.js"><link rel="prefetch" href="/assets/js/30.74e7c570.js"><link rel="prefetch" href="/assets/js/32.d8f4f116.js"><link rel="prefetch" href="/assets/js/33.c489bc81.js"><link rel="prefetch" href="/assets/js/34.db609d51.js"><link rel="prefetch" href="/assets/js/35.ad3402e6.js"><link rel="prefetch" href="/assets/js/36.45f11923.js"><link rel="prefetch" href="/assets/js/37.b47e0576.js"><link rel="prefetch" href="/assets/js/38.58b934a2.js"><link rel="prefetch" href="/assets/js/39.e4d6bcdf.js"><link rel="prefetch" href="/assets/js/4.e9b44388.js"><link rel="prefetch" href="/assets/js/40.555106bc.js"><link rel="prefetch" href="/assets/js/41.4387ceb1.js"><link rel="prefetch" href="/assets/js/42.9bd4aea0.js"><link rel="prefetch" href="/assets/js/43.587e7966.js"><link rel="prefetch" href="/assets/js/44.80285763.js"><link rel="prefetch" href="/assets/js/45.f978da77.js"><link rel="prefetch" href="/assets/js/46.d93e3f2e.js"><link rel="prefetch" href="/assets/js/47.c15bd2aa.js"><link rel="prefetch" href="/assets/js/48.cb55fa72.js"><link rel="prefetch" href="/assets/js/49.d0f4e454.js"><link rel="prefetch" href="/assets/js/5.b90b80cb.js"><link rel="prefetch" href="/assets/js/50.112e8260.js"><link rel="prefetch" href="/assets/js/51.a66bcd03.js"><link rel="prefetch" href="/assets/js/52.0c7cbfb1.js"><link rel="prefetch" href="/assets/js/53.67ef240b.js"><link rel="prefetch" href="/assets/js/54.2c2d082d.js"><link rel="prefetch" href="/assets/js/55.88f19a20.js"><link rel="prefetch" href="/assets/js/56.c726e920.js"><link rel="prefetch" href="/assets/js/57.eaee47c5.js"><link rel="prefetch" href="/assets/js/58.ac15a3ac.js"><link rel="prefetch" href="/assets/js/59.64bdc849.js"><link rel="prefetch" href="/assets/js/6.7eea74ff.js"><link rel="prefetch" href="/assets/js/7.a1370e98.js"><link rel="prefetch" href="/assets/js/8.2e898240.js"><link rel="prefetch" href="/assets/js/9.a2439994.js">
    <link rel="stylesheet" href="/assets/css/0.styles.420b7c1f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人博客 | JiiiiG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/linux/linux常用命令/01linux常用命令01.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hadoop/01hadoop环境搭建/01搭建hadoop集群.html" class="nav-link">
  hadoop
</a></li><li class="dropdown-item"><!----> <a href="/hbase/hbase.html" class="nav-link">
  hbase
</a></li><li class="dropdown-item"><!----> <a href="/flink/flink.html" class="nav-link">
  flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/atlas%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/.html" class="nav-link">
  java
</a></li></ul></div></div> <a href="https://github.com/MaLunan/press" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/linux/linux常用命令/01linux常用命令01.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hadoop/01hadoop环境搭建/01搭建hadoop集群.html" class="nav-link">
  hadoop
</a></li><li class="dropdown-item"><!----> <a href="/hbase/hbase.html" class="nav-link">
  hbase
</a></li><li class="dropdown-item"><!----> <a href="/flink/flink.html" class="nav-link">
  flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/atlas%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/.html" class="nav-link">
  java
</a></li></ul></div></div> <a href="https://github.com/MaLunan/press" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1、atlas的基本概述"><a href="#_1、atlas的基本概述" class="header-anchor">#</a> 1、Atlas的基本概述</h2> <p>谈到数据治理，自然离不开元数据。元数据(Metadata)，用一句话定义就是：<strong>描述数据的数据</strong>。元数据打通了数据源、数据仓库、数据应用，记录了数据从产生到消费的全过程。因此，数据治理的核心就是<code>元数据管理</code>。</p> <p>数据的真正价值在于数据驱动决策，通过数据指导运营。通过数据驱动的方法判断趋势，帮住我们发现问题，继而推动创新或产生新的解决方案。随着企业数据爆发式增长，数据体量越来越难以估量，我们很难说清楚<strong>我们到底拥有哪些数据，这些数据从哪里来，到哪里去，发生了什么变化，应该如何使用它们</strong>。因此**元数据管理(数据治理)**成为企业级数据湖不可或缺的重要组成部分。</p> <p>可惜很长一段时间内，市面都没有成熟的数据治理解决方案。直到2015年，Hortonworks终于坐不住了，约了一众小伙伴公司倡议：咱们开始整个数据治理方案吧。然后，包含<strong>数据分类、集中策略引擎、数据血缘、安全和生命周期管理功</strong>能的Atlas应运而生。(PS：另一个应用的较多的元数据开源项目是Linkedin 在2016年新开源的项目：<code>WhereHows</code>)Atlas目前最新的版本为2018年9月18日发布的<code>1.0.0</code>版本。</p> <p>Atlas 是一个可伸缩和可扩展的核心基础治理服务集合 ，使企业能够有效地和高效地满足 Hadoop 中的合规性要求，并允许与整个企业数据生态系统的集成。</p> <p>Apache Atlas为组织提供开放式元数据管理和治理功能，用以构建其数据资产目录，对这些资产进行分类和管理，并为数据科学家，数据分析师和数据治理团队提供围绕这些数据资产的协作功能。</p> <h2 id="_2、atlas的架构概述"><a href="#_2、atlas的架构概述" class="header-anchor">#</a> 2、Atlas的架构概述</h2> <p><img src="/assets/img/architecture.a15da8e4.png" alt="architecture"></p> <h3 id="core-核心模块"><a href="#core-核心模块" class="header-anchor">#</a> Core：核心模块</h3> <p>核心模块当中又包含以下几大模块：</p> <h4 id="type-system-类型系统"><a href="#type-system-类型系统" class="header-anchor">#</a> Type System：类型系统</h4> <p>Atlas允许用户<strong>为要管理的元数据对象定义模型</strong>。 该模型由称为“类型”的定义组成。 称为“实体”的“类型”实例代表所管理的实际元数据对象。 <strong>类型系统是允许用户定义和管理类型和实体的组件</strong>。 开箱即用的Atlas管理的所有元数据对象（例如，像Hive表一样）均使用类型进行建模，并表示为实体。 为了在Atlas中存储新类型的元数据，需要了解类型系统组件的概念。</p> <h4 id="graph-engine-图形引擎"><a href="#graph-engine-图形引擎" class="header-anchor">#</a> Graph Engine：图形引擎</h4> <p>在内部，<strong>Atlas保留使用Graph模型管理的元数据对象</strong>。这种方法提供了极大的灵活性，并可以有效处理元数据对象之间的丰富关系。图引擎组件负责在Atlas类型系统的类型和实体以及基础图持久性模型之间进行转换。除了管理图形对象之外，图形引擎还为元数据对象创建适当的索引，以便可以高效地搜索它们。Atlas使用JanusGraph存储元数据对象。</p> <h4 id="ingest-export-提取-导出"><a href="#ingest-export-提取-导出" class="header-anchor">#</a> Ingest / Export：提取/导出</h4> <p><strong>“提取”组件允许将元数据添加到Atlas</strong>。同样，<strong>导出组件将Atlas检测到的元数据更改公开为事件</strong>。消费者可以使用这些更改事件来实时响应元数据更改</p> <h3 id="integration-元数据管理集成模块"><a href="#integration-元数据管理集成模块" class="header-anchor">#</a> Integration：元数据管理集成模块</h3> <p><strong>用户可以使用两种方法在Atlas中管理元数据：</strong></p> <h4 id="api"><a href="#api" class="header-anchor">#</a> API：</h4> <p>Atlas的所有功能都通过REST API向最终用户公开，该API允许创建，更新和删除类型和实体。它也是查询和发现Atlas管理的类型和实体的主要机制。</p> <h4 id="messaging"><a href="#messaging" class="header-anchor">#</a> Messaging：</h4> <p>除了API，<strong>用户还可以选择使用基于Kafka的消息传递接口与Atlas集成</strong>。这对于将元数据对象传达给Atlas以及从Atlas消耗元数据更改事件（用于构建应用程序）都是很有用的。如果有人希望使用与Atlas的松散耦合集成，以实现更好的可伸缩性，可靠性等，则该消息传递接口特别有用。Atlas使用Apache Kafka作为通知服务器，用于挂钩和元数据通知事件的下游使用者之间的通信。这些事件由钩子和Atlas编写，涉及不同的Kafka主题。</p> <h3 id="metadata-sources元数据源"><a href="#metadata-sources元数据源" class="header-anchor">#</a> Metadata Sources元数据源</h3> <p>Atlas支持与许多现成的元数据源集成。将来还将添加更多集成。当前，Atlas支持从以下来源提取和管理元数据：</p> <ul><li><a href="http://atlas.apache.org/#/HookHBase" target="_blank" rel="noopener noreferrer">HBase<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://atlas.apache.org/#/HookHive" target="_blank" rel="noopener noreferrer">Hive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://atlas.apache.org/#/HookSqoop" target="_blank" rel="noopener noreferrer">Sqoop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://atlas.apache.org/#/HookStorm" target="_blank" rel="noopener noreferrer">Storm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://atlas.apache.org/#/HookKafka" target="_blank" rel="noopener noreferrer">Kafka<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>集成意味着两件事：**Atlas原生定义了一些元数据模型来表示这些组件的对象。**Atlas提供了一些组件，可以从这些组件（实时或在某些情况下为批处理模式）中提取元数据对象</p> <h3 id="apps-应用领域"><a href="#apps-应用领域" class="header-anchor">#</a> APPS 应用领域</h3> <p>Atlas管理的元数据被各种应用程序使用，以满足许多治理用例。</p> <p><strong>Atlas Admin UI</strong>：此组件是一个基于Web的应用程序，允许数据管理员和科学家发现和注释元数据。这里最重要的是搜索界面和类似SQL的查询语言，可用于查询Atlas管理的元数据类型和对象。管理员界面使用Atlas的REST API来构建其功能。</p> <p><strong>基于标签的策略</strong>：<a href="http://ranger.apache.org/" target="_blank" rel="noopener noreferrer">Apache Ranger<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是针对Hadoop生态系统的高级安全管理解决方案，与各种Hadoop组件广泛集成。通过与Atlas集成，Ranger使安全管理员可以定义元数据驱动的安全策略以进行有效的管理。Ranger是Atlas通知的元数据更改事件的使用者。</p> <h2 id="_3、atlas的编译"><a href="#_3、atlas的编译" class="header-anchor">#</a> 3、Atlas的编译</h2> <p>Atlas这个软件框架在官网http://atlas.apache.org/#/ 上面没有给我们提供线程的二进制安装包，只提供了源码包，所以需要我们自己去对源码包进行编译，编译源码包的过程比较简单，但是由于网络原因等，会造成我们一直编译不通过。所以我们知道如何编译Atlas即可，不用自己动手去编译（一般由于网络原因，也会编译不通过的）</p> <h3 id="第一步-安装jdk"><a href="#第一步-安装jdk" class="header-anchor">#</a> 第一步：安装jdk</h3> <p><strong>注意</strong>：Atlas1.x及以上的版本的编译，必须使用jdk版本高于jdk-8u151的版本，我们这里选择使用jdk-8u231这个版本即可，只要版本高于8u151的都行。</p> <p>linux下面安装jdk的步骤省略</p> <h3 id="第二步-安装maven"><a href="#第二步-安装maven" class="header-anchor">#</a> 第二步：安装maven</h3> <p>maven的版本尽量选择高一点的版本，这里选择使用3.6.x的版本都行，具体我这里使用的是3.6.2的版本来进行编译，没有问题</p> <p>linux安装maven步骤省略</p> <h3 id="第三步-下载源码准备编译"><a href="#第三步-下载源码准备编译" class="header-anchor">#</a> 第三步：下载源码准备编译</h3> <p>我们这里使用1.2.0（如果hbase是1.x版本，则只能使用Atlas-1.x版本）这个版本来进行编译，下载Atlas的源码，然后解压，进行编译即可</p> <p>统一linux的软件下载以及软件编译目录</p> <div class="language-shell extra-class"><pre class="language-shell"><code>定义软件下载目录
<span class="token function">mkdir</span>  -p  /kkb/soft  
定义软件安装目录
<span class="token function">mkdir</span> -p /kkb/install

下载Atlas的软件安装包
<span class="token builtin class-name">cd</span> /kkb/soft
<span class="token function">wget</span>  https://www.apache.org/dyn/closer.cgi/atlas/1.2.0/apache-atlas-1.2.0-sources.tar.gz

解压源码安装包
<span class="token function">tar</span> -zxf apache-atlas-1.2.0-sources.tar.gz  -C /kkb/install/

准备进行编译
<span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-sources-1.2.0/
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MAVEN_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms2g -Xmx2g&quot;</span>
使用以下命令进行编译 表示使用外部的hbase与solr
mvn clean package -DskipTests -Pdist,external-hbase-solr

如果要使用Atlas内嵌的HBase与solr，那么我们可以执行以下命令进行编译
mvn clean package -DskipTests -Pdist,embedded-hbase-solr

</code></pre></div><p>编译好的安装包路径位于</p> <div class="language- extra-class"><pre class="language-text"><code>/kkb/install/apache-atlas-sources-1.2.0/distro/targe
</code></pre></div><p>这个路径下，获取到以下这个压缩包即可</p> <p><img src="/assets/img/1586062930734.5762ef3d.png" alt="1586062930734"></p> <p>编译过程中稍微注意下：需要下载一个包linux-x64-57_binding.node  这个包很难下载下来，我们可以给手动下载下来，然后放到编译linux机器的的/root/.npm/node-sass/4.13.1 这个路径下即可</p> <h2 id="_4、atlas的安装与前置环境准备"><a href="#_4、atlas的安装与前置环境准备" class="header-anchor">#</a> 4、Atlas的安装与前置环境准备</h2> <p>Atlas是用于做元数据管理的，可以用于来集成各种框架的元数据管理，例如可以用来集成hbase，集成solr，集成kafka，集成hive等，所以我们需要提前安装好hbase，solr，kafka，hive等框架，我们这里主要用于集成kafka，hbase，hive等这几个框架。所以我们需要提前启动kafka，启动hbase，以及启动hive的hiveserver2以及metastore服务等</p> <h3 id="安装并启动zookeeper服务"><a href="#安装并启动zookeeper服务" class="header-anchor">#</a> 安装并启动zookeeper服务</h3> <p>安装好zookeeper之后并启动zookeeper</p> <h3 id="安装并启动hadoop服务"><a href="#安装并启动hadoop服务" class="header-anchor">#</a> 安装并启动hadoop服务</h3> <p>安装好hadoop，我们这里使用的版本是CDH5.14.2这个版本</p> <h3 id="安装启动hbase服务"><a href="#安装启动hbase服务" class="header-anchor">#</a> 安装启动hbase服务</h3> <p>安装好hbase，并启动hbase的服务，我们这里使用的hbase的版本是CDH5.14.2</p> <h3 id="安装启动hive的服务"><a href="#安装启动hive的服务" class="header-anchor">#</a> 安装启动hive的服务</h3> <p>安装好hive</p> <h3 id="安装并启动好solr集群服务"><a href="#安装并启动好solr集群服务" class="header-anchor">#</a> 安装并启动好solr集群服务</h3> <p>Atlas需要一个搜索引擎服务作为Atlas的数据搜索服务，可以使用solrCloud或者使用Elasticsearch都行，我们这里选择使用SolrCloud作为Atlas的集群搜索服务，所以我们需要安装SolrCloud服务，我们这里选择使用solr5.5.2这个版本</p> <h4 id="第一步-下载solr安装包并解压"><a href="#第一步-下载solr安装包并解压" class="header-anchor">#</a> 第一步：下载solr安装包并解压</h4> <p>下载solr5.5.2安装包，并上传到<strong>node01服务器</strong>的/kkb/soft路径下</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span>  /kkb/soft
<span class="token function">tar</span> -zxf solr-5.5.2.tgz -C /kkb/install/
</code></pre></div><h4 id="第二步-修改solr配置文件"><a href="#第二步-修改solr配置文件" class="header-anchor">#</a> 第二步：修改solr配置文件</h4> <p>node01执行以下命令修改solr配置文件</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/solr-5.5.2/bin
 
<span class="token function">vim</span> solr.in.sh
 
<span class="token assign-left variable">ZK_HOST</span><span class="token operator">=</span><span class="token string">&quot;node01:2181,node02:2181,node03:2181&quot;</span>
<span class="token assign-left variable">SOLR_HOST</span><span class="token operator">=</span><span class="token string">&quot;node01&quot;</span>
</code></pre></div><h4 id="第三步-分发安装包"><a href="#第三步-分发安装包" class="header-anchor">#</a> 第三步：分发安装包</h4> <p>分发solr安装包到node02与node03服务器</p> <p>node01执行以下命令分发solr安装包到node02与node03服务器</p> <div class="language- extra-class"><pre class="language-text"><code>cd /kkb/install/
scp -r solr-5.5.2/ node02:/kkb/install
scp -r solr-5.5.2/ node03:/kkb/install
</code></pre></div><h4 id="第四步-单独修改node02与node03配置文件"><a href="#第四步-单独修改node02与node03配置文件" class="header-anchor">#</a> 第四步：单独修改node02与node03配置文件</h4> <p>node02执行以下命令修改 SOLR_HOST配置项</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/solr-5.5.2/bin/
<span class="token function">vim</span> solr.in.sh
 
<span class="token assign-left variable">SOLR_HOST</span><span class="token operator">=</span><span class="token string">&quot;node02&quot;</span>
</code></pre></div><p>node03执行以下命令修改 SOLR_HOST配置项</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/solr-5.5.2/bin/
<span class="token function">vim</span> solr.in.sh

<span class="token assign-left variable">SOLR_HOST</span><span class="token operator">=</span><span class="token string">&quot;node03&quot;</span>
</code></pre></div><h4 id="第五步-启动solr服务"><a href="#第五步-启动solr服务" class="header-anchor">#</a> 第五步：启动solr服务</h4> <p>三台机器启动solr服务</p> <p>三台机器执行以下命令启动solr服务</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/solr-5.5.2/
bin/solr start
</code></pre></div><h4 id="第六步-浏览器页面访问"><a href="#第六步-浏览器页面访问" class="header-anchor">#</a> 第六步：浏览器页面访问</h4> <p>浏览器页面访问</p> <p>http://node01:8983/solr/#/</p> <p>出现cloud选项，证明solr集群安装成功</p> <p><img src="/assets/img/1586183061746.cbb4ac8d.png" alt="1586183061746"></p> <h3 id="安装atlas集成其他框架"><a href="#安装atlas集成其他框架" class="header-anchor">#</a> 🥇安装Atlas集成其他框架</h3> <h4 id="atlas集成hbase服务"><a href="#atlas集成hbase服务" class="header-anchor">#</a> Atlas集成HBase服务</h4> <h5 id="第一步-上传压缩包并解压"><a href="#第一步-上传压缩包并解压" class="header-anchor">#</a> 第一步：上传压缩包并解压</h5> <p>上传Atlas编译之后的安装包并进行解压</p> <p>将Atlas的安装包上传到<strong>node03服务器</strong>的/kkb/soft路径下，然后进行解压</p> <div class="language- extra-class"><pre class="language-text"><code>cd /kkb/soft
tar -zxf apache-atlas-1.2.0-bin.tar.gz -C /kkb/install/
</code></pre></div><h5 id="第二步-修改atlas-application-properties-更改atlas存储数据主机名"><a href="#第二步-修改atlas-application-properties-更改atlas存储数据主机名" class="header-anchor">#</a> 第二步：修改atlas-application.properties 更改Atlas存储数据主机名</h5> <p>修改Atlas的存储数据主机名</p> <p>node03执行以下命令修改Atlas连接zk的地址</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf
<span class="token function">vim</span> atlas-application.properties 

atlas.graph.storage.hostname<span class="token operator">=</span>node01:2181,node02:2181,node03:2181
</code></pre></div><h5 id="第三步-修改atlas与hbase集成文件"><a href="#第三步-修改atlas与hbase集成文件" class="header-anchor">#</a> 第三步：修改Atlas与HBase集成文件</h5> <p>修改Atlas与HBase的集成配置文件</p> <p>node03执行以下命令，修改Atlas连接hbase的配置文件夹路径</p> <div class="language-shell extra-class"><pre class="language-shell"><code>直接通过链接的方式即可，将hbase的配置文件夹conf目录，链接到Atlas对应hbase的配置文件夹下
<span class="token function">ln</span> -s /kkb/install/hbase-1.2.0-cdh5.14.2/conf /kkb/install/apache-atlas-1.2.0/conf/hbase/conf

在Atlas的conf目录下的hbase文件夹下面创建一个连接文件夹，连接到hbase的conf配置文件
</code></pre></div><h5 id="第四步-修改atlas-env-sh配置文件"><a href="#第四步-修改atlas-env-sh配置文件" class="header-anchor">#</a> 第四步：修改atlas-env.sh配置文件</h5> <p>修改atlas-env.sh添加hbase配置路径</p> <p>node03执行以下命令修改JAVA_HOME以及修改HBASE_CONF_DIR路径</p> <div class="language-shell extra-class"><pre class="language-shell"><code>修改atlas-env.sh 添加hbase的配置文件的路径
<span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf/
<span class="token function">vim</span> atlas-env.sh 

<span class="token comment">#修改java环境变量</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/kkb/install/jdk1.8.0_141
<span class="token comment">#添加这一行配置项</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_CONF_DIR</span><span class="token operator">=</span>/kkb/install/apache-atlas-1.2.0/conf/hbase/conf
</code></pre></div><h4 id="atlas集成solr服务"><a href="#atlas集成solr服务" class="header-anchor">#</a> Atlas集成Solr服务</h4> <h5 id="第一步-修改atlas配置文件-atlas-application-properties"><a href="#第一步-修改atlas配置文件-atlas-application-properties" class="header-anchor">#</a> 第一步：修改Atlas配置文件 atlas-application.properties</h5> <p>node03执行以下命令修改Atlas的配置文件 atlas-application.properties</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf/
<span class="token function">vim</span> atlas-application.properties 

atlas.graph.index.search.backend<span class="token operator">=</span>solr
atlas.graph.index.search.solr.zookeeper-url<span class="token operator">=</span>node01:2181,node02:2181,node03:2181
atlas.graph.index.search.solr.mode<span class="token operator">=</span>http   <span class="token comment">#打开注释</span>
atlas.graph.index.search.solr.http-urls<span class="token operator">=</span>http://node01:8983/solr

</code></pre></div><h5 id="第二步-拷贝atlas配置文件到solr里面去"><a href="#第二步-拷贝atlas配置文件到solr里面去" class="header-anchor">#</a> 第二步：拷贝atlas配置文件到solr里面去</h5> <p>将Atlas自带的solr配置文件拷贝到node03服务器的Solr安装目录下</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">cp</span> -r /kkb/install/apache-atlas-1.2.0/conf/solr /kkb/install/solr-5.5.2/
重命名文件夹名称
<span class="token builtin class-name">cd</span> /kkb/install/solr-5.5.2/
<span class="token function">mv</span> solr/ atlas_conf
</code></pre></div><h5 id="第三步-同步拷贝后的配置文件到node01与node02"><a href="#第三步-同步拷贝后的配置文件到node01与node02" class="header-anchor">#</a> 第三步：同步拷贝后的配置文件到node01与node02</h5> <p>同步node01服务器的配置文件到node01和node02</p> <div class="language- extra-class"><pre class="language-text"><code>node01执行以下命令进行同步
cd /kkb/install/solr-5.5.2/
scp -r atlas_conf/ node01:/kkb/install/solr-5.5.2/
scp -r atlas_conf/ node02:/kkb/install/solr-5.5.2/
</code></pre></div><h5 id="第四步-创建solr的collection"><a href="#第四步-创建solr的collection" class="header-anchor">#</a> 第四步：创建solr的collection</h5> <p>在solrCloud模式下，启动solr，并创建collection</p> <p>node01执行以下命令来创建collection（确保solr已经开启）</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/solr-5.5.2/
bin/solr create -c vertex_index -d /kkb/install/solr-5.5.2/atlas_conf/ -shards <span class="token number">3</span> -replicationFactor <span class="token number">2</span>       
bin/solr create -c edge_index -d  /kkb/install/solr-5.5.2/atlas_conf -shards <span class="token number">3</span> -replicationFactor <span class="token number">2</span>

bin/solr create -c fulltext_index -d /kkb/install/solr-5.5.2/atlas_conf -shards <span class="token number">3</span> -replicationFactor <span class="token number">2</span>

</code></pre></div><p>-shards 3：表示该集合分片数为3</p> <p>-replicationFactor 2：表示每个分片数都有2个备份</p> <p>vertex_index、edge_index、fulltext_index：表示集合名称</p> <p>注意：如果需要删除vertex_index、edge_index、fulltext_index等collection可以执行如下命令。</p> <div class="language- extra-class"><pre class="language-text"><code>cd /kkb/install/solr-5.5.2/
bin/solr delete -c ${collection_name}
</code></pre></div><p>验证创建collection成功</p> <p>浏览器页面访问http://node01:8983/solr/#/~cloud看到以下效果证明创建成功</p> <p><img src="/assets/img/1586184687785.5fd36145.png" alt="1586184687785"></p> <h4 id="atlas集成kafka服务"><a href="#atlas集成kafka服务" class="header-anchor">#</a> Atlas集成Kafka服务</h4> <h5 id="第一步-修改atlas配置文件-atlas-application-properties-2"><a href="#第一步-修改atlas配置文件-atlas-application-properties-2" class="header-anchor">#</a> 第一步：修改Atlas配置文件 atlas-application.properties</h5> <p>修改Atlas配置文件atlas-application.properties</p> <p><strong>node03执行</strong>以下命令修改配置文件内容</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf
<span class="token function">vim</span> atlas-application.properties


atlas.notification.embedded<span class="token operator">=</span>false
atlas.kafka.zookeeper.connect<span class="token operator">=</span>node01:2181,node02:2181,node03:2181
atlas.kafka.bootstrap.servers<span class="token operator">=</span>node01:9092,node02:9092,node03:9092
atlas.kafka.zookeeper.session.timeout.ms<span class="token operator">=</span><span class="token number">4000</span>
atlas.kafka.zookeeper.connection.timeout.ms<span class="token operator">=</span><span class="token number">2000</span>
atlas.kafka.enable.auto.commit<span class="token operator">=</span>true
</code></pre></div><h5 id="第二步-创建kafka的topic"><a href="#第二步-创建kafka的topic" class="header-anchor">#</a> 第二步：创建kafka的topic</h5> <p>创建kafka的topic</p> <p>Atlas与kafka集成需要创建两个topic，这两个topic的名字配置在atlas-application.properties这个配置文件里面</p> <div class="language- extra-class"><pre class="language-text"><code>atlas.notification.topics=ATLAS_HOOK,ATLAS_ENTITIES
</code></pre></div><p><strong>node01执行</strong>以下命令创建这两个topic</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>hadoop@node01 ~<span class="token punctuation">]</span>$ <span class="token function">sh</span> ./bin/kafkaCluster.sh start

kafka-topics.sh --zookeeper node01:2181,node02:2181,node03:2181 --create --replication-factor <span class="token number">2</span> --partitions <span class="token number">3</span> --topic ATLAS_HOOK

kafka-topics.sh --zookeeper node01:2181,node02:2181,node03:2181 --create --replication-factor <span class="token number">2</span> --partitions <span class="token number">3</span> --topic ATLAS_ENTITIES
</code></pre></div><h4 id="atlas集成hive服务"><a href="#atlas集成hive服务" class="header-anchor">#</a> Atlas集成hive服务</h4> <h5 id="第一步-修改atlas配置文件-atlas-application-properties-3"><a href="#第一步-修改atlas配置文件-atlas-application-properties-3" class="header-anchor">#</a> 第一步：修改Atlas配置文件 atlas-application.properties</h5> <p>修改Atlas配置文件atlas-application.properties</p> <p>node03执行以下命令修改配置文件内容</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf
<span class="token function">vim</span> atlas-application.properties

<span class="token comment">#手动添加以下配置，这些配置在配置文件里面没有，需要我们自己手动添加</span>
<span class="token comment">########## Hive Hook Configs #######</span>
atlas.hook.hive.synchronous<span class="token operator">=</span>false
atlas.hook.hive.numRetries<span class="token operator">=</span><span class="token number">3</span>
atlas.hook.hive.queueSize<span class="token operator">=</span><span class="token number">10000</span>
atlas.cluster.name<span class="token operator">=</span>primary

</code></pre></div><h5 id="第二步-添加配置文件放到jar包里面去"><a href="#第二步-添加配置文件放到jar包里面去" class="header-anchor">#</a> 第二步：添加配置文件放到jar包里面去</h5> <p>将atlas-application.properties配置文件添加到atlas-plugin-classloader-1.2.0.jar包</p> <p><strong>node03执行</strong>以下命令，将atlas-application.properties这个配置文件添加到atlas-plugin-classloader-1.2.0.jar这个jar包</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> yum -y <span class="token function">install</span> <span class="token function">zip</span>
<span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf
 <span class="token function">zip</span> -u  /kkb/install/apache-atlas-1.2.0/hook/hive/atlas-plugin-classloader-1.2.0.jar  atlas-application.properties
</code></pre></div><h5 id="第三步-拷贝配置文件到hive的conf目录下"><a href="#第三步-拷贝配置文件到hive的conf目录下" class="header-anchor">#</a> 第三步：拷贝配置文件到hive的conf目录下</h5> <p>node03执行以下命令，将atlas-application.properties配置文件，拷贝到hive的conf目录下</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf/
<span class="token function">cp</span> atlas-application.properties /kkb/install/hive-1.1.0-cdh5.14.2/conf/  
</code></pre></div><h5 id="第四步-修改hive-env-sh配置外部jar包"><a href="#第四步-修改hive-env-sh配置外部jar包" class="header-anchor">#</a> 第四步：修改hive-env.sh配置外部jar包</h5> <p>node03执行以下命令修改hive-env.sh添加外部jar包</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/hive-1.1.0-cdh5.14.2/conf
<span class="token function">vim</span> hive-env.sh 

<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_AUX_JARS_PATH</span><span class="token operator">=</span>/kkb/install/apache-atlas-1.2.0/hook/hive
</code></pre></div><h5 id="第五步-修改hive-site-xml"><a href="#第五步-修改hive-site-xml" class="header-anchor">#</a> 第五步：修改hive-site.xml</h5> <p>修改hive-site.xml配置文件</p> <p>node03执行以下命令修改hive的配置文件hive-site.xml</p> <div class="language-xml extra-class"><pre class="language-xml"><code>cd /kkb/install/hive-1.1.0-cdh5.14.2/conf
vim hive-site.xml 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.exec.post.hooks<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span> 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.atlas.hive.hook.HiveHook,org.apache.hadoop.hive.ql.hooks.LineageLogger<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="atlas其他配置选项"><a href="#atlas其他配置选项" class="header-anchor">#</a> Atlas其他配置选项</h4> <h5 id="第一步-修改atlas的主机名"><a href="#第一步-修改atlas的主机名" class="header-anchor">#</a> 第一步：修改Atlas的主机名</h5> <p>node03执行以下命令，修改配置文件atlas-application.properties</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf/
<span class="token function">vim</span> atlas-application.properties

atlas.rest.address<span class="token operator">=</span>http://node03:21000
atlas.audit.hbase.zookeeper.quorum<span class="token operator">=</span>node01:2181,node02:2181,node03:2181
</code></pre></div><h5 id="第二步-修改atlas的日志配置文件"><a href="#第二步-修改atlas的日志配置文件" class="header-anchor">#</a> 第二步：修改Atlas的日志配置文件</h5> <p>node03执行以下命令修改atlas的日志服务配置文件atlas-log4j.xml</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/conf
<span class="token function">vim</span> atlas-log4j.xml

以下配置在文件当中已经存在，只不过被注释掉了，直接打开即可

<span class="token operator">&lt;</span>appender <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;perf_appender&quot;</span> <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;org.apache.log4j.DailyRollingFileAppender&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>param <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;file&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${atlas.log.dir}</span>/atlas_perf.log&quot;</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>param <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;datePattern&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;'.'yyyy-MM-dd&quot;</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>param <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;append&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>layout <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;org.apache.log4j.PatternLayout&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>param <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;ConversionPattern&quot;</span> <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;%d|%t|%m%n&quot;</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/layout<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/appender<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>logger <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;org.apache.atlas.perf&quot;</span> <span class="token assign-left variable">additivity</span><span class="token operator">=</span><span class="token string">&quot;false&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>level <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;debug&quot;</span> /<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>appender-ref <span class="token assign-left variable">ref</span><span class="token operator">=</span><span class="token string">&quot;perf_appender&quot;</span> /<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/logger<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_5、atlas启动服务并访问页面"><a href="#_5、atlas启动服务并访问页面" class="header-anchor">#</a> 5、Atlas启动服务并访问页面</h2> <p>node03执行以下命令启动Atlas的服务（确保hive/hbase/zk/hadoop/solr都开启了）</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0
bin/atlas_start.py
</code></pre></div><p>浏览器页面访问：</p> <p>http://node03:21000/#!/search   注意：访问web页面后，不能立刻登录，要等一会</p> <div class="language- extra-class"><pre class="language-text"><code>用户名：admin

密码：admin
</code></pre></div><img src="atlas元数据管理.assets/image-20200521185752050.png" alt="image-20200521185752050" style="zoom:50%;"> <h2 id="_6、导入hive元数据到atlas当中来"><a href="#_6、导入hive元数据到atlas当中来" class="header-anchor">#</a> 6、导入hive元数据到Atlas当中来</h2> <p>将hive元数据导入到Atlas当中来进行管理</p> <h3 id="第一步-node03配置hive环境变量"><a href="#第一步-node03配置hive环境变量" class="header-anchor">#</a> 第一步：node03配置hive环境变量</h3> <p>node03执行以下命令，配置hive的环境变量</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/profile

<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_HOME</span><span class="token operator">=</span>/kkb/install/hive-1.1.0-cdh5.14.2
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>:<span class="token variable">$HIVE_HOME</span>/bin:<span class="token environment constant">$PATH</span>

<span class="token builtin class-name">source</span> /etc/profile
</code></pre></div><h3 id="第二步-验证hive功能正常"><a href="#第二步-验证hive功能正常" class="header-anchor">#</a> 第二步：验证hive功能正常</h3> <p>node03执行以下命令进入hive客户端，如果hive功能正常即可</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>hadoop@node03 hive<span class="token punctuation">]</span>$ <span class="token builtin class-name">cd</span> /kkb/install/hive-1.1.0-cdh5.14.2/
<span class="token punctuation">[</span>hadoop@node03 hive-1.1.0-cdh5.14.2<span class="token punctuation">]</span>$ hive
hive <span class="token punctuation">(</span>default<span class="token punctuation">)</span><span class="token operator">&gt;</span> show databases<span class="token punctuation">;</span>
</code></pre></div><h3 id="第三步-导入hive元数据到atlas"><a href="#第三步-导入hive元数据到atlas" class="header-anchor">#</a> 第三步：导入hive元数据到atlas</h3> <p>node03执行以下命令导入hive元数据</p> <div class="language- extra-class"><pre class="language-text"><code>cd /kkb/install/apache-atlas-1.2.0/
bin/import-hive.sh 
</code></pre></div><p>导入过程中会报以下错误</p> <div class="language- extra-class"><pre class="language-text"><code>Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: com/fasterxml/jackson/jaxrs/json/JacksonJaxbJsonProvider
        at org.apache.atlas.AtlasBaseClient.getClient(AtlasBaseClient.java:270)
        at org.apache.atlas.AtlasBaseClient.initializeState(AtlasBaseClient.java:453)
        at org.apache.atlas.AtlasBaseClient.initializeState(AtlasBaseClient.java:448)
        at org.apache.atlas.AtlasBaseClient.&lt;init&gt;(AtlasBaseClient.java:132)
        at org.apache.atlas.AtlasClientV2.&lt;init&gt;(AtlasClientV2.java:82)
        at org.apache.atlas.hive.bridge.HiveMetaStoreBridge.main(HiveMetaStoreBridge.java:131)
Caused by: java.lang.ClassNotFoundException: com.fasterxml.jackson.jaxrs.json.JacksonJaxbJsonProvider
        at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:335)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
        ... 6 more
</code></pre></div><h3 id="第四步-拷贝jar包解决以上错误"><a href="#第四步-拷贝jar包解决以上错误" class="header-anchor">#</a> 第四步：拷贝jar包解决以上错误</h3> <p>缺少jar包，导致以上错误，需要我们手动拷贝几个jar包到atlas的hook目录下即可</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /kkb/install/apache-atlas-1.2.0/server/webapp/atlas/WEB-INF/lib
<span class="token function">cp</span> jackson-jaxrs-base-2.9.9.jar jackson-jaxrs-json-provider-2.9.9.jar jackson-module-jaxb-annotations-2.9.9.jar  /kkb/install/apache-atlas-1.2.0/hook/hive/atlas-hive-plugin-impl/
</code></pre></div><h3 id="第五步-重新导入元数据"><a href="#第五步-重新导入元数据" class="header-anchor">#</a> 第五步：重新导入元数据</h3> <p>重新导入hive元数据信息到atlas当中来</p> <div class="language- extra-class"><pre class="language-text"><code>cd /kkb/install/apache-atlas-1.2.0/
bin/import-hive.sh 

出现以下信息，证明导入成功
Using Hive configuration directory [/kkb/install/hive-1.1.0-cdh5.14.2/conf]
Log file for import is /kkb/install/apache-atlas-1.2.0/logs/import-hive.log
log4j:WARN No such property [maxFileSize] in org.apache.log4j.PatternLayout.
log4j:WARN No such property [maxBackupIndex] in org.apache.log4j.PatternLayout.
Enter username for atlas :- admin
Enter password for atlas :- 
Hive Meta Data imported successfully!!!
</code></pre></div><p><img src="/assets/img/1587518503593.91f40e86.png" alt="1587518503593"></p> <h3 id="第六步-浏览器页面访问浏览元数据信息"><a href="#第六步-浏览器页面访问浏览元数据信息" class="header-anchor">#</a> 第六步：浏览器页面访问浏览元数据信息</h3> <p>直接浏览器页面访问</p> <p>http://node03:21000/#!/search/searchResult?type=hive_db&amp;searchType=basic</p> <p><img src="/assets/img/image-20200521190752884.402692b7.png" alt="image-20200521190752884"></p> <p>就可以看到我们的元数据信息了</p> <h2 id="_7、使用azkaban来实现我们的任务调度并查看血缘管理"><a href="#_7、使用azkaban来实现我们的任务调度并查看血缘管理" class="header-anchor">#</a> 7、使用azkaban来实现我们的任务调度并查看血缘管理</h2> <h3 id="第一步-在node03服务器上面创建mysql数据库表"><a href="#第一步-在node03服务器上面创建mysql数据库表" class="header-anchor">#</a> 第一步：在node03服务器上面创建mysql数据库表</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token comment">/*!32312 IF NOT EXISTS*/</span><span class="token punctuation">`</span>game_center2<span class="token punctuation">`</span> <span class="token comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span><span class="token punctuation">;</span>

<span class="token keyword">USE</span> <span class="token punctuation">`</span>game_center2<span class="token punctuation">`</span><span class="token punctuation">;</span>

<span class="token comment">/*Table structure for table `res_active_users` */</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>res_active_users<span class="token punctuation">`</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>res_active_users<span class="token punctuation">`</span> <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>plat_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>channel_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>event_date<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>new_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>old_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>all_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">64</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token comment">/*Table structure for table `res_channel_num` */</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>res_channel_num<span class="token punctuation">`</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>res_channel_num<span class="token punctuation">`</span> <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>login_date<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>channel_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>device_num<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>reg_user<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>active_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>play_once_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>pay_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>pay_user<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>pay_money<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token comment">/*Table structure for table `res_channel_num_temp` */</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>res_channel_num_temp<span class="token punctuation">`</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>res_channel_num_temp<span class="token punctuation">`</span> <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>login_date<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>channel_id<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>device_num<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>reg_user<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>active_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>play_once_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>pay_users<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>pay_user<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>pay_money<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
</code></pre></div><h3 id="第二步-将我们的数据上传"><a href="#第二步-将我们的数据上传" class="header-anchor">#</a> 第二步：将我们的数据上传</h3> <p>将我们需要执行的数据上传到node03服务器的/kkb/datas/gamecenter 这个路径下</p> <h3 id="第三步-使用azkaban执行调度任务"><a href="#第三步-使用azkaban执行调度任务" class="header-anchor">#</a> 第三步：使用azkaban执行调度任务</h3> <p>使用azkaban来调度执行我们的任务</p> <p><img src="/assets/img/1587565757231.c754e4ec.png" alt="1587565757231"></p> <h3 id="第四步-atlas当中查看血缘关系"><a href="#第四步-atlas当中查看血缘关系" class="header-anchor">#</a> 第四步：atlas当中查看血缘关系</h3> <p>查看表之间的血缘关系</p> <p><img src="/assets/img/1587565884322.c95d0346.png" alt="1587565884322"></p> <p>查看字段之间的血缘关系</p> <p><img src="/assets/img/1587565940545.aaad994f.png" alt="1587565940545"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/MaLunan/press/edit/dev-mln/docs/atlas元数据管理/atlas元数据管理.md" target="_blank" rel="noopener noreferrer">在GitHub 上编辑此页！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">1/19/2021, 1:41:59 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fdd7a502.js" defer></script><script src="/assets/js/16.375b747e.js" defer></script><script src="/assets/js/31.190b11f2.js" defer></script>
  </body>
</html>
